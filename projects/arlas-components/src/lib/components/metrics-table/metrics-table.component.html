<div class="tools">
  <div *ngIf="filterOperator && filterOperator?.display" class="include_exclude">
    <div class="operation" [class.selected_operation]="filterOperator?.value === 'Eq'" (click)="setOperator('Eq')">
      {{'include' | translate}}</div>
    <div class="operation" [class.selected_operation]="filterOperator?.value === 'Neq'" (click)="setOperator('Neq')">
      {{'exclude' | translate}}</div>
  </div>
  <div *ngIf="filterOperator && !filterOperator?.display && filterOperator?.value === 'Neq'" class="include_exclude">
    <div class="operation" [class.exclude]="filterOperator?.value === 'Neq'">{{'exclude' | translate}}</div>
  </div>
</div>
<div class="table-overflow-wrapper">
<table class="multi-bar">
  <thead #tableHeader>
  <!-- Title area -->
  <tr>
    <th></th>
    <ng-container *ngIf="titleAreDifferent; else displayOneTitle">
      <th class="multi-bar__header-indicator" *ngFor="let header of metricsTable?.header; let i = index">
        <div *ngIf="headerDisplayMode === 'indicator' || headerDisplayMode === 'full'" class="header-indicator"
             [style]="{'background': shortcutColor[i]}" [matTooltip]="header.title"></div>
        <div class="separator" *ngIf="headerDisplayMode === 'full'"></div>
        <span class="multi-bar__header-title"
              *ngIf="headerDisplayMode === 'titleOnly' || headerDisplayMode === 'full'">{{ header.title }}</span>
      </th>
    </ng-container>
    <ng-template #displayOneTitle>
      <th *ngFor="let header of uniqueTitles" class="multi-bar__header-indicator" [attr.colspan]="header.span">
        <div class="multi-bar__header-title">
          {{ header.title }}
        </div>

      </th>
    </ng-template>
  </tr>
  <!-- Sub Title area -->
  <tr>
    <th></th>
    <th class="multi-bar__header" *ngFor="let header of metricsTable?.header; let i = index">
      <div class="multi-bar__header-item multi-bar__header-item-title">
        {{ header.subTitle | formatLongTitle:20 }}
      </div>
      <div class="multi-bar__header-item "> ({{ header.metric }})</div>
    </th>
  </tr>
  </thead>
  <tbody [style]="{height: tbodyHeight}">
  <arlas-multi-bars-row
    *ngFor="let item of (s | async)|keyvalue; let index = index;trackBy: trackByFn"
    [metricsTableRow]="item.value"
    [useColorFromData]="false"
    [hideSelection]="false"
    [useColorService]="useColorService"
    [powerBars]="powerBarsList.get(item.value.term)"
    [displayCheckBox]="selectWithCheckbox"
    (rowSelected)="addTermToSelectedList($event)">
  </arlas-multi-bars-row>
  <arlas-multi-bars-row
    *ngFor="let row of metricsTable.data; let index = index;trackBy: trackByFn"
    [metricsTableRow]="row"
    [selected]="row.selected"
    [hideSelection]="true"
    [useColorFromData]="false"
    [useColorService]="useColorService"
    [powerBars]="powerBarsList.get(row.term)"
    [displayCheckBox]="selectWithCheckbox"
    [pendingMode]="pendingMode"
    (rowSelected)="addTermToSelectedList($event)">
  </arlas-multi-bars-row>
  </tbody>
</table>
</div>
