{"version":3,"file":"arlas-map.mjs","sources":["../../../projects/arlas-map/src/lib/map-settings/map-settings.component.ts","../../../projects/arlas-map/src/lib/map-settings/map-settings-dialog.component.html","../../../projects/arlas-map/src/lib/map-settings/map-settings.component.html","../../../projects/arlas-map/src/lib/map/model/map.ts","../../../projects/arlas-map/src/lib/arlas-map-framework.service.ts","../../../projects/arlas-map/src/lib/map/model/layers.ts","../../../projects/arlas-map/src/lib/arlas-map.service.ts","../../../projects/arlas-map/src/lib/basemaps/basemap.service.ts","../../../projects/arlas-map/src/lib/basemaps/basemaps.model.ts","../../../projects/arlas-map/src/lib/map/AbstractArlasMapGL.ts","../../../projects/arlas-map/src/lib/map/tools.ts","../../../projects/arlas-map/src/lib/draw/draw.service.ts","../../../projects/arlas-map/src/lib/draw/modes/LimitVertexDirectSelectMode.ts","../../../projects/arlas-map/src/lib/draw/modes/ValidGeomDrawPolygonMode.ts","../../../projects/arlas-map/src/lib/draw/modes/circles/circle.mode.ts","../../../projects/arlas-map/src/lib/draw/modes/utils.ts","../../../projects/arlas-map/src/lib/draw/modes/circles/radius.circle.mode.ts","../../../projects/arlas-map/src/lib/draw/modes/circles/utils.ts","../../../projects/arlas-map/src/lib/draw/modes/directSelectOverride.ts","../../../projects/arlas-map/src/lib/draw/modes/rectangleMode.ts","../../../projects/arlas-map/src/lib/draw/modes/simpleSelectOverride.ts","../../../projects/arlas-map/src/lib/draw/modes/strip/strip.mode.ts","../../../projects/arlas-map/src/lib/draw/modes/strip/strip.direct.mode.ts","../../../projects/arlas-map/src/lib/draw/themes/default-theme.ts","../../../projects/arlas-map/src/lib/draw/arlas-draw.component.ts","../../../projects/arlas-map/src/lib/draw/arlas-draw.component.html","../../../projects/arlas-map/src/lib/bbox-generator/coordinates.tools.ts","../../../projects/arlas-map/src/lib/coordinates/coordinates.pipe.ts","../../../projects/arlas-map/src/lib/coordinates/coordinates.component.ts","../../../projects/arlas-map/src/lib/coordinates/coordinates.component.html","../../../projects/arlas-map/src/lib/basemaps/basemap.component.ts","../../../projects/arlas-map/src/lib/basemaps/basemap.component.html","../../../projects/arlas-map/src/lib/legend/legend.config.ts","../../../projects/arlas-map/src/lib/map/model/filters.ts","../../../projects/arlas-map/src/lib/legend/legend.tools.ts","../../../projects/arlas-map/src/lib/legend/legend.service.ts","../../../projects/arlas-map/src/lib/legend/legend-icon/layer-icon.component.ts","../../../projects/arlas-map/src/lib/legend/legend-icon/layer-icon.component.html","../../../projects/arlas-map/src/lib/legend/format-legend.pipe.ts","../../../projects/arlas-map/src/lib/legend/legend-item/legend-item.component.ts","../../../projects/arlas-map/src/lib/legend/legend-item/legend-item.component.html","../../../projects/arlas-map/src/lib/legend/layer-name.pipe.ts","../../../projects/arlas-map/src/lib/legend/legend.component.ts","../../../projects/arlas-map/src/lib/legend/legend.component.html","../../../projects/arlas-map/src/lib/arlas-map.pipe.ts","../../../projects/arlas-map/src/lib/arlas-map.component.ts","../../../projects/arlas-map/src/lib/arlas-map.component.html","../../../projects/arlas-map/src/lib/map-import/map-import.component.ts","../../../projects/arlas-map/src/lib/map-import/map-import-dialog.component.html","../../../projects/arlas-map/src/lib/map-import/map-import.component.html","../../../projects/arlas-map/src/lib/map-settings/map-settings.module.ts","../../../projects/arlas-map/src/lib/map-import/map-import.module.ts","../../../projects/arlas-map/src/lib/basemaps/basemap.module.ts","../../../projects/arlas-map/src/lib/coordinates/coordinates.module.ts","../../../projects/arlas-map/src/lib/arlas-map.module.ts","../../../projects/arlas-map/src/lib/bbox-generator/bbox-form-error.pipe.ts","../../../projects/arlas-map/src/lib/bbox-generator/bbox-generator.utils.ts","../../../projects/arlas-map/src/lib/bbox-generator/bbox-generator.component.ts","../../../projects/arlas-map/src/lib/bbox-generator/bbox-generator.component.html","../../../projects/arlas-map/src/lib/bbox-generator/bbox-generator.module.ts","../../../projects/arlas-map/src/lib/draw/AbstractDraw.ts","../../../projects/arlas-map/src/lib/map/model/controls.ts","../../../projects/arlas-map/src/lib/map/model/sources.ts","../../../projects/arlas-map/src/lib/map/model/vector-style.ts","../../../projects/arlas-map/src/public-api.ts","../../../projects/arlas-map/src/arlas-map.ts"],"sourcesContent":["/*\n * Licensed to Gisaïa under one or more contributor\n * license agreements. See the NOTICE.txt file distributed with\n * this work for additional information regarding copyright\n * ownership. Gisaïa licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { Component, Output } from '@angular/core';\nimport { UntypedFormControl, UntypedFormGroup, Validators } from '@angular/forms';\nimport { MatDialog, MatDialogRef } from '@angular/material/dialog';\nimport { marker } from '@colsen1991/ngx-translate-extract-marker';\nimport { Subject, takeUntil } from 'rxjs';\nimport { ArlasColorService } from 'arlas-web-components';\n\nexport interface GeometrySelectModel {\n  path: string;\n  selected?: boolean;\n}\nexport interface OperationSelectModel {\n  operation: GeoQueryOperator;\n  selected?: boolean;\n}\nexport interface GeoQuery {\n  operation: string;\n  geometry_path: string;\n}\n\nexport enum GeoQueryOperator {\n  WITHIN = 'within',\n  NOT_WITHIN = 'notwithin',\n  INTERSECTS = 'intersects',\n  NOT_INTERSECTS = 'notintersects'\n}\n\nexport class SelectFormControl extends UntypedFormControl {\n\n  // used only for autocomplete: list of filtered options\n  public filteredOptions: Array<string>;\n  public syncOptions: Array<string> = [];\n\n  public constructor(\n    formState: any,\n    label: string,\n    options: Array<string>) {\n\n    super(formState, Validators.required);\n    this.setValue(formState);\n    this.setSyncOptions(options);\n\n  }\n\n  public setSyncOptions(newOptions: Array<string>) {\n    this.syncOptions = newOptions;\n    this.filteredOptions = newOptions;\n  }\n}\n\nexport interface MapSettingsService {\n  getGeoQueries(): Map<string, [Array<GeometrySelectModel>, Array<OperationSelectModel>, string]>;\n}\n\n@Component({\n  selector: 'arlas-map-settings-dialog',\n  templateUrl: './map-settings-dialog.component.html',\n  styleUrls: ['./map-settings-dialog.component.scss']\n})\nexport class MapSettingsDialogComponent {\n  /**\n   * @Output : Angular\n   * Emits the geo-query to apply. A geo-query is defined by\n   * - the operation (\"within\", \"intersects\", \"notwithin\", \"notintersects\")\n   * - the geometry field to query\n   */\n  @Output() public geoQueryEmitter: Subject<Map<string, GeoQuery>> = new Subject<Map<string, GeoQuery>>();\n  public emittedGeoQueries: Map<string, GeoQuery> = new Map();\n  /** Constants */\n  public GEO_QUERIES_DESCRIPTION = marker('Draw a bbox or a polygon that');\n\n  public geoQueriesFormGroups = new Array<UntypedFormGroup>();\n  public collectionsColors = new Array<string>();\n  public selectionsSnapshot = new Map<string, string>();\n\n  private readonly _onDestroy$ = new Subject<boolean>();\n\n  public constructor(\n    private readonly dialogRef: MatDialogRef<MapSettingsComponent>,\n    private readonly colorGeneratorLoader: ArlasColorService) { }\n\n  public ngOnDestroy() {\n    this._onDestroy$.next(true);\n    this._onDestroy$.complete();\n  }\n\n  /** Emits the geo-query to apply */\n  public emitGeoFilter() {\n    this.geoQueryEmitter.next(this.emittedGeoQueries);\n  }\n\n  /** Closes the dialog */\n  public onClose() {\n    this.dialogRef.close();\n  }\n\n  public createGeoQueryForm(collectionName: string, displayCollectionName: string,\n      filterGeometries: Array<GeometrySelectModel>, operationsSelectModel: Array<OperationSelectModel>): void {\n    /** geometry */\n    const geometryPaths = filterGeometries.map(fg => fg.path);\n    const selectedGeometry = filterGeometries.find(fg => fg.selected);\n    const selectedGeometryPath = !!selectedGeometry ? selectedGeometry.path : '';\n    /** operation */\n    const operations = operationsSelectModel.map(osm => osm.operation);\n    const selectedOperationSelectModel = operationsSelectModel.find(osm => osm.selected);\n    const selectedOperation = !!selectedOperationSelectModel ?  selectedOperationSelectModel.operation : GeoQueryOperator.INTERSECTS;\n    const geoQueryControls = {\n      a_operation: new SelectFormControl(selectedOperation, '', operations),\n      b_geometryPath: new SelectFormControl(selectedGeometryPath, '', geometryPaths),\n      c_collection: new UntypedFormControl(collectionName),\n      d_displayCollectionName: new UntypedFormControl(displayCollectionName),\n    };\n    const geoQueryForm = new UntypedFormGroup(geoQueryControls);\n    /** snapshot defaultselections */\n    this.emittedGeoQueries.clear();\n    this.selectionsSnapshot.clear();\n    this.selectionsSnapshot.set(collectionName, selectedGeometry + selectedOperation);\n    geoQueryForm.valueChanges\n      .pipe(takeUntil(this._onDestroy$))\n      .subscribe(vc => {\n      const selectionSnapShot = vc.b_geometryPath + vc.a_operation;\n      /** ignore selection changes if the user go back to initial state of a control */\n      const ignoreChange = selectionSnapShot === this.selectionsSnapshot.get(vc.c_collection);\n      if (ignoreChange) {\n        this.emittedGeoQueries.delete(vc.c_collection);\n      } else {\n        this.emittedGeoQueries.set(vc.c_collection, {\n          geometry_path: vc.b_geometryPath,\n          operation: vc.a_operation\n        });\n      }\n    });\n    this.collectionsColors.push((this.colorGeneratorLoader.getColor(collectionName)));\n    this.geoQueriesFormGroups.push(geoQueryForm);\n  }\n}\n\n@Component({\n  selector: 'arlas-map-settings',\n  templateUrl: './map-settings.component.html',\n  styleUrls: ['./map-settings.component.scss']\n})\nexport class MapSettingsComponent {\n\n  /**\n   * @Output : Angular\n   * Emits the geo-query to apply. A geo-query is defined by\n   * - the operation (\"within\", \"intersects\", \"notwithin\", \"notintersects\")\n   * - the geometry field to query\n   */\n  @Output() public geoQueryEmitter = new Subject<Map<string, GeoQuery>>();\n\n  public dialogRef: MatDialogRef<MapSettingsDialogComponent>;\n\n  public constructor(public dialog: MatDialog) { }\n\n  public openDialog(mapSettingsService: MapSettingsService) {\n    this.dialogRef = this.dialog.open(MapSettingsDialogComponent, { data: null, panelClass: 'map-settings-dialog' });\n    const mapGeoQueries = mapSettingsService.getGeoQueries();\n    if (!!mapGeoQueries) {\n      mapGeoQueries.forEach((geoQueries, collection) => {\n        this.dialogRef.componentInstance.createGeoQueryForm(collection, geoQueries[2], geoQueries[0], geoQueries[1]);\n      });\n    }\n    this.dialogRef.componentInstance.geoQueryEmitter = this.geoQueryEmitter;\n  }\n}\n","<h1 mat-dialog-title class=\"mapgl-settings__title\">\n  {{ 'Geo-queries' | translate }}\n</h1>\n\n<div mat-dialog-content class=\"mapgl-settings\">\n  <div class=\"mapgl-settings__description\">\n    {{ GEO_QUERIES_DESCRIPTION | translate }}\n  </div>\n  <div class=\"mapgl-settings__form\" *ngFor=\"let formGroup of geoQueriesFormGroups; let i = index\"\n      [formGroup]=\"formGroup\" [style.borderLeftColor]=\"collectionsColors[i]\">\n    <div class=\"mapgl-settings__form__steps\">\n      <div *ngFor=\"let control of formGroup.controls | keyvalue\" class=\"mapgl-settings__form__steps__item\">\n        <div *ngIf=\"control.key === 'd_displayCollectionName'\">\n          {{ 'of_collection' | translate: { collection: (control.value.value | getCollectionDisplayName | translate) } }}\n        </div>\n        <mat-form-field *ngIf=\"control.key !== 'c_collection' && control.key !== 'color' && control.key !== 'd_displayCollectionName'\">\n          <mat-label>{{ control.key | translate }}</mat-label>\n          <mat-select [formControl]=\"control.value\">\n            <mat-option *ngFor=\"let option of control.value.syncOptions\" [value]=\"option\">\n              {{option | translate}}\n            </mat-option>\n          </mat-select>\n        </mat-form-field>\n      </div>\n    </div>\n  </div>\n</div>\n\n<div mat-dialog-actions class=\"mapgl-settings__actions\">\n  <button mat-button class=\"mapgl-settings__actions--apply\"\n    (click)=\"emitGeoFilter()\">{{ 'Apply geo-queries' | translate }}</button>\n  <button mat-button class=\"mapgl-settings__actions--apply\"\n    (click)=\"emitGeoFilter();onClose()\">{{ 'Set geo-queries' | translate }}</button>\n  <button mat-button class=\"mapgl-settings__actions--cancel\"\n    (click)=\"onClose()\">{{ 'Cancel' | translate}}</button>\n</div>\n\n\n","\n","/*\n * Licensed to Gisaïa under one or more contributor\n * license agreements. See the NOTICE.txt file distributed with\n * this work for additional information regarding copyright\n * ownership. Gisaïa licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\n\nexport interface OnMoveResult {\n  zoom: number;\n  zoomStart: number;\n  center: Array<number>;\n  centerWithOffset: Array<number>;\n  extend: Array<number>;\n  extendWithOffset: Array<number>;\n  rawExtendWithOffset: Array<number>;\n  extendForLoad: Array<number>;\n  extendForTest: Array<number>;\n  rawExtendForLoad: Array<number>;\n  rawExtendForTest: Array<number>;\n  xMoveRatio: number;\n  yMoveRatio: number;\n  visibleLayers: Set<string>;\n}\n\nexport class ArlasLngLat {\n  public lng: number;\n  public lat: number;\n\n  public constructor(lng, lat) {\n    this.lng = lng;\n    this.lat = lat;\n  }\n\n  public toArray(): number[] {\n    return [this.lng, this.lat];\n  }\n}\n\nexport class ArlasLngLatBounds {\n  public sw: ArlasLngLat;\n  public ne: ArlasLngLat;\n\n  public constructor(sw: ArlasLngLat, ne: ArlasLngLat) {\n    this.sw = sw;\n    this.ne = ne;\n  }\n\n  public getEast() {\n    return this.ne.lng;\n  }\n\n  public getNorth() {\n    return this.ne.lat;\n  }\n\n  public getWest() {\n    return this.sw.lng;\n  }\n\n  public getSouth() {\n    return this.sw.lat;\n  }\n}\n\n","/*\n * Licensed to Gisaïa under one or more contributor\n * license agreements. See the NOTICE.txt file distributed with\n * this work for additional information regarding copyright\n * ownership. Gisaïa licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { Injectable } from '@angular/core';\nimport { AbstractArlasMapGL, MapConfig } from './map/AbstractArlasMapGL';\nimport { AbstractDraw } from './draw/AbstractDraw';\nimport { ArlasLngLat, ArlasLngLatBounds } from './map/model/map';\nimport { FeatureCollection } from '@turf/helpers';\nimport { VectorStyle } from './map/model/vector-style';\nimport { ArlasPoint } from './map/model/geometry';\nimport { MapLayerMouseEvent } from './map/model/events';\n\n/**\n * This service exposes a list of map interaction methods that are abstract.\n * Theses methods will be implemented by the chosen cartographical framework to use.\n */\n@Injectable({\n  providedIn: 'root'\n})\n/** L: a layer class/interface.\n *  S: a source class/interface.\n *  M: a Map configuration class/interface.\n */\nexport abstract class ArlasMapFrameworkService<L, S, M> {\n\n  public constructor() { }\n\n  public abstract getInitTransformRequest(): Function;\n\n  public abstract createMap(config: MapConfig<M>): AbstractArlasMapGL;\n\n  public abstract createDraw(drawOptions, enabled: boolean, map: AbstractArlasMapGL): AbstractDraw;\n\n  /**\n   * @description Gets the bounds from the two given coordinates.\n   * @param c1 Coordinates of the first corner.\n   * @param c2 Coordinates of the second corner.\n   * @returns Bounds formed from the two given coordinates.\n   */\n  public getLngLatBound(c1: ArlasLngLat, c2: ArlasLngLat): ArlasLngLatBounds {\n    return new ArlasLngLatBounds(c1, c2);\n  }\n\n  /**\n   * Fits the map to its current bounds. To be used when a map container is resized.\n   * @param map Map instance.\n   */\n  public abstract fitMapBounds(map: AbstractArlasMapGL);\n\n  public abstract getBoundsAsString(map: AbstractArlasMapGL): string;\n\n  /**\n   * @description Gets the Point (geometry) from mouse click on the screen.\n   * @param mouseEvent Click mouse event.\n   * @param container Map container.\n   * @returns a Point instance.\n   */\n  public abstract getPointFromScreen(mouseEvent: MouseEvent, container: HTMLElement): ArlasPoint;\n\n  /**\n   * @description Sets `data` to a Geojson `source` of the map\n   * @param source A Geojson source\n   * @param data A feature collection object.\n   */\n  public abstract setDataToGeojsonSource(source: S | string, data: FeatureCollection<GeoJSON.Geometry>);\n\n\n  /**\n   * Returns the canvas element of the map\n   * @param map Map instance.\n   */\n  public abstract getCanvas(map: AbstractArlasMapGL): HTMLCanvasElement;\n\n  public abstract addImage(name: string, url: string, map: AbstractArlasMapGL, errorMessage: string, opt?: any);\n\n  /**\n   * @description Adds a layer to the map instance.\n   * @param map Map instance.\n   * @param layer A layer. It could be a layer identifier OR a layer object (it will depend on the framwork implementation).\n   * @param beforeId Identifier of an already added layer. The 'layer' is added under this 'beforeId' layer.\n   */\n  public abstract addLayer(map: AbstractArlasMapGL, layer: L, beforeId?: L | string);\n\n  public abstract getLayersFromPattern(map: AbstractArlasMapGL, layersIdPattern: string): L[];\n  public abstract getAllLayers(map: AbstractArlasMapGL): L[];\n\n  public abstract hasLayer(map: AbstractArlasMapGL, layer: L | string);\n  public abstract hasLayersFromPattern(map: AbstractArlasMapGL, layersIdPattern: string);\n  public abstract moveLayer(map: AbstractArlasMapGL, layer: L | string, beforeId?: string);\n  public abstract onLayerEvent(eventName: string, map: AbstractArlasMapGL, layer: any, fn: (e) => void);\n  public abstract removeLayer(map: AbstractArlasMapGL, layer: L | string);\n  public abstract removeLayers(map: AbstractArlasMapGL, layers: L[] | string[]);\n  public abstract removeLayersFromPattern(map: AbstractArlasMapGL, layersIdPattern: string);\n  public abstract setLayerVisibility(layer: L | string, isVisible: boolean, map: AbstractArlasMapGL);\n  public abstract isLayerVisible(layer: L | string): boolean;\n  public abstract getLayer(map: AbstractArlasMapGL, layerId: string): L;\n\n\n  public abstract queryFeatures(mouseEvent: MapLayerMouseEvent, map: AbstractArlasMapGL, layersIdPattern: string, options?: any);\n  public abstract hasSource(map: AbstractArlasMapGL, source: L | AbstractArlasMapGL | string);\n  public abstract getSource(sourceId: string, options: L | AbstractArlasMapGL | string): S;\n  public abstract getAllSources(options:  L | AbstractArlasMapGL | string): S[];\n  public abstract setSource(sourceId: string, source: S, options: L | AbstractArlasMapGL | string);\n  public abstract removeSource(map: AbstractArlasMapGL, source: S | string);\n\n  public abstract addPopup(map: AbstractArlasMapGL, popup: any);\n  public abstract createPopup(lng: number, lat: number, message: string);\n  public abstract removePopup(map: AbstractArlasMapGL, popup: any);\n\n  public abstract onMapEvent(eventName: any, map: AbstractArlasMapGL, fn: (e) => void);\n  public abstract setMapCursor(map: AbstractArlasMapGL, cursor: string): void;\n  public abstract flyTo(lat: number, lng: number, zoom: number, map: AbstractArlasMapGL);\n\n  public abstract addIconLayer(map: AbstractArlasMapGL, layerId: string, iconName: string,\n    iconSize: number, data: GeoJSON.Feature<GeoJSON.Geometry> | GeoJSON.FeatureCollection<GeoJSON.Geometry>);\n  public abstract addRasterLayer(map: AbstractArlasMapGL, layerId: string, url: string, bounds: number[],\n    maxZoom: number, tileSize: number, beforeId?: string): void;\n\n  public abstract addGeojsonLayer(map: AbstractArlasMapGL, layerId: string, style: VectorStyle,\n    data: GeoJSON.Feature<GeoJSON.Geometry> | GeoJSON.FeatureCollection<GeoJSON.Geometry>\n  ): void;\n\n\n  public abstract filterGeojsonData(map: AbstractArlasMapGL, layer: L | string, filter: any);\n\n  public abstract createGeojsonSource(data: GeoJSON.GeoJSON): S;\n  public abstract createRasterSource(url: string, bounds: number[],\n    maxZoom: number, tileSize: number): S;\n\n}\n","/*\n * Licensed to Gisaïa under one or more contributor\n * license agreements. See the NOTICE.txt file distributed with\n * this work for additional information regarding copyright\n * ownership. Gisaïa licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nexport interface ArlasDataLayer {\n  id: string;\n  type: string;\n  minzoom?: number;\n  maxzoom?: number;\n  source?: string;\n  metadata?: LayerMetadata;\n  paint: ArlasPaint;\n  layout?: any;\n  filter?: any;\n}\n\nexport interface MapLayers<T> {\n  layers: Array<T>;\n  externalEventLayers?: Array<ExternalEventLayer>;\n  events: LayerEvents;\n}\n\nexport interface LayerEvents {\n  onHover: Set<string>;\n  emitOnClick: Set<string>;\n  zoomOnClick: Set<string>;\n}\n\nexport interface ExternalEventLayer {\n  id: string;\n  on: ExternalEvent;\n}\n\nexport enum ExternalEvent {\n  select = 'select',\n  hover = 'hover'\n}\n\n\nexport interface FillStroke {\n  width?: PaintValue;\n  opacity?: number;\n  color?: PaintValue;\n}\n\n/** Metadata of a layer containing info about\n * - the collection\n * - whether it has an interaction with the resultlist (scrollable)\n * - geomType for circle heatmap.\n */\nexport interface LayerMetadata {\n  collection?: string;\n  collectionDisplayName?: string;\n  stroke?: FillStroke;\n  isScrollableLayer?: boolean;\n  hiddenProps?: MetadataHiddenProps;\n  showLegend?: boolean;\n}\nexport interface MetadataHiddenProps {\n  geomType?: string;\n}\n\nexport type PaintValue = Array<string | Array<string> | number> | PaintColor | string | number;\nexport interface ArlasPaint { [key: string]: PaintValue; }\nexport interface PaintColor {\n  property: string;\n  type: string;\n  stops: Array<Array<string>>;\n}\n\n\nexport const HOVER_LAYER_PREFIX = 'arlas-hover-';\nexport const SELECT_LAYER_PREFIX = 'arlas-select-';\nexport const FILLSTROKE_LAYER_PREFIX = 'arlas-fill_stroke-';\nexport const SCROLLABLE_ARLAS_ID = 'scrollable_arlas_id:';\nexport const ARLAS_ID = 'arlas_id:';\nexport const ARLAS_VSET = ':arlas_vset:';\n\n/** FROM V15.0.0 layer ids look like 'arlas_id:NAME:timestamp\n   * This pipe extracts the 'NAME' in that id\n   */\nexport function getLayerName(id: string): string {\n  if (!!id && id.startsWith(ARLAS_ID)) {\n    const datedName = id.split(ARLAS_ID)[1];\n    const undatedName = datedName.split(':')[0];\n    return undatedName;\n  }\n  return id;\n}\n","/*\n * Licensed to Gisaïa under one or more contributor\n * license agreements. See the NOTICE.txt file distributed with\n * this work for additional information regarding copyright\n * ownership. Gisaïa licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { Injectable } from '@angular/core';\nimport { ArlasMapFrameworkService } from './arlas-map-framework.service';\nimport { FeatureCollection } from '@turf/helpers';\nimport { AbstractArlasMapGL } from './map/AbstractArlasMapGL';\nimport { ArlasMapSource } from './map/model/sources';\nimport { VisualisationSetConfig } from './map/model/visualisationsets';\nimport { ArlasDataLayer, ExternalEvent, MapLayers } from './map/model/layers';\nimport { ElementIdentifier } from 'arlas-web-components';\n\n/**\n * This service propose a set of method to execute the ArlasMapComponent logic.\n * Do not confuse with ArlasMapFrameworkService that is more dedicated to a framework logic.\n */\n@Injectable({\n  providedIn: 'root'\n})\n/** L: a layer class/interface.\n *  S: a source class/interface.\n *  M: a Map configuration class/interface.\n */\nexport abstract class AbstractArlasMapService<L, S, M> {\n  /** @description List of arlas data sources declared in configuration */\n  public dataSources: S[] = [];\n  /** @description Map of ARLAS data layers and their ids (the ids being the key of the map).  */\n  public layersMap: Map<string, ArlasDataLayer>;\n  /**\n   * @description Object to describe visualisation sets\n   * - visulisations: a map of <visualisation name, set of layers identifiers>;\n   * - status: a map of <visualisation name, visibility status>\n   */\n  public visualisationsSets: {\n    visualisations: Map<string, Set<string>>;\n    status: Map<string, boolean>;\n  } = {\n      visualisations: new Map(),\n      status: new Map()\n    };\n\n  public constructor(public mapFrameworkService: ArlasMapFrameworkService<L, S, M>) { }\n\n  /**\n   * @description Declares the arlas data sources provided in configuration.\n   * @param dataSourcesIds Identifiers of arlas data sources.\n   * @param data A feature collection.\n   * @param map Map instance.\n   */\n  public abstract declareArlasDataSources(dataSourcesIds: Set<string>, data: FeatureCollection<GeoJSON.Geometry>, map: AbstractArlasMapGL): void;\n\n  public abstract declareLabelSources(labelSourceId: string, data: FeatureCollection<GeoJSON.Geometry>, map: AbstractArlasMapGL): void;\n\n  public abstract declareBasemapSources(basemapSources: Array<ArlasMapSource<any>>, map: AbstractArlasMapGL): void;\n\n  public abstract setLayersMap(mapLayers: MapLayers<ArlasDataLayer>, layers?: Array<ArlasDataLayer>);\n\n  public updateLabelSources(labelSourceId: string, data: FeatureCollection<GeoJSON.Geometry>, map: AbstractArlasMapGL) {\n    if (labelSourceId) {\n      const source = this.mapFrameworkService.getSource(labelSourceId, map);\n      this.mapFrameworkService.setDataToGeojsonSource(source, data);\n    }\n  }\n\n  /**\n   * @description Inits a map of visulisation sets from the configuration.\n   * @param visualisationSetsConfig Visualisation set configuration.\n   */\n  public initVisualisationSet(visualisationSetsConfig: VisualisationSetConfig[]) {\n    if (visualisationSetsConfig) {\n      visualisationSetsConfig.forEach(visu => {\n        this.visualisationsSets.visualisations.set(visu.name, new Set(visu.layers));\n        this.visualisationsSets.status.set(visu.name, visu.enabled);\n      });\n    }\n  }\n\n  public initMapLayers(mapLayers: MapLayers<ArlasDataLayer>, map: AbstractArlasMapGL) {\n    if (mapLayers) {\n      this.setLayersMap(mapLayers);\n    }\n  }\n\n  public abstract moveArlasDataLayer(map: AbstractArlasMapGL, layer: any, layersMap: Map<string, ArlasDataLayer>, beforeId?: string);\n\n  /**\n   * Add a layer to the map instance. This method handles any specific treatment when adding ARLAS data.\n   * For instance, in mapbox and maplibre implementation, adding a fill layer needs to add systematically the stroke layer.\n   * @param map Map instance.\n   * @param layer A layer. It could be a layer identifier OR a layer object (it will depend on the framwork implementation).\n   * @param layersMap Map of ARLAS data layers and their ids (the ids being the key of the map).\n   * @param beforeId Identifier of an already added layer. The layers of layersMap are added under this 'beforeId' layer.\n   */\n  public abstract addArlasDataLayer(map: AbstractArlasMapGL, layer: ArlasDataLayer | string,\n    layersMap: Map<string, ArlasDataLayer>, beforeId?: string);\n\n  public addArlasDataLayers(visualisationSetsConfig: VisualisationSetConfig[], mapLayers: MapLayers<ArlasDataLayer>, map: AbstractArlasMapGL) {\n    this.initMapLayers(mapLayers, map);\n    this.initVisualisationSet(visualisationSetsConfig);\n    for (let i = visualisationSetsConfig.length - 1; i >= 0; i--) {\n      const visualisation: VisualisationSetConfig = visualisationSetsConfig[i];\n      if (visualisation.layers) {\n        for (let j = visualisation.layers.length - 1; j >= 0; j--) {\n          const l = visualisation.layers[j];\n          const layer = this.layersMap.get(l);\n          this.addArlasDataLayer(map, layer, this.layersMap);\n        }\n      }\n    }\n    this._addExternalEventLayers(mapLayers, map);\n    this.visualisationsSets.status.forEach((visible, vs) => {\n      this.visualisationsSets.visualisations.get(vs).forEach(l => {\n        this.mapFrameworkService.setLayerVisibility(l, visible, map);\n      });\n    });\n    this.reorderLayers(visualisationSetsConfig, map);\n  }\n\n  private _addExternalEventLayers(mapLayers: MapLayers<ArlasDataLayer>, map: AbstractArlasMapGL) {\n    if (mapLayers.externalEventLayers) {\n      mapLayers.layers\n        .filter(layer => mapLayers.externalEventLayers.map(e => e.id).indexOf(layer.id) >= 0)\n        .forEach(l => {\n          this.mapFrameworkService.addLayer(map, l as L);\n        });\n    }\n  }\n\n\n  public reorderLayers(visualisationSetsConfig: VisualisationSetConfig[], map: AbstractArlasMapGL) {\n    // parses the visulisation list from bottom in order to put the fist ones first\n    for (let i = visualisationSetsConfig.length - 1; i >= 0; i--) {\n      const visualisation: VisualisationSetConfig = visualisationSetsConfig[i];\n      if (!!visualisation.layers && visualisation.enabled) {\n        for (let j = visualisation.layers.length - 1; j >= 0; j--) {\n          const l = visualisation.layers[j];\n          this.moveArlasDataLayer(map, l, this.layersMap);\n        }\n      }\n    }\n    this.reorderDrawLayers(map);\n\n  }\n\n  protected abstract reorderDrawLayers(map: AbstractArlasMapGL);\n\n\n  public abstract filterLayers(mapLayers: MapLayers<ArlasDataLayer>, map: AbstractArlasMapGL,\n    visibilityCondition: boolean, visibilityFilter: Array<any>, visibilityEvent: ExternalEvent,\n    collection?: string): void;\n\n  public selectFeatures(mapLayers: MapLayers<ArlasDataLayer>, map: AbstractArlasMapGL, elementToSelect: Array<ElementIdentifier>) {\n    if (elementToSelect) {\n      const ids = elementToSelect.length > 0 ?\n        elementToSelect.reduce((memo, element) => {\n          memo.push(element.idValue);\n          return memo;\n        }, []) : [];\n      const numericalIds = ids.filter(id => !isNaN(+id)).map(id => +id);\n      const visibilityFilter = ids.length > 0 ? ['in', ['get', elementToSelect[0].idFieldName], ['literal', ids.concat(numericalIds)]] : [];\n      this.filterLayers(mapLayers, map, (elementToSelect.length > 0), visibilityFilter, ExternalEvent.select);\n    }\n  }\n\n  public highlightFeature(mapLayers: MapLayers<ArlasDataLayer>, map: AbstractArlasMapGL,\n    featureToHightLight: { isleaving: boolean; elementidentifier: ElementIdentifier; }) {\n    if (featureToHightLight?.elementidentifier) {\n      const ids: Array<number | string> = [featureToHightLight.elementidentifier.idValue];\n      if (!isNaN(+featureToHightLight.elementidentifier.idValue)) {\n        ids.push(+featureToHightLight.elementidentifier.idValue);\n      }\n      const visibilityFilter = ['in', ['get', featureToHightLight.elementidentifier.idFieldName],\n        ['literal', ids]];\n      this.filterLayers(mapLayers, map, !featureToHightLight.isleaving, visibilityFilter, ExternalEvent.hover);\n    }\n  }\n\n  public selectFeaturesByCollection(mapLayers: MapLayers<ArlasDataLayer>, map: AbstractArlasMapGL,\n    features: Array<ElementIdentifier>, collection: string) {\n    const ids: Array<number | string> = features.map(f => f.idValue);\n    const numericalIds = ids.filter(id => !isNaN(+id)).map(id => +id);\n    const visibilityFilter = ids.length > 0 ? ['in', ['get', features[0].idFieldName], ['literal', ids.concat(numericalIds)]] : [];\n    this.filterLayers(mapLayers, map, (features.length > 0), visibilityFilter, ExternalEvent.select, collection);\n  }\n\n\n  public updateLayoutVisibility(visualisationName: string, visualisationSetsConfig: VisualisationSetConfig[], map: AbstractArlasMapGL) {\n    const visuStatus = !this.visualisationsSets.status.get(visualisationName);\n    visualisationSetsConfig.find(v => v.name === visualisationName).enabled = visuStatus;\n    if (!visuStatus) {\n      const layersSet = new Set(this.visualisationsSets.visualisations.get(visualisationName));\n      this.visualisationsSets.visualisations.forEach((ls, v) => {\n        if (v !== visualisationName) {\n          ls.forEach(ll => {\n            if (layersSet?.has(ll)) {\n              layersSet.delete(ll);\n            }\n          });\n        }\n      });\n      layersSet.forEach(ll => {\n        this.mapFrameworkService.setLayerVisibility(ll, false, map);\n      });\n    }\n    this.visualisationsSets.status.set(visualisationName, visuStatus);\n    const layers = new Set<string>();\n    this.visualisationsSets.visualisations.forEach((ls, v) => {\n      if (this.visualisationsSets.status.get(v)) {\n        ls.forEach(l => {\n          layers.add(l);\n          this.mapFrameworkService.setLayerVisibility(l, true, map);\n        });\n      }\n    });\n    return layers;\n  }\n\n  public updateVisibility(visibilityStatus: Map<string, boolean>, visualisationSetsConfig: VisualisationSetConfig[], map: AbstractArlasMapGL) {\n    visibilityStatus.forEach((visibilityStatus, l) => {\n      let layerInVisualisations = false;\n      if (!visibilityStatus) {\n        visualisationSetsConfig.forEach(v => {\n          const ls = new Set(v.layers);\n          if (!layerInVisualisations) {\n            layerInVisualisations = ls.has(l);\n          }\n        });\n        if (layerInVisualisations) {\n          this.mapFrameworkService.setLayerVisibility(l, false, map);\n        }\n      } else {\n        let oneVisualisationEnabled = false;\n        visualisationSetsConfig.forEach(v => {\n          const ls = new Set(v.layers);\n          if (!layerInVisualisations) {\n            layerInVisualisations = ls.has(l);\n          }\n          if (ls.has(l) && v.enabled) {\n            oneVisualisationEnabled = true;\n            this.mapFrameworkService.setLayerVisibility(l, true, map);\n          }\n        });\n        if (!oneVisualisationEnabled && layerInVisualisations) {\n          this.mapFrameworkService.setLayerVisibility(l, false, map);\n        }\n      }\n    });\n  }\n\n\n  public findVisualisationSetLayer(visuName: string, visualisationSetsConfig: VisualisationSetConfig[]) {\n    return visualisationSetsConfig.find(v => v.name === visuName).layers;\n  }\n  public setVisualisationSetLayers(visuName: string, layers: string[], visualisationSetsConfig: VisualisationSetConfig[]) {\n    const f = visualisationSetsConfig.find(v => v.name === visuName);\n    if (f) {\n      f.layers = layers;\n    }\n  }\n\n  public abstract updateMapStyle(map: AbstractArlasMapGL, l: any, ids: Array<string | number>, sourceName: string): void;\n\n  public abstract getVisibleIdsFilter(map: AbstractArlasMapGL, layer: any, ids: Array<string | number>);\n}\n","/*\n * Licensed to Gisaïa under one or more contributor\n * license agreements. See the NOTICE.txt file distributed with\n * this work for additional information regarding copyright\n * ownership. Gisaïa licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { Injectable } from '@angular/core';\nimport { ArlasBasemaps } from './basemaps.model';\nimport { BasemapStyle } from './basemap.config';\nimport { Observable, Subject } from 'rxjs';\nimport { HttpClient } from '@angular/common/http';\nimport { AbstractArlasMapGL } from '../map/AbstractArlasMapGL';\nimport { ArlasMapFrameworkService } from '../arlas-map-framework.service';\n\n@Injectable({\n  providedIn: 'root'\n})\n/** L: a layer class/interface.\n *  S: a source class/interface.\n *  M: a Map configuration class/interface.\n */\nexport abstract class BasemapService<L, S, M> {\n\n  protected POWERED_BY_ARLAS = ' Powered by ARLAS.';\n  protected LOCAL_STORAGE_BASEMAPS = 'arlas_last_base_map';\n\n\n  protected basemapChangedSource: Subject<void> = new Subject();\n  public basemapChanged$ = this.basemapChangedSource.asObservable();\n  public basemaps: ArlasBasemaps;\n\n  protected protomapBasemapAddedSource = new Subject<boolean>();\n  public protomapBasemapAdded$ = this.protomapBasemapAddedSource.asObservable();\n\n  protected constructor(protected http: HttpClient, protected mapFrameworkService: ArlasMapFrameworkService<L, S, M>) { }\n\n  public setBasemaps(basemaps: ArlasBasemaps) {\n    this.basemaps = basemaps;\n  }\n\n  public abstract addProtomapBasemap(map: AbstractArlasMapGL);\n\n  protected addPMtilesToSource(map: AbstractArlasMapGL, pmtilesSource: any) {\n    /* eslint-disable max-len */\n    pmtilesSource['attribution'] = '<a href=\"https://protomaps.com/\" target=\"_blank\">Protomaps</a> <a href=\"https://www.openstreetmap.org/copyright\" target=\"_blank\">&copy; OpenStreetMap</a>';\n    pmtilesSource['attribution'] = pmtilesSource['attribution'] + this.POWERED_BY_ARLAS;\n    this.mapFrameworkService.setSource('arlas_protomaps_source', pmtilesSource, map);\n  }\n\n  protected addProtomapLayerToMap(map: AbstractArlasMapGL, styleFile: any) {\n    styleFile.layers.forEach(l => {\n      this.mapFrameworkService.removeLayer(map, l.id);\n      this.mapFrameworkService.addLayer(map, l);\n    });\n  }\n\n  public notifyProtomapAddition() {\n    this.protomapBasemapAddedSource.next(true);\n  }\n\n  public abstract removeProtomapBasemap(map: AbstractArlasMapGL);\n\n  public abstract declareProtomapProtocol(map: AbstractArlasMapGL): void;\n  public cloneStyleFile<T>(selected: any) {\n    return { ...selected.styleFile as T};\n  }\n\n  public buildInitStyle<StyleType, LayerSpec>(clonedStyleFile: StyleType) {\n    (<any>clonedStyleFile).sources = {\n      protomaps_attribution: {\n        'type': 'vector',\n        // eslint-disable-next-line max-len\n        'attribution': '<a href=\"https://protomaps.com/\" target=\"_blank\">Protomaps</a> <a href=\"https://www.openstreetmap.org/copyright\" target=\"_blank\">&copy; OpenStreetMap</a>' + this.POWERED_BY_ARLAS\n      }\n    };\n    (<any>clonedStyleFile).layers = [{\n      id: 'backgrounds',\n      type: 'background',\n      source: 'protomaps_attribution',\n      paint: {\n        'background-color': 'rgba(0,0,0,0)'\n      }\n    } as unknown as LayerSpec];\n    return clonedStyleFile;\n  };\n  public abstract getInitStyle(selected: BasemapStyle): any;\n  public abstract fetchSources$(): Observable<readonly any[]>;\n  protected abstract getStyleFile(b: BasemapStyle): Observable<any>;\n  public abstract setBasemap(s: any, newBasemap: BasemapStyle, map: AbstractArlasMapGL, options?: any);\n}\n","/*\n * Licensed to Gisaïa under one or more contributor\n * license agreements. See the NOTICE.txt file distributed with\n * this work for additional information regarding copyright\n * ownership. Gisaïa licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { BasemapStyle } from './basemap.config';\n\nexport class ArlasBasemaps {\n  private LOCAL_STORAGE_BASEMAPS = 'arlas_last_base_map';\n  public _selectedStyle: BasemapStyle;\n  public _styles: BasemapStyle[];\n  private defaultBasemapStyle: BasemapStyle;\n  private basemapStyles?: BasemapStyle[];\n\n  public constructor(defaultBasemapStyle?: BasemapStyle, basemapStyles?: BasemapStyle[]) {\n    if (defaultBasemapStyle && basemapStyles) {\n      this.defaultBasemapStyle = defaultBasemapStyle;\n      this.basemapStyles = basemapStyles;\n    } else {\n      // todo throw error ?\n    }\n  }\n\n  public styles(): BasemapStyle[] {\n    if (!this._styles) {\n      this._styles = this.getAllBasemapStyles(this.defaultBasemapStyle, this.basemapStyles);\n    }\n    return this._styles.filter(b => !b.errored);\n  }\n\n  public setSelected(style: BasemapStyle) {\n    this._selectedStyle = style;\n    return this;\n  }\n\n  public getStyle(b: BasemapStyle) {\n    return this.styles().find(s => s.name === b?.name);\n  }\n\n  public getSelected(): BasemapStyle {\n    if (!this._selectedStyle) {\n      const styles = this.styles();\n      const localStorageBasemapStyle: BasemapStyle = JSON.parse(localStorage.getItem(this.LOCAL_STORAGE_BASEMAPS));\n      const sameNameBasemaps = localStorageBasemapStyle ? styles.filter(b => b.name === localStorageBasemapStyle.name) : [];\n      if (sameNameBasemaps.length > 0) {\n        this._selectedStyle = sameNameBasemaps[0];\n      } else if (!!this.getStyle(this.defaultBasemapStyle)) {\n        this._selectedStyle = this.getStyle(this.defaultBasemapStyle);\n      } else if (styles && styles.length > 0) {\n        this._selectedStyle = styles[0];\n      } else {\n        this._selectedStyle = {\n          name: 'Background',\n          styleFile: {\n            version: 8,\n            sources: {},\n            layers: [\n              {\n                id: 'backgrounds',\n                type: 'background',\n                paint: {\n                  'background-color': 'rgba(0,0,0,0)'\n                }\n              }\n            ]\n          }\n        };\n      }\n    }\n    return this._selectedStyle;\n  }\n\n\n  private getAllBasemapStyles(defaultBasemapTheme: BasemapStyle, basemapStyles: BasemapStyle[]): Array<BasemapStyle> {\n    const allBasemapStyles = new Array<BasemapStyle>();\n    if (basemapStyles) {\n      basemapStyles.forEach(b => allBasemapStyles.push(b));\n      if (defaultBasemapTheme) {\n        if (basemapStyles.map(b => b.name).filter(n => n === defaultBasemapTheme.name).length === 0) {\n          allBasemapStyles.push(defaultBasemapTheme);\n        }\n      }\n    } else if (defaultBasemapTheme) {\n      allBasemapStyles.push(defaultBasemapTheme);\n    }\n    return allBasemapStyles;\n  }\n}\n\n\n\n","/*\n * Licensed to Gisaïa under one or more contributor\n * license agreements. See the NOTICE.txt file distributed with\n * this work for additional information regarding copyright\n * ownership. Gisaïa licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { fromEvent, map, Observable, Subscription } from 'rxjs';\nimport { debounceTime } from 'rxjs/operators';\nimport { ControlPosition, ControlsOption, DrawControlsOption } from './model/controls';\nimport { MapExtent } from './model/extent';\nimport { ArlasLngLat, ArlasLngLatBounds, OnMoveResult } from './model/map';\nimport { marker } from '@colsen1991/ngx-translate-extract-marker';\nimport bbox from '@turf/bbox';\n\n\n/** Conf */\nexport interface MapConfig<T> {\n  displayCurrentCoordinates: boolean;\n  fitBoundsPadding: number;\n  margePanForLoad: number;\n  margePanForTest: number;\n  wrapLatLng: boolean;\n  offset: ArlasMapOffset;\n  mapProviderOptions?: T;\n  maxWidthScale?: number;\n  unitScale?: string;\n  controls?: ControlsOption;\n}\n\nexport interface ArlasMapOffset {\n  north: number;\n  east: number;\n  south: number;\n  west: number;\n}\n\nexport const GEOJSON_SOURCE_TYPE = 'geojson';\n\nexport const CROSS_LAYER_PREFIX = 'arlas_cross';\nexport const ZOOM_IN = marker('Zoom in');\nexport const ZOOM_OUT = marker('Zoom out');\nexport const RESET_BEARING = marker('Reset bearing to north');\nexport const LAYER_SWITCHER_TOOLTIP = marker('Manage layers');\n\n/**\n * The aim of this class is to handle all core interaction we have\n * with a map provider.\n * The aim is also to separate the Arlas map from the Angular framework.\n * It will be instantiated in the map.component and will be responsible for initializing the map and all map behavior.\n */\nexport abstract class AbstractArlasMapGL {\n  /**\n   *  props and methods with unknown type will be specific to the map provider\n   *  we use.\n   *  ex: endLngLat will have a type Maplibre.Pointlike/ Mapbox.Point\n   */\n\n  public abstract startLngLat: ArlasLngLat;\n  public abstract endLngLat: ArlasLngLat;\n  public abstract moveLngLat: ArlasLngLat;\n  protected _offset: ArlasMapOffset;\n  protected _margePanForLoad: number;\n  protected _margePanForTest: number;\n  protected _fitBoundsPadding: number;\n  protected _displayCurrentCoordinates: boolean;\n  protected _wrapLatLng: boolean;\n  protected _controls: ControlsOption;\n  protected _maxWidthScale?: number;\n  protected _unitScale?: string;\n  public currentLat: string;\n  public currentLng: string;\n  public readonly POLYGON_LABEL_SOURCE = 'polygon_label';\n\n  protected _north: number;\n  protected _east: number;\n  protected _west: number;\n  protected _south: number;\n  public zoom: number;\n  protected _zoomStart: number;\n\n  protected _dragStartX: number;\n  protected _dragStartY: number;\n\n  protected _dragEndX: number;\n  protected _dragEndY: number;\n\n  protected _xMoveRatio: number;\n  protected _yMoveRatio: number;\n\n  protected _moveEnd$: Observable<any>;\n  protected _zoomStart$: Observable<any>;\n  protected _dragStart$: Observable<any>;\n  protected _dragEnd$: Observable<any>;\n\n  protected _eventSubscription: Subscription[] = [];\n\n  protected evented = new EventTarget();\n\n  protected constructor(protected config: MapConfig<any>) {\n    this.config = config;\n    this._offset = config.offset;\n    this._margePanForLoad = config.margePanForLoad;\n    this._margePanForTest = config.margePanForTest;\n    this._displayCurrentCoordinates = config.displayCurrentCoordinates ?? false;\n    this._wrapLatLng = config.wrapLatLng ?? true;\n    this._controls = config.controls;\n    this._fitBoundsPadding = config.fitBoundsPadding ?? 10;\n    this._maxWidthScale = config.maxWidthScale;\n    this._unitScale = config.unitScale;\n    this.init(config);\n  }\n\n  protected init(config: MapConfig<any>): void {\n    try {\n      this._initMapProvider(config);\n      this._initControls();\n      this._initOnLoad();\n      this._initMapMoveEvents();\n    } catch (e) {\n      console.log(e);\n    }\n  }\n\n  protected _initOnLoad() {\n    this.onLoad(() => {\n      this.evented.dispatchEvent(new Event('beforeOnLoadInit'));\n      this._updateBounds();\n      this._updateZoom();\n      this.getMapProvider().fitBounds(this.getBounds());\n    });\n  }\n\n  public onCustomEvent(event: string, loadFn: () => void) {\n    this.evented.addEventListener(event, loadFn);\n  }\n\n  protected _initMapMoveEvents() {\n    this._zoomStart$ = fromEvent(this.getMapProvider(), 'zoomstart')\n      .pipe(debounceTime(750));\n\n    this._dragStart$ = fromEvent(this.getMapProvider(), 'dragstart')\n      .pipe(debounceTime(750));\n\n    this._dragEnd$ = fromEvent(this.getMapProvider(), 'dragend')\n      .pipe(debounceTime(750));\n\n    this._moveEnd$ = fromEvent(this.getMapProvider(), 'moveend')\n      .pipe(debounceTime(750));\n\n    this._updateOnZoomStart();\n    this._updateOnDragStart();\n    this._updateOnDragEnd();\n    this._updateOnMoveEnd();\n  }\n\n  protected _updateBounds(): void {\n    this._west = this.getWestBounds();\n    this._south = this.getSouthBounds();\n    this._east = this.getEastBounds();\n    this._north = this.getNorthBounds();\n  }\n\n  protected _updateZoom(e?: any): void {\n    this.zoom = this.getZoom();\n  }\n\n  protected _updateCurrentLngLat(e: any): void {\n    const lngLat = e.lngLat;\n    if (this._displayCurrentCoordinates) {\n      const displayedLngLat = this._wrapLatLng ? lngLat.wrap() : lngLat;\n      this.currentLng = String(Math.round(displayedLngLat.lng * 100000) / 100000);\n      this.currentLat = String(Math.round(displayedLngLat.lat * 100000) / 100000);\n    }\n  }\n\n  protected _updateDragEnd(e: any): void {\n    if (e.originalEvent) {\n      this._dragEndX = e.originalEvent.clientX;\n      this._dragEndY = e.originalEvent.clientY;\n    }\n  }\n\n  protected _updateDragStart(e: any): void {\n    this._dragStartX = e.originalEvent.clientX;\n    this._dragStartY = e.originalEvent.clientY;\n  }\n\n  protected _updateEndLngLat(e: any): void {\n    this.endLngLat = e.lngLat;\n  }\n\n  protected _updateMoveRatio(e: any): void {\n    this._xMoveRatio = Math.abs(this._dragEndX - this._dragStartX) / e.target._canvas.clientWidth;\n    this._yMoveRatio = Math.abs(this._dragEndY - this._dragStartY) / e.target._canvas.clientHeight;\n  }\n\n  protected _updateStartLngLat(e: any): void {\n    this.startLngLat = e.lngLat;\n  }\n\n\n  protected _updateZoomStart(): void {\n    this._zoomStart = this.getZoom();\n  }\n\n  protected _updateOnZoomStart() {\n    const sub = this._zoomStart$.subscribe(_ => this._updateZoomStart());\n    this._eventSubscription.push(sub);\n  }\n\n  protected _updateOnDragStart() {\n    const sub = this._dragStart$.subscribe(e => this._updateDragStart(e));\n    this._eventSubscription.push(sub);\n  }\n\n  protected _updateOnDragEnd() {\n    const sub = this._dragEnd$\n      .subscribe(e => {\n        this._updateDragEnd(e);\n        this._updateMoveRatio(e);\n      });\n    this._eventSubscription.push(sub);\n  }\n\n  protected _updateOnMoveEnd() {\n    const sub = this._moveEnd$\n      .subscribe(_ => {\n        this._updateBounds();\n        this._updateZoom();\n      });\n    this._eventSubscription.push(sub);\n  }\n\n  public onMoveEnd(visualisationsSets: {\n    visualisations: Map<string, Set<string>>;\n    status: Map<string, boolean>;\n  }, cb?: () => void) {\n    return this._moveEnd$\n      .pipe(map(_ => {\n        this._updateBounds();\n        this._updateZoom();\n        if (cb) {\n          cb();\n        }\n        return this._getMoveEnd(visualisationsSets);\n      }));\n  }\n\n  public setLayoutProperty(layer: string, name: string, value: any, options?: any) {\n    this.getMapProvider().setLayoutProperty(layer, name, value, options);\n    return this;\n  }\n\n  public unsubscribeEvents() {\n    this._eventSubscription.forEach(s => s.unsubscribe());\n  }\n\n  public getMaxZoom(): number {\n    return this.getMapProvider().getMaxZoom();\n  }\n\n  public getMinZoom(): number {\n    return this.getMapProvider().getMinZoom();\n  }\n\n  public getPitch(): number {\n    return this.getMapProvider().getPitch();\n  }\n\n  protected abstract _initMapProvider(BaseMapGlConfig): void;\n  protected abstract _initControls(): void;\n  protected abstract _getMoveEnd(visualisationsSets: {\n    visualisations: Map<string, Set<string>>;\n    status: Map<string, boolean>;\n  }): OnMoveResult;\n\n  public abstract addControl(control: any, position?: ControlPosition, eventOverride?: {\n    event: string; fn: (e?) => void;\n  });\n  public abstract calcOffsetPoint(): any;\n  public abstract disableDragPan(): void;\n  public abstract enableDragPan(): void;\n  public abstract fitBounds(bounds: ArlasLngLatBounds | number[], options?: unknown, unknown?: unknown): this;\n  public abstract fitToPaddedBounds(bounds: ArlasLngLatBounds | number[]);\n  public abstract getBounds(): unknown;\n  public abstract getCanvasContainer(): HTMLElement;\n  public abstract getEastBounds(): number;\n  public abstract getMapExtend(): MapExtent;\n  public abstract getMapProvider(): any;\n  public abstract getMaxBounds(): unknown;\n  public abstract getNorthBounds(): number;\n  public abstract getNorthEastBounds(): ArlasLngLat;\n  public abstract getSouthBounds(): number;\n  public abstract getSouthWestBounds(): ArlasLngLat;\n  public abstract getWestBounds(): number;\n  public abstract getZoom(): number;\n  public abstract initDrawControls(config: DrawControlsOption): void;\n  public abstract on(type: string, listener: (ev: any) => void): this;\n  public abstract onLoad(fn: () => void): void;\n  public abstract queryRenderedFeatures(pointOrBox?: unknown, options?: { layers?: string[]; filter?: any[]; }): any[];\n  public abstract resize(eventData?: unknown): this;\n  public abstract setCenter(center: unknown, unknown?: unknown): this;\n  public abstract setMaxBounds(unknown?: unknown): this;\n  public abstract setFilter(layer: string, filter?: boolean | any[], options?: unknown): this;\n  public abstract paddedBounds(npad: number, spad: number, epad: number,\n    wpad: number, map: any, SW: ArlasLngLat, NE: ArlasLngLat): ArlasLngLat[];\n\n\n  /** Gets bounds of the given geometry */\n  public geometryToBounds(geometry: any, paddingPercentage?: number): ArlasLngLatBounds {\n    const boundingBox: any = bbox(geometry);\n    let west = boundingBox[0];\n    let south = boundingBox[1];\n    let east = boundingBox[2];\n    let north = boundingBox[3];\n    if (paddingPercentage !== undefined) {\n      let width = east - west;\n      let height = north - south;\n      /** if there is one hit, then west=east ===> we consider a width of 0.05°*/\n      if (width === 0) {\n        width = 0.05;\n      }\n      /** if there is one hit, then north=south ===> we consider a height of 0.05°*/\n      if (height === 0) {\n        height = 0.05;\n      }\n      west = west - paddingPercentage * width;\n      south = Math.max(-90, south - paddingPercentage * height);\n      east = east + paddingPercentage * width;\n      north = Math.min(90, north + paddingPercentage * height);\n    }\n    const bounds = new ArlasLngLatBounds(\n      new ArlasLngLat(west, south),\n      new ArlasLngLat(east, north)\n    );\n    return bounds;\n  }\n\n}\n\n","/*\n * Licensed to Gisaïa under one or more contributor\n * license agreements. See the NOTICE.txt file distributed with\n * this work for additional information regarding copyright\n * ownership. Gisaïa licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nexport function latLngToWKT(features): string {\n  let wktType = 'POLYGON[###]';\n  if (features.length > 1) {\n    wktType = 'MULTIPOLYGON([###])';\n  }\n\n  let polygons = '';\n  features.forEach((feat, indexFeature) => {\n    if (feat) {\n      const currentFeat: Array<any> = feat.geometry.coordinates;\n      polygons += (indexFeature === 0 ? '' : ',') + '((';\n      currentFeat[0].forEach((coord, index) => {\n        polygons += (index === 0 ? '' : ',') + coord[0] + ' ' + coord[1];\n      });\n      polygons += '))';\n    }\n  });\n\n  let wkt = '';\n  if (polygons !== '') {\n    wkt = wktType.replace('[###]', polygons);\n  }\n  return wkt;\n}\n","/*\n * Licensed to Gisaïa under one or more contributor\n * license agreements. See the NOTICE.txt file distributed with\n * this work for additional information regarding copyright\n * ownership. Gisaïa licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { Injectable } from '@angular/core';\nimport { marker } from '@colsen1991/ngx-translate-extract-marker';\nimport area from '@turf/area';\nimport bbox from '@turf/bbox';\nimport { Feature, FeatureCollection, lineString } from '@turf/helpers';\nimport length from '@turf/length';\nimport { Subject } from 'rxjs';\nimport { AbstractDraw } from './AbstractDraw';\nimport { AoiDimensions, BboxDrawCommand, Corner } from './draw.models';\n\n@Injectable()\nexport class MapboxAoiDrawService {\n  private mapDraw: AbstractDraw;\n  private editionId: string;\n  private registeringMode: boolean;\n  private ids: Set<string> = new Set();\n\n  private editAoiSource = new Subject<AoiDimensions>();\n  public editAoi$ = this.editAoiSource.asObservable();\n\n  private drawBboxSource = new Subject<BboxDrawCommand>();\n  public drawBbox$ = this.drawBboxSource.asObservable();\n\n  /** Set to true when the user is drawing a bbox. */\n  public isDrawingBbox = false;\n  /** Set to true when the user is drawing a circle. */\n  public isDrawingCircle = false;\n  /** Set to true when the user is drawing a strip. */\n  public isDrawingStrip = false;\n  /** Set to true when the user is drawing a polygon. */\n  public isDrawingPolygon = false;\n  /** Set to true when the user is in simple draw mode. */\n  public isInSimpleDrawMode = false;\n  /** Set to true when the drawn geometry is selected. */\n  public isDrawSelected = false;\n  public isReady = false;\n\n  public constructor() { }\n\n  public isDrawing() {\n    return this.isDrawingBbox || this.isDrawingCircle || this.isDrawingPolygon || this.isDrawingStrip;\n  }\n\n  public drawBbox(fCorner: Corner, sCorner: Corner) {\n    const west = Math.min(fCorner.lng, sCorner.lng);\n    const east = Math.max(fCorner.lng, sCorner.lng);\n    const south = Math.min(fCorner.lat, sCorner.lat);\n    const north = Math.max(fCorner.lat, sCorner.lat);\n    this.drawBboxSource.next({\n      west,\n      east,\n      south,\n      north\n    });\n  }\n\n  public setDraw(mapboxDraw: AbstractDraw) {\n    this.mapDraw = mapboxDraw;\n    this.isReady = true;\n    this.onSelectionChange();\n    this.onRender();\n    this.onDelete();\n    this.onStop();\n  }\n\n  /**\n   * Add new features to the mapboxdraw object.\n   * @param fc Featurecollection to be added to mapboxdraw object.\n   * @param deleteOld if true, the mapboxdraw object is purged first, before adding the new given feature collection.\n   */\n  public addFeatures(fc: FeatureCollection<GeoJSON.Geometry>, deleteOld = false) {\n    if (deleteOld) {\n      this.mapDraw.deleteAll();\n    }\n    this.registeringMode = true;\n    this.mapDraw.add(fc);\n  }\n\n  /** Deletes all the features from Mapboxdraw object */\n  public deleteAll() {\n    this.registeringMode = true;\n    this.mapDraw.deleteAll();\n  }\n\n  /** Deletes all the features from Mapboxdraw object that have not been saved */\n  public deleteUnregisteredFeatures() {\n    this.mapDraw.delete(this.getUnregistredFeatures().map(f => f.id.toString()));\n  }\n\n  /** Returns the area of the given feature */\n  public calculateArea(feature: Feature): number {\n    if (this.isArea(feature)) {\n      return area(feature);\n    }\n    return 0;\n  }\n\n  /** Returns the width x height of the given feature's envelope */\n  public calculateEnvelopeDimension(feature: Feature): [number, number] {\n    if (this.isLine(feature)) {\n      const [minX, minY, maxX, maxY] = bbox(feature);\n      const verticalLine = lineString([[minX, minY], [minX, maxY]]);\n      const horizontalLine = lineString([[minX, minY], [maxX, minY]]);\n      return [length(horizontalLine), length(verticalLine)];\n    }\n    return [0, 0];\n  }\n\n  /** on selection of a drawn polygon, we get its corresponding id. */\n  private onSelectionChange() {\n    this.mapDraw.on('draw.selectionchange', (e) => {\n      const features = e.features;\n      if (this.hasFeatures(features)) {\n        this.editionId = features[0].id;\n      } else {\n        this.endDimensionsEmission();\n      }\n    });\n  }\n\n  private hasFeatures(features: any[]) {\n    return !!features && features.length > 0;\n  }\n\n  /** Triggered on deletion of feature(s).\n   * - Removes the deleted feature(s) from this service's register.\n   * - Stops emitting Aoi dimension info.\n   * */\n  private onDelete() {\n    this.mapDraw.on('draw.delete', (e) => {\n      e.features.forEach(f => this.unregister(f.id));\n      this.endDimensionsEmission();\n    });\n  }\n\n\n  private onStop() {\n    this.mapDraw.on('draw.onStop', (e) => {\n      this.register(this.editionId);\n      this.endDimensionsEmission();\n    });\n  }\n\n  /**\n   * This event is triggered :\n   * - after draw.update\n   * - after draw.delete\n   * - on adding/deleting features from mapboxdraw object.\n   */\n  private onRender() {\n    this.mapDraw.on('draw.render', (e) => {\n      if (this.mapDraw) {\n        this.registerAll();\n        const unregisteredFeatures = this.getUnregistredFeatures();\n        if (unregisteredFeatures && (unregisteredFeatures.length === 1 || unregisteredFeatures.length === 2)) {\n          const index = unregisteredFeatures.length - 1;\n          this.editionId = unregisteredFeatures[index].id + '';\n        }\n        if (this.editionId) {\n          const feature = this.getFeature(this.editionId, this.mapDraw);\n          this.emitDimensions(feature);\n        }\n      }\n    });\n  }\n\n  public emitStartBBox() {\n    this.editAoiSource.next({\n      area: 0,\n      areaMessage: marker('Start draging to draw a bbox.'),\n      envelope: {\n        width: 0,\n        height: 0\n      },\n      show: true\n    });\n  }\n\n  /** Emits dimension info of the given feature.*/\n  public emitDimensions(feature: Feature) {\n    const a = this.calculateArea(feature);\n    const wh = this.calculateEnvelopeDimension(feature);\n    this.editAoiSource.next({\n      area: a,\n      areaMessage: a > 0 ? '' : marker('Draw at least 2 points.'),\n      envelope: {\n        width: wh[0],\n        height: wh[1]\n      },\n      show: true\n    });\n  }\n\n  /** Stops emitting Aoi dimension info */\n  public endDimensionsEmission() {\n    this.editionId = undefined;\n    this.editAoiSource.next({\n      area: 0,\n      envelope: {\n        width: 0,\n        height: 0\n      },\n      show: false\n    });\n  }\n\n  /** Mapbox lacks a method to get the identifier of a new feature that is being drawn and not yet created\n   * this method detects this feature on 'draw.render' event.\n  */\n  private getUnregistredFeatures(): Feature[] {\n    return (this.mapDraw.getAllFeatures() as Feature[]).filter(f => !this.ids.has(f.id.toString()));\n  }\n\n  /** registers the identifiers of each drawn polygon in this service. */\n  private registerAll() {\n    if (this.registeringMode) {\n      this.ids.clear();\n      const fc = this.mapDraw.getAll();\n      if (!!fc && !!fc.features) {\n        this.ids = new Set(fc.features.map(f => f.id.toString()));\n      }\n      this.registeringMode = false;\n    }\n  }\n\n  /** Unregisters the given feature id in this service. */\n  private unregister(id: string) {\n    this.ids.delete(id);\n  }\n\n  /** Registers the given feature id in this service. */\n  private register(id: string) {\n    this.ids.add(id);\n  }\n\n  /** Gets the given feature from MapboxDraw object. */\n  private getFeature(featureId: string, mapDraw: AbstractDraw): Feature {\n    return mapDraw.get(featureId) as Feature;\n  }\n\n  /** Checks if the given feature has enough coordinates to represent an area (polygon) */\n  private isArea(feature) {\n    const isGeometryDefined = !!feature && !!feature.geometry;\n    const areCoordinatesDefined = isGeometryDefined && !!feature.geometry.coordinates;\n    if (areCoordinatesDefined) {\n      const coordinates = feature.geometry.coordinates;\n      const isArea = coordinates.length === 1 && coordinates[0].length > 3;\n      return isArea;\n    }\n    return false;\n  }\n\n  /** Checks if the given feature has enough coordinates to represent a line */\n  private isLine(feature) {\n    const isGeometryDefined = !!feature && !!feature.geometry;\n    const areCoordinatesDefined = isGeometryDefined && !!feature.geometry.coordinates;\n    if (areCoordinatesDefined) {\n      const coordinates = feature.geometry.coordinates;\n      const isLine = coordinates.length === 1 && coordinates[0].length > 1;\n      return isLine;\n    }\n    return false;\n  }\n\n  /**\n   * Chck if its a valid circle\n   * @param feature\n   */\n  public isValidCircle(feature): boolean {\n    const coordinates = feature.geometry.coordinates;\n    return this.isCircle(feature) && coordinates && coordinates[0] !== null && coordinates[0][0] !== null && feature.properties.center;\n  }\n\n  public isValidPolygon(feature): boolean {\n    const coordinates = feature.geometry.coordinates;\n    return this.isPolygon(feature) && coordinates && coordinates[0] !== null && coordinates[0][0] !== null;\n  }\n\n  public isPolygon(feature): boolean {\n    return feature.geometry.type === 'Polygon' && !this.isCircle(feature);\n  }\n\n  public isCircle(feature): boolean {\n    return feature.properties?.isCircle;\n  }\n}\n","/*\n * Licensed to Gisaïa under one or more contributor\n * license agreements. See the NOTICE.txt file distributed with\n * this work for additional information regarding copyright\n * ownership. Gisaïa licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport MapboxDraw from '@mapbox/mapbox-gl-draw';\nimport * as jsts from 'jsts/dist/jsts.min';\n\nexport const limitVertexDirectSelectMode = MapboxDraw.modes.direct_select;\nconst reader = new jsts.io.GeoJSONReader();\n\nlimitVertexDirectSelectMode.fireInvalidGeom = function (feature) {\n  this.map.fire('draw.invalidGeometry', {\n    action: 'error',\n    features: [feature]\n  });\n};\n\nlimitVertexDirectSelectMode.fireInitialFeature = function (feature) {\n  this.map.fire('draw.edit.saveInitialFeature', {\n    feature: feature\n  });\n};\n\nlimitVertexDirectSelectMode.toDisplayFeatures = function (state, geojson, push) {\n  if (state.featureId === geojson.properties.id) {\n    geojson.properties.active = MapboxDraw.constants.activeStates.ACTIVE;\n    push(geojson);\n    MapboxDraw.lib.createSupplementaryPoints(geojson, {\n      map: this.map,\n      midpoints: geojson.geometry.coordinates[0].length >= state.maxVertexByPolygon + 1 ? false : true,\n      selectedPaths: state.selectedCoordPaths\n    }).forEach(push);\n  } else {\n    geojson.properties.active = MapboxDraw.constants.activeStates.INACTIVE;\n    push(geojson);\n  }\n  this.fireActionable(state);\n};\n\nlimitVertexDirectSelectMode.onTouchEnd = limitVertexDirectSelectMode.onMouseUp = function (state) {\n  if (state.dragMoving) {\n    const featureCoords = [...state.feature.coordinates[0]];\n    if (\n      featureCoords[0][0] !== featureCoords[featureCoords.length - 1][0] ||\n      featureCoords[0][1] !== featureCoords[featureCoords.length - 1][1]\n    ) {\n      featureCoords.push(featureCoords[0]);\n    }\n    const currentFeature = {\n      'type': 'Feature',\n      'geometry': {\n        'type': 'Polygon',\n        'coordinates': [featureCoords]\n      }\n    };\n    const g = reader.read(currentFeature);\n    if (!g.geometry.isValid()) {\n      this.fireInvalidGeom(currentFeature);\n    } else {\n      this.fireUpdate();\n    }\n  }\n  this.stopDragging(state);\n};\n\n\nlimitVertexDirectSelectMode.onSetup = function (opts) {\n  const featureId = opts.featureId;\n  let maxVertexByPolygon = opts.maxVertexByPolygon;\n  const feature = this.getFeature(featureId);\n  this.fireInitialFeature(feature);\n  if (!feature) {\n    throw new Error('You must provide a featureId to enter direct_select mode');\n  }\n\n  if (!maxVertexByPolygon) {\n    maxVertexByPolygon = 100;\n  }\n\n  if (feature.type === MapboxDraw.constants.geojsonTypes.POINT) {\n    throw new TypeError('direct_select mode doesn\\'t handle point features');\n  }\n\n  const state = {\n    featureId,\n    feature,\n    dragMoveLocation: opts.startPos || null,\n    dragMoving: false,\n    canDragMove: false,\n    selectedCoordPaths: opts.coordPath ? [opts.coordPath] : [],\n    maxVertexByPolygon\n  };\n\n  this.setSelectedCoordinates(this.pathsToCoordinates(featureId, state.selectedCoordPaths));\n  this.setSelected(featureId);\n  MapboxDraw.lib.doubleClickZoom.disable(this);\n\n  this.setActionableState({\n    trash: true\n  });\n\n  return state;\n};\n\nexport default limitVertexDirectSelectMode;\n","/*\n * Licensed to Gisaïa under one or more contributor\n * license agreements. See the NOTICE.txt file distributed with\n * this work for additional information regarding copyright\n * ownership. Gisaïa licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport MapboxDraw from '@mapbox/mapbox-gl-draw';\nimport * as jsts from 'jsts/dist/jsts.min';\n\nexport const validGeomDrawPolygonMode = MapboxDraw.modes.draw_polygon;\nconst reader = new jsts.io.GeoJSONReader();\n\nvalidGeomDrawPolygonMode.fireInvalidGeom = function (feature) {\n  this.map.fire('draw.invalidGeometry', {\n    action: 'error',\n    features: [feature]\n  });\n};\n\nvalidGeomDrawPolygonMode.fireOnClick = function () {\n  this.map.fire('draw.onClick', 'point drawn');\n};\n\nvalidGeomDrawPolygonMode.fireOnStop = function () {\n  this.map.fire('draw.onStop', 'draw end');\n};\n\nvalidGeomDrawPolygonMode.clickOnVertex = function (state) {\n  return this.changeMode(MapboxDraw.constants.modes.STATIC, {});\n};\n\nvalidGeomDrawPolygonMode.onTap = validGeomDrawPolygonMode.onClick = function (state, e) {\n  if (MapboxDraw.lib.CommonSelectors.isVertex(e)) {\n    return this.clickOnVertex(state, e);\n  } else {\n    this.fireOnClick();\n    return this.clickAnywhere(state, e);\n  }\n};\n\nvalidGeomDrawPolygonMode.onStop = function (state) {\n  this.fireOnStop();\n  this.updateUIClasses({ mouse: MapboxDraw.constants.cursors.NONE });\n  MapboxDraw.lib.doubleClickZoom.enable(this);\n  this.activateUIButton();\n\n  // check to see if we've deleted this feature\n  if (this.getFeature(state.polygon.id) === undefined) {\n    return;\n  }\n\n  // remove last added coordinate\n  state.polygon.removeCoordinate(`0.${state.currentVertexPosition}`);\n  if (state.polygon.isValid()) {\n\n    const featureCoords = [...state.polygon.coordinates[0]];\n    if (\n      featureCoords[0][0] !== featureCoords[featureCoords.length - 1][0] ||\n      featureCoords[0][1] !== featureCoords[featureCoords.length - 1][1]\n    ) {\n      featureCoords.push(featureCoords[0]);\n    }\n    const currentFeature = {\n      'type': 'Feature',\n      'geometry': {\n        'type': 'Polygon',\n        'coordinates': [featureCoords]\n      }\n    };\n    const g = reader.read(currentFeature);\n    if (!g.geometry.isValid()) {\n      this.fireInvalidGeom(state.polygon);\n      this.deleteFeature([state.polygon.id], { silent: true });\n    } else {\n      this.map.fire(MapboxDraw.constants.events.CREATE, {\n        features: [state.polygon.toGeoJSON()]\n      });\n    }\n  } else {\n    this.deleteFeature([state.polygon.id], { silent: true });\n    this.changeMode(MapboxDraw.constants.modes.STATIC, {}, { silent: true });\n  }\n};\n\nexport default validGeomDrawPolygonMode;\n","/*\n * Licensed to Gisaïa under one or more contributor\n * license agreements. See the NOTICE.txt file distributed with\n * this work for additional information regarding copyright\n * ownership. Gisaïa licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport MapboxDraw from '@mapbox/mapbox-gl-draw';\nimport circle from '@turf/circle';\n\n\nexport const circleMode = { ...MapboxDraw.modes.draw_polygon };\nconst DEFAULT_RADIUS_IN_KM = 2;\n\ncircleMode.onSetup = function (opts) {\n    const polygon = this.newFeature({\n        type: MapboxDraw.constants.geojsonTypes.FEATURE,\n        properties: {\n            isFixedRadius: opts.isFixedRadius !== undefined ? opts.isFixedRadius : false,\n            isCircle: true,\n            center: opts.center !== undefined ? opts.center : []\n        },\n        geometry: {\n            type: MapboxDraw.constants.geojsonTypes.POLYGON,\n            coordinates: [[]]\n        }\n    });\n\n    this.addFeature(polygon);\n\n    this.clearSelectedFeatures();\n    MapboxDraw.lib.doubleClickZoom.disable(this);\n    this.updateUIClasses({ mouse: MapboxDraw.constants.cursors.ADD });\n    this.activateUIButton(MapboxDraw.constants.types.POLYGON);\n    this.setActionableState({\n        trash: true\n    });\n\n    return {\n        initialRadiusInKm: opts.initialRadiusInKm || DEFAULT_RADIUS_IN_KM,\n        steps: opts.steps || 64,\n        units: opts.units || 'kilometers',\n        polygon,\n        currentVertexPosition: 0\n    };\n};\n\n\ncircleMode.clickAnywhere = function (state, e) {\n    if (state.currentVertexPosition === 0) {\n        state.currentVertexPosition++;\n        const center = [e.lngLat.lng, e.lngLat.lat];\n        const options =  {steps: state.steps, units: state.units};\n        const circleFeature = circle(center, state.initialRadiusInKm, options);\n        state.polygon.incomingCoords(circleFeature.geometry.coordinates);\n        state.polygon.properties.center = center;\n        state.polygon.properties.radiusInKm = state.initialRadiusInKm;\n    }\n    return this.changeMode(MapboxDraw.constants.modes.SIMPLE_SELECT, { featureIds: [state.polygon.id] });\n};\n\nexport default circleMode;\n","/*\n * Licensed to Gisaïa under one or more contributor\n * license agreements. See the NOTICE.txt file distributed with\n * this work for additional information regarding copyright\n * ownership. Gisaïa licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nexport function createDrawVertex(parentId, coordinates, path, selected) {\n  return {\n    type: 'Feature',\n    properties: {\n      meta: 'vertex',\n      parent: parentId,\n      coord_path: path,\n      active: selected ? 'true' : 'false',\n    },\n    geometry: {\n      type: 'Point',\n      coordinates,\n    },\n  };\n}\nexport function displayFeatures(state, geojson, display) {\n  const isActiveLine = geojson.properties.id === state.line.id;\n  geojson.properties.active = isActiveLine ? 'true' : 'false';\n  if (!isActiveLine) {\n    if (!geojson.geometry.coordinates[0][0]) {\n      return null;\n    }\n    return display(geojson);\n  }\n\n  // Only render the line if it has at least one real coordinate\n  if (geojson.geometry.coordinates.length < 2) {\n    return null;\n  }\n  geojson.properties.meta = 'feature';\n\n  // displays center vertex as a point feature\n  display(\n    createDrawVertex(\n      state.line.id,\n      geojson.geometry.coordinates[\n      state.direction === 'forward'\n        ? geojson.geometry.coordinates.length - 2\n        : 1\n      ],\n      `${state.direction === 'forward'\n        ? geojson.geometry.coordinates.length - 2\n        : 1\n      }`,\n      false\n    )\n  );\n\n  // displays the line as it is drawn\n  display(geojson);\n\n}\n\n\nexport function updateCoordinates(state, e) {\n  if (state.direction === 'forward') {\n    state.currentVertexPosition += 1; // eslint-disable-line\n    state.line.updateCoordinate(\n      state.currentVertexPosition,\n      e.lngLat.lng,\n      e.lngLat.lat\n    );\n  } else {\n    state.line.addCoordinate(0, e.lngLat.lng, e.lngLat.lat);\n  }\n}\n","/*\n * Licensed to Gisaïa under one or more contributor\n * license agreements. See the NOTICE.txt file distributed with\n * this work for additional information regarding copyright\n * ownership. Gisaïa licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport MapboxDraw from '@mapbox/mapbox-gl-draw';\nimport circle from '@turf/circle';\nimport length from '@turf/length';\nimport numeral from 'numeral';\nimport { displayFeatures, updateCoordinates } from '../utils';\n\nexport const radiusCircleMode = { ...MapboxDraw.modes.draw_line_string };\n\n\nradiusCircleMode.fireOnStop = function () {\n    this.map.fire('draw.onStop', 'draw end');\n};\n\n\nfunction getDisplayMeasurements(feature) {\n    // should log both metric and standard display strings for the current drawn feature\n\n    // metric calculation\n    const drawnLength = length(feature) * 1000; // meters\n\n    let metricUnits = 'm';\n    let metricFormat = '0,0';\n    let metricMeasurement;\n\n    let standardUnits = 'feet';\n    let standardFormat = '0,0';\n    let standardMeasurement;\n\n    metricMeasurement = drawnLength;\n    if (drawnLength >= 1000) {\n        // if over 1000 meters, upgrade metric\n        metricMeasurement = drawnLength / 1000;\n        metricUnits = 'km';\n        metricFormat = '0.00';\n    }\n\n    standardMeasurement = drawnLength * 3.28084;\n    if (standardMeasurement >= 5280) {\n        // if over 5280 feet, upgrade standard\n        standardMeasurement /= 5280;\n        standardUnits = 'mi';\n        standardFormat = '0.00';\n    }\n\n    const displayMeasurements = {\n        metric: `${numeral(metricMeasurement).format(metricFormat)} ${metricUnits}`,\n        standard: `${numeral(standardMeasurement).format(\n            standardFormat\n        )} ${standardUnits}`,\n    };\n\n    return displayMeasurements;\n}\n\nconst doubleClickZoom = {\n    enable: (ctx) => {\n        setTimeout(() => {\n            // First check we've got a map and some context.\n            if (\n                !ctx.map?.doubleClickZoom ||\n                !ctx._ctx?.store?.getInitialConfigValue\n            ) {\n                return;\n            }\n            // Now check initial state wasn't false (we leave it disabled if so)\n            if (!ctx._ctx.store.getInitialConfigValue('doubleClickZoom')) {\n                return;\n            }\n            ctx.map.doubleClickZoom.enable();\n        }, 0);\n    },\n};\nradiusCircleMode.onSetup = function (opts) {\n    const props = MapboxDraw.modes.draw_line_string.onSetup.call(this, opts);\n    const polygon = this.newFeature({\n        type: MapboxDraw.constants.geojsonTypes.FEATURE,\n        properties: {\n            meta: 'radius',\n            isFixedRadius: opts.isFixedRadius !== undefined ? opts.isFixedRadius : false,\n            isCircle: true,\n            center: opts.center !== undefined ? opts.center : []\n        },\n        geometry: {\n            type: MapboxDraw.constants.geojsonTypes.POLYGON,\n            coordinates: [[]],\n        },\n    });\n    this.addFeature(polygon);\n\n    return {\n        ...props,\n        circle:polygon,\n        steps: opts.steps || 64,\n        units: opts.units || 'kilometers'\n    };\n};\n\nradiusCircleMode.clickAnywhere = function (state, e) {\n    // this ends the drawing after the user creates a second point, triggering this.onStop\n    if (state.currentVertexPosition === 1) {\n        state.line.addCoordinate(0, e.lngLat.lng, e.lngLat.lat);\n        return this.changeMode('simple_select', { featureIds: [state.line.id] });\n    }\n    this.updateUIClasses({ mouse: MapboxDraw.constants.cursors.ADD });\n    state.line.updateCoordinate(\n        state.currentVertexPosition,\n        e.lngLat.lng,\n        e.lngLat.lat\n    );\n    updateCoordinates(state, e);\n    return null;\n};\n\nradiusCircleMode.onMouseMove = function (state, e) {\n    MapboxDraw.modes.draw_line_string.onMouseMove.call(this, state, e);\n    const geojson = state.line.toGeoJSON();\n    const center = geojson.geometry.coordinates[0];\n    const radiusInKm = length(geojson, { units: 'kilometers' });\n    const options =  {steps: state.steps, units: state.units};\n    const circleFeature = circle(center, radiusInKm, options);\n    circleFeature.properties.parent = state.line.id;\n    (circleFeature.properties as any).meta = 'radius';\n    state.circle.setCoordinates(circleFeature.geometry.coordinates);\n};\n\n// creates the final geojson point feature with a radius property\n// triggers draw.create\nradiusCircleMode.onStop = function (state) {\n    doubleClickZoom.enable(this);\n\n    this.activateUIButton();\n\n    // check to see if we've deleted this feature\n    if (this.getFeature(state.line.id) === undefined) {\n        return;\n    }\n\n    // remove last added coordinate\n    state.line.removeCoordinate('0');\n    if (state.line.isValid()) {\n        this.deleteFeature([state.line.id], { silent: true });\n\n        this.map.fire('draw.create', {\n            features: [state.circle.toGeoJSON()],\n        });\n    } else {\n        this.deleteFeature([state.line.id], { silent: true });\n        this.changeMode('simple_select', {}, { silent: true });\n    }\n    this.fireOnStop();\n};\n\nradiusCircleMode.toDisplayFeatures = function (state, geojson, display) {\n    displayFeatures(state, geojson, display);\n\n    if (geojson.geometry.coordinates.length >= 2 && geojson.geometry.coordinates[1]) {\n        const displayMeasurements = getDisplayMeasurements(geojson);\n\n        // create custom feature for the current pointer position\n        const currentVertex = {\n            type: 'Feature',\n            properties: {\n                meta: 'currentPosition',\n                radiusMetric: displayMeasurements.metric,\n                radiusStandard: displayMeasurements.standard,\n                parent: state.line.id,\n            },\n            geometry: {\n                type: 'Point',\n                coordinates: geojson.geometry.coordinates[1],\n            },\n        };\n        display(currentVertex);\n    }\n\n    return null;\n};\n\nexport default radiusCircleMode;\n","/*\n * Licensed to Gisaïa under one or more contributor\n * license agreements. See the NOTICE.txt file distributed with\n * this work for additional information regarding copyright\n * ownership. Gisaïa licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport MapboxDraw from '@mapbox/mapbox-gl-draw';\n\nexport function createSupplementaryPointsForCircle(geojson) {\n    const { properties, geometry } = geojson;\n\n    if (!properties.user_isCircle) {\n        return null;\n    }\n\n    const supplementaryPoints = [];\n    const vertices = geometry.coordinates[0].slice(0, -1);\n    for (let index = 0; index < vertices.length; index += Math.round((vertices.length / 4))) {\n        supplementaryPoints.push(MapboxDraw.lib.createVertex(properties.id, vertices[index], `0.${index}`, false));\n    }\n    return supplementaryPoints;\n}\n\nexport const dragPan = {\n    enable(ctx) {\n        setTimeout(() => {\n            // First check we've got a map and some context.\n            if (!ctx.map || !ctx.map.dragPan || !ctx._ctx || !ctx._ctx.store || !ctx._ctx.store.getInitialConfigValue) {\n                return;\n            }\n            // Now check initial state wasn't false (we leave it disabled if so)\n            if (!ctx._ctx.store.getInitialConfigValue('dragPan')) {\n                return;\n            }\n            ctx.map.dragPan.enable();\n        }, 0);\n    },\n\n    disable(ctx) {\n        setTimeout(() => {\n            if (!ctx.map || !ctx.map.doubleClickZoom) {\n                return;\n            }\n            // Always disable here, as it's necessary in some cases.\n            ctx.map.dragPan.disable();\n        }, 0);\n    }\n};\n","/*\n * Licensed to Gisaïa under one or more contributor\n * license agreements. See the NOTICE.txt file distributed with\n * this work for additional information regarding copyright\n * ownership. Gisaïa licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport MapboxDraw from '@mapbox/mapbox-gl-draw';\nimport circle from '@turf/circle';\nimport { point } from '@turf/helpers';\nimport distance from '@turf/distance';\nimport { createSupplementaryPointsForCircle } from './circles/utils';\n\n\nexport const directModeOverride = MapboxDraw.modes.direct_select;\n\ndirectModeOverride.dragFeature = function (state, e, delta) {\n    MapboxDraw.lib.moveFeatures(this.getSelected(), delta);\n    this.getSelected()\n        .filter(feature => feature.properties.isCircle)\n        .map(circle => circle.properties.center)\n        .forEach(center => {\n            center[0] += delta.lng;\n            center[1] += delta.lat;\n        });\n    state.dragMoveLocation = e.lngLat;\n};\n\ndirectModeOverride.dragVertex = function (state, e, delta) {\n    if (state.feature.properties.isCircle && state.feature.properties.isFixedRadius) {\n        MapboxDraw.lib.moveFeatures(this.getSelected(), delta);\n        this.getSelected()\n            .filter(feature => feature.properties.isCircle)\n            .map(circle => circle.properties.center)\n            .forEach(center => {\n                center[0] += delta.lng;\n                center[1] += delta.lat;\n            });\n        state.dragMoveLocation = e.lngLat;\n    } else {\n        if (state.feature.properties.isCircle) {\n            const center = state.feature.properties.center;\n            const movedVertex = [e.lngLat.lng, e.lngLat.lat];\n            const radius = distance(point(center), point(movedVertex), { units: 'kilometers' });\n            const circleFeature = circle(center, radius);\n            state.feature.incomingCoords(circleFeature.geometry.coordinates);\n            state.feature.properties.radiusInKm = radius;\n        } else {\n            const selectedCoords = state.selectedCoordPaths.map(coord_path => state.feature.getCoordinate(coord_path));\n            const selectedCoordPoints = selectedCoords.map(coords => ({\n                type: MapboxDraw.constants.geojsonTypes.FEATURE,\n                properties: {},\n                geometry: {\n                    type: MapboxDraw.constants.geojsonTypes.POINT,\n                    coordinates: coords\n                }\n            }));\n\n            const constrainedDelta = MapboxDraw.lib.constrainFeatureMovement(selectedCoordPoints, delta);\n            for (let i = 0; i < selectedCoords.length; i++) {\n                const coord = selectedCoords[i];\n                state.feature.updateCoordinate(state.selectedCoordPaths[i], coord[0] + constrainedDelta.lng, coord[1] + constrainedDelta.lat);\n            }\n        }\n    }\n\n};\n\ndirectModeOverride.toDisplayFeatures = function (state, geojson, push) {\n    if (state.featureId === geojson.properties.id) {\n        geojson.properties.active = MapboxDraw.constants.activeStates.ACTIVE;\n        push(geojson);\n        const supplementaryPoints = geojson.properties.user_isCircle ? createSupplementaryPointsForCircle(geojson)\n            : MapboxDraw.lib.createSupplementaryPoints(geojson, {\n                map: this.map,\n                midpoints: true,\n                selectedPaths: state.selectedCoordPaths\n            });\n        supplementaryPoints.forEach(push);\n    } else {\n        geojson.properties.active = MapboxDraw.constants.activeStates.INACTIVE;\n        push(geojson);\n    }\n    this.fireActionable(state);\n\n};\n\nexport default directModeOverride;\n","/*\n * Licensed to Gisaïa under one or more contributor\n * license agreements. See the NOTICE.txt file distributed with\n * this work for additional information regarding copyright\n * ownership. Gisaïa licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport MapboxDraw from '@mapbox/mapbox-gl-draw';\n\n// Inspired by https://github.com/thegisdev/mapbox-gl-draw-rectangle-mode/tree/master\nexport const rectangleMode: any = { };\n\nrectangleMode.onSetup = function() {\n    const rectangle = this.newFeature({\n        type: MapboxDraw.constants.geojsonTypes.FEATURE,\n        properties: {\n            source: 'bbox'\n        },\n        geometry: {\n          type: MapboxDraw.constants.geojsonTypes.POLYGON,\n          coordinates: [[]]\n        }\n    });\n    this.addFeature(rectangle);\n\n    this.clearSelectedFeatures();\n    MapboxDraw.lib.doubleClickZoom.disable(this);\n    this.updateUIClasses({ mouse: MapboxDraw.constants.cursors.ADD });\n    this.activateUIButton(MapboxDraw.constants.types.POLYGON);\n    this.setActionableState({\n        trash: true\n    });\n\n    return {\n        rectangle,\n        currentVertexPosition: 0,\n        start: []\n    };\n};\n\nrectangleMode.onClick = function(state, e) {\n    if (state.currentVertexPosition === 1\n        && state.start[0] !== e.lngLat.lng\n        && state.start[1] !== e.lngLat.lat\n    ) {\n        this.updateUIClasses({ mouse: MapboxDraw.constants.cursors.NONE });\n        return this.changeMode('simple_select', { featuresId: state.rectangle.id });\n    }\n    state.start = [e.lngLat.lng, e.lngLat.lat];\n    state.currentVertexPosition++;\n};\n\nrectangleMode.onMouseMove = function(state, e) {\n    if (state.start?.length > 0) {\n        const start = state.start;\n\n        // The bbox needs to be oriented in a certain way to match the parsing in the contributors\n        const west = Math.min(start[0], e.lngLat.lng);\n        const north = Math.max(start[1], e.lngLat.lat);\n        const east = Math.max(start[0], e.lngLat.lng);\n        const south = Math.min(start[1], e.lngLat.lat);\n\n        state.rectangle.updateCoordinate('0.0', east, south);\n        state.rectangle.updateCoordinate('0.1', east, north);\n        state.rectangle.updateCoordinate('0.2', west, north);\n        state.rectangle.updateCoordinate('0.3', west, south);\n    }\n};\n\nrectangleMode.toDisplayFeatures = function(state, geojson, display) {\n    const isActivePolygon = geojson.properties.id === state.rectangle.id;\n    geojson.properties.active = isActivePolygon ? 'true' : 'false';\n    if (!isActivePolygon) {\n        return display(geojson);\n    }\n\n    // Only render the rectangular polygon if it has the starting point\n    if (state.start.length === 0) {\n        return;\n    }\n    return display(geojson);\n};\n\nrectangleMode.fireOnStop = function () {\n    this.map.fire('draw.onStop', 'draw end');\n};\n\nrectangleMode.onStop = function(state) {\n    MapboxDraw.lib.doubleClickZoom.enable(this);\n    this.activateUIButton();\n\n    // check to see if we've deleted this feature\n    if (this.getFeature(state.rectangle.id) === undefined) {\n        return;\n    }\n\n    // remove last added coordinate\n    state.rectangle.removeCoordinate('0.4');\n    if (state.rectangle.isValid()) {\n        this.map.fire('draw.create', {\n            features: [state.rectangle.toGeoJSON()],\n        });\n    } else {\n        this.deleteFeature([state.rectangle.id], { silent: true });\n        this.changeMode('simple_select', {featureIds: [state.rectangle.id]}, { silent: true });\n    }\n\n    this.fireOnStop();\n};\n\nrectangleMode.onTrash = function(state) {\n    this.deleteFeature([state.rectangle.id], { silent: true });\n    this.changeMode('simple_select');\n};\n","/*\n * Licensed to Gisaïa under one or more contributor\n * license agreements. See the NOTICE.txt file distributed with\n * this work for additional information regarding copyright\n * ownership. Gisaïa licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport MapboxDraw from '@mapbox/mapbox-gl-draw';\nimport { createSupplementaryPointsForCircle } from './circles/utils';\n\n\nexport const simpleSelectModeOverride = MapboxDraw.modes.simple_select;\n\nsimpleSelectModeOverride.dragMove = function (state, e) {\n    // Dragging when drag move is enabled\n    state.dragMoving = true;\n    e.originalEvent.stopPropagation();\n\n    const delta = {\n        lng: e.lngLat.lng - state.dragMoveLocation.lng,\n        lat: e.lngLat.lat - state.dragMoveLocation.lat\n    };\n\n    MapboxDraw.lib.moveFeatures(this.getSelected(), delta);\n\n    this.getSelected()\n        .filter(feature => feature.properties.isCircle)\n        .map(circle => circle.properties.center)\n        .forEach(center => {\n            center[0] += delta.lng;\n            center[1] += delta.lat;\n        });\n\n    state.dragMoveLocation = e.lngLat;\n};\n\nsimpleSelectModeOverride.toDisplayFeatures = function (state, geojson, display) {\n    geojson.properties.active = (this.isSelected(geojson.properties.id)) ?\n        MapboxDraw.constants.activeStates.ACTIVE : MapboxDraw.constants.activeStates.INACTIVE;\n    display(geojson);\n    this.fireActionable();\n    if (geojson.properties.active !== MapboxDraw.constants.activeStates.ACTIVE ||\n        geojson.geometry.type === MapboxDraw.constants.geojsonTypes.POINT) {\n        return;\n    }\n    const supplementaryPoints = geojson.properties.user_isCircle ?\n        createSupplementaryPointsForCircle(geojson) : MapboxDraw.lib.createSupplementaryPoints(geojson);\n    supplementaryPoints.forEach(display);\n};\n\n\nexport default simpleSelectModeOverride;\n","/*\n * Licensed to Gisaïa under one or more contributor\n * license agreements. See the NOTICE.txt file distributed with\n * this work for additional information regarding copyright\n * ownership. Gisaïa licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport MapboxDraw from '@mapbox/mapbox-gl-draw';\nimport distance from '@turf/distance';\nimport { bearingToAzimuth, point, polygon } from '@turf/helpers';\nimport length from '@turf/length';\nimport midpoint from '@turf/midpoint';\nimport rhumbBearing from '@turf/rhumb-bearing';\nimport rhumbDestination from '@turf/rhumb-destination';\nimport transformRotate from '@turf/transform-rotate';\nimport transformTranslate from '@turf/transform-translate';\nimport { displayFeatures, updateCoordinates } from '../utils';\n\nexport const stripMode = { ...MapboxDraw.modes.draw_line_string };\n\nexport function rotateStrip(start, end, state, currentMaxBearing = 0, options: any = {}) {\n    const properties = options.properties ? options.properties : {};\n    const startPoint = point(start);\n    const endPoint = point(end);\n    const bearing = rhumbBearing(startPoint, endPoint);\n    const rotatedPoly = transformRotate(state.strip, bearing - currentMaxBearing, { pivot: start });\n    state.currentMaxBearing = bearing;\n    return polygon(rotatedPoly.coordinates, properties);\n}\n\nexport function buildStrip(start, end, halfSwath, options: any = {}) {\n    const properties = options.properties ? options.properties : {};\n    // main\n    const coordinates = [];\n    const startPoint = point(start);\n    const endPoint = point(end);\n    // build polygone\n    const bearing = rhumbBearing(startPoint, endPoint);\n    const corner1 = rhumbDestination(startPoint, halfSwath, bearing - 90);\n    const corner2 = rhumbDestination(startPoint, halfSwath, bearing + 90);\n    const corner3 = rhumbDestination(endPoint, halfSwath, bearing + 90);\n    const corner4 = rhumbDestination(endPoint, halfSwath, bearing - 90);\n    coordinates.push(corner1.geometry.coordinates);\n    coordinates.push(corner2.geometry.coordinates);\n    coordinates.push(corner3.geometry.coordinates);\n    coordinates.push(corner4.geometry.coordinates);\n    coordinates.push(coordinates[0]);\n    properties.start = start;\n    properties.end = end;\n    return polygon([coordinates], properties);\n}\n\nexport function computeStripProperties(coordinates) {\n    const properties = new Map();\n\n    // Compute bearing\n    const bearingAngle = rhumbBearing(point(coordinates[0]), point(coordinates[3]));\n    properties['bearingAngle'] = bearingToAzimuth(bearingAngle);\n\n    // Compute origin\n    properties['origin'] = midpoint(point(coordinates[0]), point(coordinates[1])).geometry.coordinates;\n\n    // Compute length\n    properties['length'] = distance(point(coordinates[1]), point(coordinates[2]), { units: 'kilometers' });\n\n    return properties;\n}\n\nconst doubleClickZoom = {\n    enable: (ctx) => {\n        setTimeout(() => {\n            // First check we've got a map and some context.\n            if (\n                !ctx.map?.doubleClickZoom ||\n                !ctx._ctx?.store?.getInitialConfigValue\n            ) {\n                return;\n            }\n            // Now check initial state wasn't false (we leave it disabled if so)\n            if (!ctx._ctx.store.getInitialConfigValue('doubleClickZoom')) {\n                return;\n            }\n            ctx.map.doubleClickZoom.enable();\n        }, 0);\n    },\n};\nstripMode.onSetup = function (opts) {\n    const halfSwath = opts.halfSwath;\n    const maxLength = opts.maxLength;\n\n    if (!halfSwath) {\n        throw new Error('You must provide a valid halfSwath to enter strip_direct mode');\n    }\n    if (!maxLength) {\n        throw new Error('You must provide a valid maxLength to enter strip_direct mode');\n    }\n    const props = MapboxDraw.modes.draw_line_string.onSetup.call(this, opts);\n    const polygon = this.newFeature({\n        type: MapboxDraw.constants.geojsonTypes.FEATURE,\n        properties: {\n            meta: 'strip',\n            isCircle: false,\n            isStrip: true,\n            halfSwath: opts.halfSwath,\n            maxLength: opts.maxLength,\n            bearingAngle: 0\n\n        },\n        geometry: {\n            type: MapboxDraw.constants.geojsonTypes.POLYGON,\n            coordinates: [[]],\n        },\n    });\n    this.addFeature(polygon);\n\n    return {\n        ...props,\n        strip: polygon,\n        halfSwath,\n        maxLength,\n        meta: 'strip'\n    };\n};\n\nstripMode.fireOnStop = function () {\n    this.map.fire('draw.onStop', 'draw end');\n};\n\nstripMode.clickAnywhere = function (state, e) {\n    // this ends the drawing after the user creates a second point, triggering this.onStop\n    if (state.currentVertexPosition === 1) {\n        state.line.addCoordinate(0, e.lngLat.lng, e.lngLat.lat);\n        return this.changeMode('simple_select', {\n            featureIds: [state.line.id]\n        });\n    }\n    this.updateUIClasses({ mouse: MapboxDraw.constants.cursors.ADD });\n    state.line.updateCoordinate(\n        state.currentVertexPosition,\n        e.lngLat.lng,\n        e.lngLat.lat\n    );\n    updateCoordinates(state, e);\n    return null;\n};\n\nstripMode.onMouseMove = function (state, e) {\n    if (state.currentVertexPosition === 1) {\n        MapboxDraw.modes.draw_line_string.onMouseMove.call(this, state, e);\n        const geojson = state.line.toGeoJSON();\n        const stripLength = length(geojson, { units: 'kilometers' });\n        const start = geojson.geometry.coordinates[0];\n        const end = [e.lngLat.lng, e.lngLat.lat];\n        const startPoint = point(start);\n        const endPoint = point(end);\n        const bearing = rhumbBearing(startPoint, endPoint);\n        if (stripLength > state.maxLength && state.isStripDrew === undefined) {\n            const translateDistance = -(stripLength - state.maxLength);\n            const translatedPoint = transformTranslate(endPoint, translateDistance, bearing);\n            const stripFeature = buildStrip(start, translatedPoint.geometry.coordinates, state.halfSwath);\n            stripFeature.properties.parent = state.line.id;\n            stripFeature.properties.meta = 'strip';\n            state.strip.setCoordinates(stripFeature.geometry.coordinates);\n            state.currentMaxBearing = bearing;\n            state.isStripDrew = true;\n            Object.assign(state.strip.properties, computeStripProperties(stripFeature.geometry.coordinates[0]));\n        } else if (stripLength <= state.maxLength || state.isStripDrew === undefined) {\n            const stripFeature = buildStrip(start, end, state.halfSwath);\n            stripFeature.properties.parent = state.line.id;\n            stripFeature.properties.meta = 'strip';\n            state.strip.setCoordinates(stripFeature.geometry.coordinates);\n            state.currentMaxBearing = bearing;\n            state.isStripDrew = true;\n            Object.assign(state.strip.properties, computeStripProperties(stripFeature.geometry.coordinates[0]));\n        } else if (state.isStripDrew && stripLength > state.maxLength) {\n            const stripFeature = rotateStrip(start, end, state, state.currentMaxBearing);\n            stripFeature.properties.parent = state.line.id;\n            stripFeature.properties.meta = 'strip';\n            state.strip.setCoordinates(stripFeature.geometry.coordinates);\n            Object.assign(state.strip.properties, computeStripProperties(stripFeature.geometry.coordinates[0]));\n        }\n    }\n};\n\n// creates the final geojson point feature with a radius property\n// triggers draw.create\nstripMode.onStop = function (state) {\n    doubleClickZoom.enable(this);\n\n    this.activateUIButton();\n\n    // check to see if we've deleted this feature\n    if (this.getFeature(state.line.id) === undefined) {\n        return;\n    }\n\n    // remove last added coordinate\n    state.line.removeCoordinate('0');\n    if (state.line.isValid()) {\n        this.deleteFeature([state.line.id], { silent: true });\n\n        this.map.fire('draw.create', {\n            features: [state.strip.toGeoJSON()],\n        });\n    } else {\n        this.deleteFeature([state.line.id], { silent: true });\n        this.changeMode('simple_select', {}, { silent: true });\n    }\n    this.fireOnStop();\n};\n\nstripMode.toDisplayFeatures = function (state, geojson, display) {\n    displayFeatures(state, geojson, display);\n\n    if (geojson.geometry.coordinates.length >= 2 && geojson.geometry.coordinates[1]) {\n        // create custom feature for the current pointer position\n        const currentVertex = {\n            type: 'Feature',\n            properties: {\n                meta: 'currentPosition',\n                parent: state.line.id,\n            },\n            geometry: {\n                type: 'Point',\n                coordinates: geojson.geometry.coordinates[1],\n            },\n        };\n        display(currentVertex);\n    }\n\n    return null;\n};\n\nexport default stripMode;\n","/*\n * Licensed to Gisaïa under one or more contributor\n * license agreements. See the NOTICE.txt file distributed with\n * this work for additional information regarding copyright\n * ownership. Gisaïa licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport MapboxDraw from '@mapbox/mapbox-gl-draw';\nimport center from '@turf/center';\nimport distance from '@turf/distance';\nimport { point } from '@turf/helpers';\nimport midpoint from '@turf/midpoint';\nimport rhumbDestination from '@turf/rhumb-destination';\n\nimport rhumbBearing from '@turf/rhumb-bearing';\nimport transformRotate from '@turf/transform-rotate';\nimport { buildStrip, computeStripProperties } from './strip.mode';\n\nexport const stripDirectSelectMode: any = {};\n\n\nstripDirectSelectMode.onSetup = function (opts) {\n    const featureId = opts.featureId;\n    const halfSwath = opts.halfSwath;\n    const maxLength = opts.maxLength;\n    const feature = this.getFeature(featureId);\n\n    if (!featureId) {\n        throw new Error('You must provide a valid featureId to enter strip_direct mode');\n    }\n    if (!halfSwath) {\n        throw new Error('You must provide a valid halfSwath to enter strip_direct mode');\n    }\n    if (!maxLength) {\n        throw new Error('You must provide a valid maxLength to enter strip_direct mode');\n    }\n\n    if (feature.type !== MapboxDraw.constants.geojsonTypes.POLYGON) {\n        throw new TypeError('strip_direct mode can only handle polygons');\n    }\n    if (feature.coordinates === undefined\n        || feature.coordinates.length !== 1\n        || feature.coordinates[0].length <= 2) {\n        throw new TypeError('strip_direct mode can only handle polygons');\n    }\n\n    const state = {\n        featureId,\n        feature,\n        halfSwath,\n        maxLength,\n        resizePointRadius: opts.resizePointRadius !== undefined ? opts.resizePointRadius : 1,\n        rotationPointRadius: opts.rotationPointRadius !== undefined ? opts.rotationPointRadius : 1.0,\n        canSelectFeatures: opts.canSelectFeatures !== undefined ? opts.canSelectFeatures : true,\n        dragMoveLocation: opts.startPos || null,\n        dragMoving: false,\n        canDragMove: false,\n        selectedCoordPaths: opts.coordPath ? [opts.coordPath] : []\n    };\n\n    this.setSelectedCoordinates(this.pathsToCoordinates(featureId, state.selectedCoordPaths));\n    this.setSelected(featureId);\n    MapboxDraw.lib.doubleClickZoom.disable(this);\n    this.setActionableState({\n        combineFeatures: false,\n        uncombineFeatures: false,\n        trash: true\n    });\n    this.addFeature(feature);\n\n    return state;\n};\n\nstripDirectSelectMode.fireOnStop = function () {\n    this.map.fire('draw.onStop', 'draw end');\n};\n\nstripDirectSelectMode.toDisplayFeatures = function (state, geojson, push) {\n    if (state.featureId === geojson.properties.id) {\n        geojson.properties.active = MapboxDraw.constants.activeStates.ACTIVE;\n        push(geojson);\n        const suppPoints = MapboxDraw.lib.createSupplementaryPoints(geojson, {\n            map: this.map,\n            midpoints: false,\n            selectedPaths: state.selectedCoordPaths\n        });\n        const actionsPoints = this.createActionPoints(state, geojson, suppPoints);\n        actionsPoints.forEach(push);\n    } else {\n        geojson.properties.active = MapboxDraw.constants.activeStates.INACTIVE;\n        push(geojson);\n    }\n\n    this.setActionableState({\n        combineFeatures: false,\n        uncombineFeatures: false,\n        trash: true\n    });\n\n};\n\nstripDirectSelectMode.onStop = function () {\n    MapboxDraw.lib.doubleClickZoom.enable(this);\n    this.clearSelectedCoordinates();\n    this.fireOnStop();\n};\n\nstripDirectSelectMode.pathsToCoordinates = function (featureId, paths) {\n    return paths.map(coord_path => ({ feature_id: featureId, coord_path }));\n};\n\nstripDirectSelectMode._createActionPoint = function (actionWidgets, featureId, v1, v2, rotCenter, radiusScale, type) {\n    const cR0 = midpoint(v1, v2).geometry.coordinates;\n    const heading = rhumbBearing(rotCenter, cR0);\n    const distance0 = distance(rotCenter, cR0);\n    const distance1 = radiusScale * distance0;\n    const cR1 = rhumbDestination(rotCenter, distance1, heading, {}).geometry.coordinates;\n\n    actionWidgets.push({\n        type: MapboxDraw.constants.geojsonTypes.FEATURE,\n        properties: {\n            meta: MapboxDraw.constants.meta.MIDPOINT,\n            actionType: type,\n            parent: featureId,\n            lng: cR1[0],\n            lat: cR1[1],\n            coord_path: v1.properties.coord_path,\n            coord_path_coords: cR0,\n            heading: heading,\n        },\n        geometry: {\n            type: MapboxDraw.constants.geojsonTypes.POINT,\n            coordinates: cR1\n        }\n    }\n    );\n};\n\nstripDirectSelectMode.createActionPoints = function (state, geojson, suppPoints) {\n    const { type, coordinates } = geojson.geometry;\n    const featureId = geojson.properties && geojson.properties.id;\n    const actionWidgets = [];\n    if (type !== MapboxDraw.constants.geojsonTypes.POLYGON) {\n        return;\n    }\n    const corners = suppPoints.slice(0);\n    corners[corners.length] = corners[0];\n    let v1 = null;\n    const rotCenter = this.computeCenter(state, geojson);\n    corners.forEach((v2) => {\n        if (v1 != null && (v1.properties.coord_path === '0.2')) {\n            this._createActionPoint(actionWidgets, featureId, v1, v2, rotCenter, state.rotationPointRadius, 'resize');\n        }\n        if (v1 != null && (v1.properties.coord_path === '0.0')) {\n            this._createActionPoint(actionWidgets, featureId, v1, v2, rotCenter, state.rotationPointRadius, 'origin');\n        }\n        if (v1 != null && (v1.properties.coord_path === '0.3')) {\n            this._createActionPoint(actionWidgets, featureId, v1, v2, rotCenter, state.rotationPointRadius, 'rotation');\n        }\n        v1 = v2;\n    });\n    state.actionWidgets = actionWidgets;\n    return actionWidgets;\n};\n\nstripDirectSelectMode.startDragging = function (state, e) {\n    this.map.dragPan.disable();\n    state.canDragMove = true;\n    state.dragMoveLocation = e.lngLat;\n};\n\nstripDirectSelectMode.stopDragging = function (state) {\n    this.map.dragPan.enable();\n    state.dragMoving = false;\n    state.canDragMove = false;\n    state.dragMoveLocation = null;\n};\n\nconst isMidPoint = MapboxDraw.lib.CommonSelectors.isOfMetaType(MapboxDraw.constants.meta.MIDPOINT);\n\nstripDirectSelectMode.onTouchStart = stripDirectSelectMode.onMouseDown = function (state, e) {\n    if (isMidPoint(e)) {\n        return this.onActivatePoint(state, e);\n    }\n    if (MapboxDraw.lib.CommonSelectors.isActiveFeature(e)) {\n        return this.onFeature(state, e);\n    }\n};\n\nconst stripDirectMode = {\n    Resize: 1,\n    Rotate: 2\n};\n\nstripDirectSelectMode.onActivatePoint = function (state, e) {\n    this.computeAxes(state, state.feature.toGeoJSON());\n    this.startDragging(state, e);\n    const about = e.featureTarget.properties;\n    state.selectedCoordPaths = [about.coord_path];\n    if (e.featureTarget.properties.actionType === 'rotation') {\n        state.stripDirectMode = stripDirectMode.Rotate;\n    } else if (e.featureTarget.properties.actionType === 'resize') {\n        state.stripDirectMode = stripDirectMode.Resize;\n    }\n};\n\nstripDirectSelectMode.onFeature = function (state, e) {\n    state.selectedCoordPaths = [];\n    this.startDragging(state, e);\n};\n\nstripDirectSelectMode.coordinateIndex = function (coordPaths) {\n    if (coordPaths.length >= 1) {\n        const parts = coordPaths[0].split('.');\n        return parseInt(parts[parts.length - 1], 10);\n    } else {\n        return 0;\n    }\n};\n\nstripDirectSelectMode.computeCenter = function (state, polygon) {\n    const center0 = center(polygon);\n    return center0;\n};\n\nstripDirectSelectMode.computeAxes = function (state, polygon) {\n    const center = this.computeCenter(state, polygon);\n    const corners = polygon.geometry.coordinates[0].slice(0);\n    const n = corners.length - 1;\n    const iHalf = Math.floor(n / 2);\n    const rotateCenters = [];\n    const headings = [];\n    for (let i1 = 0; i1 < n; i1++) {\n        let i0 = i1 - 1;\n        if (i0 < 0) {\n            i0 += n;\n        }\n        const c0 = corners[i0];\n        const c1 = corners[i1];\n        const rotPoint = midpoint(point(c0), point(c1));\n        rotateCenters[i1] = center.geometry.coordinates;\n        headings[i1] = rhumbBearing(center, rotPoint);\n    }\n    state.rotation = {\n        feature0: polygon,  // initial feature state\n        centers: rotateCenters,\n        headings: headings, // rotation start heading for each point\n    };\n};\n\nstripDirectSelectMode.onDrag = function (state, e) {\n    if (state.canDragMove !== true) {\n        return;\n    }\n    state.dragMoving = true;\n    e.originalEvent.stopPropagation();\n\n    const delta = {\n        lng: e.lngLat.lng - state.dragMoveLocation.lng,\n        lat: e.lngLat.lat - state.dragMoveLocation.lat\n    };\n    if (state.selectedCoordPaths.length > 0 && state.stripDirectMode) {\n        switch (state.stripDirectMode) {\n            case stripDirectMode.Rotate:\n                this.dragRotatePoint(state, e, delta);\n                break;\n            case stripDirectMode.Resize:\n                this.dragResizePoint(state, e, delta);\n                break;\n        }\n    } else {\n        this.dragFeature(state, e, delta);\n    }\n\n\n    state.dragMoveLocation = e.lngLat;\n};\n\nstripDirectSelectMode.dragRotatePoint = function (state, e, delta) {\n    if (state.rotation === undefined || state.rotation == null) {\n        console.error('state.rotation required');\n        return;\n    }\n    const m1 = point([e.lngLat.lng, e.lngLat.lat]);\n    const n = state.rotation.centers.length;\n    const cIdx = (this.coordinateIndex(state.selectedCoordPaths) + 1) % n;\n    const cCenter = state.rotation.centers[cIdx];\n    const cp = point(cCenter);\n    const heading1 = rhumbBearing(cp, m1);\n    const heading0 = state.rotation.headings[cIdx];\n    const rotateAngle = heading1 - heading0; // in degrees\n    const rotatedFeature = transformRotate(state.rotation.feature0,\n        rotateAngle,\n        {\n            pivot: cp,\n            mutate: false,\n        });\n    state.start = undefined;\n    state.feature.incomingCoords(rotatedFeature.geometry.coordinates);\n    Object.assign(state.feature.properties, computeStripProperties(state.feature.coordinates[0]));\n    this.fireUpdate();\n};\n\n\nstripDirectSelectMode.dragResizePoint = function (state, e, delta) {\n    const end = [e.lngLat.lng, e.lngLat.lat];\n    let start;\n    if (!state.selectedResizePaths) {\n        state.selectedResizePaths = state.selectedCoordPaths[0];\n    }\n    if (!state.start || state.selectedResizePaths !== state.selectedCoordPaths[0]) {\n        if (state.selectedCoordPaths[0] === '0.0') {\n            start = state.actionWidgets.find(a => a.properties.coord_path === '0.2').properties.coord_path_coords;\n        } else {\n            start = state.actionWidgets.find(a => a.properties.coord_path === '0.0').properties.coord_path_coords;\n        }\n        state.start = start;\n    }\n    const dist = distance(point(state.start), point(end), { units: 'kilometers' });\n    const newPolygon = buildStrip(state.start, end, state.halfSwath);\n    if (dist <= state.maxLength) {\n        state.feature.setCoordinates(newPolygon.geometry.coordinates);\n        Object.assign(state.feature.properties, computeStripProperties(state.feature.coordinates[0]));\n        this.fireUpdate();\n    }\n};\n\n\n\nstripDirectSelectMode.dragFeature = function (state, e, delta) {\n    MapboxDraw.lib.moveFeatures(this.getSelected(), delta);\n    state.dragMoveLocation = e.lngLat;\n    state.start = undefined;\n    Object.assign(state.feature.properties, computeStripProperties(state.feature.coordinates[0]));\n    this.fireUpdate();\n};\n\nstripDirectSelectMode.fireUpdate = function () {\n    this.map.fire(MapboxDraw.constants.events.UPDATE, {\n        action: MapboxDraw.constants.updateActions.CHANGE_COORDINATES,\n        features: this.getSelected().map(f => f.toGeoJSON())\n    });\n};\n\nstripDirectSelectMode.onMouseOut = function (state) {\n    // As soon as you mouse leaves the canvas, update the feature\n    if (state.dragMoving) {\n        this.fireUpdate();\n    }\n};\n\nstripDirectSelectMode.onTouchEnd = stripDirectSelectMode.onMouseUp = function (state) {\n    if (state.dragMoving) {\n        this.fireUpdate();\n    }\n    this.stopDragging(state);\n};\n\nstripDirectSelectMode.clickActiveFeature = function (state) {\n    state.selectedCoordPaths = [];\n    this.clearSelectedCoordinates();\n    state.feature.changed();\n};\n\nstripDirectSelectMode.onClick = function (state, e) {\n    if (MapboxDraw.lib.CommonSelectors.noTarget(e)) {\n        return this.clickNoTarget(state, e);\n    }\n    if (MapboxDraw.lib.CommonSelectors.isActiveFeature(e)) {\n        return this.clickActiveFeature(state, e);\n    }\n    if (MapboxDraw.lib.CommonSelectors.isInactiveFeature(e)) {\n        return this.clickInactive(state, e);\n    }\n    this.stopDragging(state);\n};\n\nstripDirectSelectMode.clickNoTarget = function (state, e) {\n    if (state.canSelectFeatures) {\n        this.changeMode(MapboxDraw.constants.modes.SIMPLE_SELECT);\n    }\n};\n\nstripDirectSelectMode.clickInactive = function (state, e) {\n    if (state.canSelectFeatures) {\n        this.changeMode(MapboxDraw.constants.modes.SIMPLE_SELECT, {\n            featureIds: [e.featureTarget.properties.id]\n        });\n    }\n};\n\nstripDirectSelectMode.onTrash = function () {\n    this.deleteFeature(this.getSelectedIds());\n};\n","/*\n * Licensed to Gisaïa under one or more contributor\n * license agreements. See the NOTICE.txt file distributed with\n * this work for additional information regarding copyright\n * ownership. Gisaïa licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nconst roundLineLayout = {\n  'line-cap': 'round',\n  'line-join': 'round'\n};\n\nconst staticModeVertex = ['all',\n  ['==', 'meta', 'vertex'],\n  ['==', '$type', 'Point'],\n  ['!=', 'mode', 'static']\n];\n\nconst deactivatedStaticModeFeature = ['all',\n  ['==', 'active', 'false'],\n  ['==', '$type', 'Point'],\n  ['==', 'meta', 'feature'],\n  ['!=', 'mode', 'static']\n];\nconst deactivatedStaticPolygon = ['all',\n  ['==', 'active', 'false'],\n  ['==', '$type', 'Polygon'],\n  ['!=', 'mode', 'static']\n];\n\nconst activatedMidPoint = ['all',\n  ['==', '$type', 'Point'],\n  ['==', 'active', 'true'],\n  ['!=', 'meta', 'midpoint']\n];\nconst staticLineMidPoint = ['all', ['==', 'meta', 'midpoint'],\n  ['==', 'actionType', 'rotation'],\n  ['==', '$type', 'LineString'],\n  ['!=', 'mode', 'static']\n];\n\nconst staticPolygon = ['all', ['==', 'mode', 'static'], ['==', '$type', 'Polygon']];\nconst activePolygon = ['all', ['==', 'active', 'true'], ['==', '$type', 'Polygon']];\nconst staticMidpoint = ['all',\n  ['==', 'meta', 'midpoint'],\n  ['==', 'actionType', 'resize'],\n  ['==', '$type', 'Point'],\n  ['!=', 'mode', 'static']\n];\nconst dashedLinePaint = {\n  'line-color': '#fbb03b',\n  'line-dasharray': [0.2, 2],\n  'line-width': 2\n};\n\nconst linePaint = {\n  'line-color': '#3bb2d0',\n  'line-width': 2\n};\n\nconst rotatePointFilter = ['all',\n  ['==', 'meta', 'midpoint'],\n  ['==', 'actionType', 'rotation'],\n  ['==', '$type', 'Point'],\n  ['!=', 'mode', 'static']\n];\nexport default [\n  {\n    'id': 'gl-draw-polygon-fill-inactive',\n    'type': 'fill',\n    'filter': deactivatedStaticPolygon,\n    'paint': {\n      'fill-color': '#3bb2d0',\n      'fill-outline-color': '#3bb2d0',\n      'fill-opacity': 0.1\n    }\n  },\n  {\n    'id': 'gl-draw-polygon-fill-active',\n    'type': 'fill',\n    'filter': activePolygon,\n    'paint': {\n      'fill-color': '#fbb03b',\n      'fill-outline-color': '#fbb03b',\n      'fill-opacity': 0.1\n    }\n  },\n  {\n    'id': 'gl-draw-polygon-midpoint',\n    'type': 'circle',\n    'filter': ['all',\n      ['==', '$type', 'Point'],\n      ['==', 'meta', 'midpoint']],\n    'paint': {\n      'circle-radius': 3,\n      'circle-color': '#fbb03b'\n    }\n  },\n  {\n    'id': 'gl-draw-polygon-stroke-inactive',\n    'type': 'line',\n    'filter': deactivatedStaticPolygon,\n    'layout': roundLineLayout,\n    'paint': linePaint\n  },\n  {\n    'id': 'gl-draw-polygon-stroke-active',\n    'type': 'line',\n    'filter': activePolygon,\n    'layout': roundLineLayout,\n    'paint': dashedLinePaint\n  },\n  {\n    'id': 'gl-draw-line-inactive',\n    'type': 'line',\n    'filter': ['all',\n      ['==', 'active', 'false'],\n      ['==', '$type', 'LineString'],\n      ['!=', 'mode', 'static']\n    ],\n    'layout': roundLineLayout,\n\n    'paint': linePaint\n  },\n  {\n    'id': 'gl-draw-line-active',\n    'type': 'line',\n    'filter': ['all',\n      ['==', '$type', 'LineString'],\n      ['==', 'active', 'true']\n    ],\n    'layout': roundLineLayout,\n    'paint': dashedLinePaint\n  },\n  {\n    'id': 'gl-draw-polygon-and-line-vertex-stroke-inactive',\n    'type': 'circle',\n    'filter': staticModeVertex,\n    'paint': {\n      'circle-radius': 5,\n      'circle-color': '#fff'\n    }\n  },\n  {\n    'id': 'gl-draw-polygon-and-line-vertex-inactive',\n    'type': 'circle',\n    'filter': staticModeVertex,\n    'paint': {\n      'circle-radius': 3,\n      'circle-color': '#fbb03b'\n    }\n  },\n  {\n    'id': 'gl-draw-point-point-stroke-inactive',\n    'type': 'circle',\n    'filter': deactivatedStaticModeFeature,\n    'paint': {\n      'circle-radius': 5,\n      'circle-opacity': 1,\n      'circle-color': '#fff'\n    }\n  },\n  {\n    'id': 'gl-draw-point-inactive',\n    'type': 'circle',\n    'filter': deactivatedStaticModeFeature,\n    'paint': {\n      'circle-radius': 3,\n      'circle-color': '#3bb2d0'\n    }\n  },\n  {\n    'id': 'gl-draw-point-stroke-active',\n    'type': 'circle',\n    'filter': activatedMidPoint,\n    'paint': {\n      'circle-radius': 7,\n      'circle-color': '#fff'\n    }\n  },\n  {\n    'id': 'gl-draw-point-active',\n    'type': 'circle',\n    'filter': activatedMidPoint,\n    'paint': {\n      'circle-radius': 5,\n      'circle-color': '#fbb03b'\n    }\n  },\n  {\n    'id': 'gl-draw-polygon-fill-static',\n    'type': 'fill',\n    'filter': staticPolygon,\n    'paint': {\n      'fill-color': '#3bb2d0',\n      'fill-outline-color': '#3bb2d0',\n      'fill-opacity': 0.1\n    }\n  },\n  {\n    'id': 'gl-draw-polygon-stroke-static',\n    'type': 'line',\n    'filter': staticPolygon,\n    'layout': roundLineLayout,\n\n    'paint': linePaint\n  },\n  {\n    'id': 'gl-draw-line-static',\n    'type': 'line',\n    'filter': ['all', ['==', 'mode', 'static'], ['==', '$type', 'LineString']],\n    'layout': roundLineLayout,\n\n    'paint': {\n      'line-color': '#404040',\n      'line-width': 2\n    }\n  },\n  {\n    'id': 'gl-draw-point-static',\n    'type': 'circle',\n    'filter': ['all', ['==', 'mode', 'static'], ['==', '$type', 'Point']],\n    'paint': {\n      'circle-radius': 5,\n      'circle-color': '#404040'\n    }\n  },\n  {\n    'id': 'gl-draw-line-rotate-point',\n    'type': 'line',\n    'filter': staticLineMidPoint,\n    'layout': roundLineLayout,\n\n    'paint': dashedLinePaint\n  },\n  {\n    'id': 'gl-draw-polygon-rotate-point-stroke',\n    'type': 'circle',\n    'filter': rotatePointFilter,\n    'paint': {\n      'circle-radius': 4,\n      'circle-color': '#fff'\n    }\n  },\n  {\n    'id': 'gl-draw-polygon-rotate-point',\n    'type': 'circle',\n    'filter': rotatePointFilter,\n    'paint': {\n      'circle-radius': 2,\n      'circle-color': '#fbb03b'\n    }\n  },\n  {\n    'id': 'gl-draw-polygon-rotate-point-icon',\n    'type': 'symbol',\n    'filter': rotatePointFilter,\n    'layout': {\n      'icon-image': 'rotate',\n      'icon-allow-overlap': true,\n      'icon-ignore-placement': true,\n      'icon-rotation-alignment': 'map',\n      'icon-rotate': ['get', 'heading']\n    },\n    'paint': {\n      'icon-opacity': 1.0,\n      'icon-opacity-transition': {\n        'delay': 0,\n        'duration': 0\n      }\n    }\n  },\n  {\n    'id': 'gl-draw-line-resize-point',\n    'type': 'line',\n    'filter': staticLineMidPoint,\n    'layout': roundLineLayout,\n\n    'paint': dashedLinePaint\n  },\n  {\n    'id': 'gl-draw-polygon-resize-point-stroke',\n    'type': 'circle',\n    'filter': staticMidpoint,\n    'paint': {\n      'circle-radius': 5,\n      'circle-color': '#fff'\n    }\n  },\n  {\n    'id': 'gl-draw-polygon-resize-point',\n    'type': 'circle',\n    'filter': staticMidpoint,\n    'paint': {\n      'circle-radius': 6,\n      'circle-color': '#fbb03b'\n    }\n  },\n  {\n    'id': 'gl-draw-polygon-resize-point-icon',\n    'type': 'symbol',\n    'filter': staticMidpoint,\n    'layout': {\n      'icon-image': 'resize',\n      'icon-allow-overlap': true,\n      'icon-ignore-placement': true,\n      'icon-rotation-alignment': 'map',\n      'icon-rotate': ['get', 'heading']\n    },\n    'paint': {\n      'icon-opacity': 1.0,\n      'icon-opacity-transition': {\n        'delay': 0,\n        'duration': 0\n      }\n    }\n  }\n];\n","/*\n * Licensed to Gisaïa under one or more contributor\n * license agreements. See the NOTICE.txt file distributed with\n * this work for additional information regarding copyright\n * ownership. Gisaïa licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { Component, EventEmitter, HostListener, Input, OnInit, Output, signal, SimpleChanges, ViewEncapsulation } from '@angular/core';\nimport { takeUntilDestroyed } from '@angular/core/rxjs-interop';\nimport { MatSnackBar } from '@angular/material/snack-bar';\nimport { marker } from '@colsen1991/ngx-translate-extract-marker';\nimport StaticMode from '@mapbox/mapbox-gl-draw-static-mode';\nimport { TranslateService } from '@ngx-translate/core';\nimport centroid from '@turf/centroid';\nimport cleanCoords from '@turf/clean-coords';\nimport { Feature, FeatureCollection, Geometry, Polygon, polygon } from '@turf/helpers';\nimport { ArlasMapFrameworkService } from '../arlas-map-framework.service';\nimport { AbstractArlasMapService } from '../arlas-map.service';\nimport { AbstractArlasMapGL } from '../map/AbstractArlasMapGL';\nimport { DrawControlsOption } from '../map/model/controls';\nimport { MapMouseEvent } from '../map/model/events';\nimport { latLngToWKT } from '../map/tools';\nimport { AbstractDraw, DrawModes } from './AbstractDraw';\nimport { AoiDimensions, BboxDrawCommand } from './draw.models';\nimport { MapboxAoiDrawService } from './draw.service';\nimport { limitVertexDirectSelectMode } from './modes/LimitVertexDirectSelectMode';\nimport { validGeomDrawPolygonMode } from './modes/ValidGeomDrawPolygonMode';\nimport { circleMode } from './modes/circles/circle.mode';\nimport { radiusCircleMode } from './modes/circles/radius.circle.mode';\nimport { directModeOverride } from './modes/directSelectOverride';\nimport { rectangleMode } from './modes/rectangleMode';\nimport { simpleSelectModeOverride } from './modes/simpleSelectOverride';\nimport { stripDirectSelectMode } from './modes/strip/strip.direct.mode';\nimport { stripMode } from './modes/strip/strip.mode';\nimport * as styles from './themes/default-theme';\n\n@Component({\n  selector: 'arlas-draw',\n  templateUrl: './arlas-draw.component.html',\n  styleUrls: ['./arlas-draw.component.scss'],\n  encapsulation: ViewEncapsulation.None\n})\n/** L: a layer class/interface.\n *  S: a source class/interface.\n *  M: a Map configuration class/interface.\n */\nexport class ArlasDrawComponent<L, S, M> implements OnInit {\n\n  @Input() public map: AbstractArlasMapGL;\n\n  @Input() private emptyData: FeatureCollection<GeoJSON.Geometry> = {\n    'type': 'FeatureCollection',\n    'features': []\n  };\n  /**  @description Options object for draw tools : https://github.com/mapbox/mapbox-gl-draw/blob/master/docs/API.md#options */\n  @Input() public drawOption: any = {};\n  /** Draw instance. */\n  public draw: AbstractDraw;\n  /** @description Features drawn at component start */\n  @Input() public drawData: FeatureCollection<GeoJSON.Geometry> = ({ ...this.emptyData });\n  /** @description Whether the draw tools are activated. */\n  @Input() public drawButtonEnabled = false;\n  /** @description Maximum number of vertices allowed for a polygon. */\n  @Input() public drawPolygonVerticesLimit: number;\n  /** @description Whether the drawing buffer is activated */\n  /** If true, the map's canvas can be exported to a PNG using map.getCanvas().toDataURL(). Default: false */\n  @Input() public preserveDrawingBuffer = false;\n\n  /** @description Emits the geojson of an aoi added to the map. */\n  @Output() public onAoiChanged: EventEmitter<FeatureCollection<GeoJSON.Geometry>> = new EventEmitter();\n\n  /** @description Emits the the dimensions of the polygon/bbox that is being drawn. */\n  @Output() public onAoiEdit: EventEmitter<AoiDimensions> = new EventEmitter();\n\n\n  /** Number of drawn vertices (incremented in draw mode). Reset to 0 when the drawing is finished. */\n  public nbPolygonVertices = 0;\n  /** Number of clicks while drawing a geometry. */\n  public drawClickCounter = 0;\n\n  /** List of drawn polygons centroid */\n  public polygonlabeldata: FeatureCollection<GeoJSON.Geometry> = ({ ...this.emptyData });\n\n\n  /** Drawn geometry's state when editing/updating. */\n  protected savedEditFeature = null;\n  /** Map container Html element */\n  protected canvas: HTMLElement;\n  /** Html element that holds the drawing message. */\n  protected drawTooltipElement: HTMLElement;\n  /** Message shown to explain how to draw. */\n  public drawTooltipMessage = signal<string>('');\n\n  public constructor(\n    private readonly drawService: MapboxAoiDrawService,\n    private readonly _snackBar: MatSnackBar,\n    private readonly translate: TranslateService,\n    protected mapFrameworkService: ArlasMapFrameworkService<L, S, M>,\n    protected mapService: AbstractArlasMapService<L, S, M>\n  ) {\n    this.drawService.editAoi$.pipe(takeUntilDestroyed()).subscribe(ae => this.onAoiEdit.emit(ae));\n    this.drawService.drawBbox$.pipe(takeUntilDestroyed()).subscribe({\n      next: (bboxDC: BboxDrawCommand) => {\n        this.drawBbox(bboxDC.east, bboxDC.south, bboxDC.west, bboxDC.north);\n      }\n    });\n  }\n\n  /**\n   * @description Stops the drawing mode by changing to static mode.\n   */\n  private stopDrawingAtVerticeLimit() {\n    if (this.nbPolygonVertices === this.drawPolygonVerticesLimit) {\n      this.draw.changeMode('static');\n      this.drawService.isDrawingPolygon = false;\n      this.nbPolygonVertices = 0;\n      this.drawClickCounter = 0;\n    }\n  }\n\n  private listenToDrawOnCreate() {\n    this.draw.on('draw.create', (e) => {\n      this.onAoiChanged.next(\n        {\n          'type': 'FeatureCollection',\n          'features': this.draw.getAllFeatures().filter(fc =>\n            this.drawService.isValidPolygon(fc) ||\n            this.drawService.isValidCircle(fc)\n          ).map(f => cleanCoords(f))\n        });\n    });\n  }\n\n  private listenToDrawUpdate() {\n    this.draw.on('draw.update', (e) => {\n      if (e) {\n        const features = e.features;\n        if (features && features.length > 0) {\n          this.savedEditFeature = { ...features[0] };\n          this.savedEditFeature.coordinates = [[]];\n          features[0].geometry.coordinates[0].forEach(f => this.savedEditFeature.coordinates[0].push(f));\n        }\n      }\n    });\n  }\n\n  private listenToDrawDelete() {\n    this.draw.on('draw.delete', (e) => {\n      this.onAoiChanged.next(\n        {\n          'type': 'FeatureCollection',\n          'features': this.draw.getAllFeatures().filter(fc =>\n            this.drawService.isPolygon(fc) ||\n            this.drawService.isCircle(fc)\n          ).map(f => cleanCoords(f))\n        });\n    });\n  }\n\n  private listenToDrawInvalidGeometry() {\n    this.draw.onDrawInvalidGeometry((e) => {\n      if (this.savedEditFeature) {\n        const featureCoords = this.savedEditFeature.coordinates[0].slice();\n        if (featureCoords[0][0] !== featureCoords[featureCoords.length - 1][0] ||\n          featureCoords[0][1] !== featureCoords[featureCoords.length - 1][1]) {\n          featureCoords.push(featureCoords[0]);\n        }\n        const currentFeature = {\n          id: '',\n          type: 'Feature',\n          geometry: {\n            'type': 'Polygon',\n            'coordinates': [featureCoords]\n          },\n          properties: {}\n        };\n        currentFeature.id = this.savedEditFeature.id;\n        currentFeature.properties = this.savedEditFeature.properties;\n        this.draw.add(currentFeature as Feature<Polygon>);\n      }\n      this.openInvalidGeometrySnackBar();\n      this.mapFrameworkService.setMapCursor(this.map, '');\n    });\n  }\n\n  private listenToDrawSelectionChange() {\n    this.draw.onDrawSelectionchange((e) => {\n      if (e.features.length > 0) {\n        this.drawService.isDrawSelected = true;\n      } else {\n        this.savedEditFeature = null;\n        this.drawService.isDrawSelected = false;\n        this.onAoiChanged.next(\n          {\n            'type': 'FeatureCollection',\n            'features': this.draw.getAllFeatures().filter(fc =>\n              this.drawService.isValidPolygon(fc) ||\n              this.drawService.isValidCircle(fc)\n            ).map(f => cleanCoords(f))\n          });\n        this.switchToStaticMode();\n        this.mapFrameworkService.setMapCursor(this.map, '');\n      }\n    });\n  }\n\n  private listenToDrawModeChange() {\n    this.draw.onDrawModeChange((e) => {\n      this.updateTooltipMessage();\n      this.drawService.isDrawingPolygon = e.mode === this.draw.getMode('DRAW_POLYGON');\n      this.drawService.isDrawingStrip = e.mode === this.draw.getMode('DRAW_STRIP') || e.mode === this.draw.getMode('DIRECT_STRIP');\n      this.drawService.isDrawingCircle = e.mode === this.draw.getMode('DRAW_CIRCLE') || e.mode === this.draw.getMode('DRAW_RADIUS_CIRCLE');\n      this.drawService.isDrawingBbox = e.mode === this.draw.getMode('DRAW_RECTANGLE');\n      if (this.drawService.isDrawingPolygon || this.drawService.isDrawingCircle || this.drawService.isDrawingStrip || e.mode === 'static') {\n        this.drawService.isInSimpleDrawMode = false;\n      }\n      if (e.mode === 'simple_select') {\n        this.drawService.isInSimpleDrawMode = true;\n      } else if (e.mode === 'static') {\n        this.mapFrameworkService.setMapCursor(this.map, '');\n      } else if (e.mode === 'direct_select') {\n        const selectedFeatures = this.draw.getSelectedFeatures();\n        const selectedIds = this.draw.getSelectedIds();\n        if (selectedFeatures && selectedIds && selectedIds.length > 0) {\n          if (selectedFeatures[0].properties.source === 'bbox') {\n            this.draw.changeMode('simple_select', {\n              featureIds: [selectedIds[0]]\n            });\n            this.drawService.isInSimpleDrawMode = true;\n          } else if (this.drawPolygonVerticesLimit && selectedFeatures[0].properties.meta !== 'strip') {\n            this.draw.changeMode('limit_vertex', {\n              featureId: selectedIds[0],\n              maxVertexByPolygon: this.drawPolygonVerticesLimit,\n              selectedCoordPaths: (selectedFeatures[0] as Feature<Geometry>).geometry.coordinates\n            });\n            this.drawService.isInSimpleDrawMode = false;\n          } else if (this.drawPolygonVerticesLimit && selectedFeatures[0].properties.meta === 'strip') {\n            this.draw.changeMode('direct_strip', {\n              featureId: selectedIds[0],\n              maxLength: selectedFeatures[0].properties.maxLength,\n              halfSwath: selectedFeatures[0].properties.halfSwath,\n            });\n            this.drawService.isInSimpleDrawMode = false;\n          }\n        } else {\n          this.drawService.isInSimpleDrawMode = false;\n          this.mapFrameworkService.setMapCursor(this.map, '');\n        }\n      }\n    });\n\n  }\n\n  public ngOnInit(): void {\n    this.drawTooltipElement = document.getElementById('arlas-draw-tooltip');\n    const drawStyles = styles.default;\n    const drawOptions = {\n      ...this.drawOption,\n      ...{\n        styles: drawStyles,\n        modes: {\n          static: StaticMode,\n          limit_vertex: limitVertexDirectSelectMode,\n          draw_polygon: validGeomDrawPolygonMode,\n          draw_circle: circleMode,\n          draw_radius_circle: radiusCircleMode,\n          draw_strip: stripMode,\n          direct_strip: stripDirectSelectMode,\n          draw_rectangle: rectangleMode,\n          direct_select: directModeOverride,\n          simple_select: simpleSelectModeOverride\n        },\n        suppressAPIEvents: true\n      }\n    };\n    this.draw = this.mapFrameworkService.createDraw(drawOptions, this.drawButtonEnabled, this.map);\n    this.draw.setMode('DRAW_CIRCLE', 'draw_circle');\n    this.draw.setMode('DRAW_RADIUS_CIRCLE', 'draw_radius_circle');\n    this.draw.setMode('DRAW_STRIP', 'draw_strip');\n    this.draw.setMode('STATIC', 'static');\n    this.draw.setMode('DIRECT_STRIP', 'direct_strip');\n    this.draw.setMode('DRAW_RECTANGLE', 'draw_rectangle');\n    const drawControlConfig: DrawControlsOption = {\n      draw: { control: this.draw },\n      addGeoBox: {\n        enable: true,\n        overrideEvent:\n        {\n          event: 'click',\n          fn: this.addGeoBox\n        }\n      },\n      removeAois: {\n        enable: true,\n        overrideEvent: { event: 'click', fn: this.removeAois }\n      }\n    };\n    this.map.initDrawControls(drawControlConfig);\n    this.drawService.setDraw(this.draw);\n    this.mapFrameworkService.onMapEvent('load', this.map, () => {\n      this.mapService.declareLabelSources('', this.polygonlabeldata, this.map);\n      this.switchToStaticMode();\n      this.canvas = this.map.getCanvasContainer();\n      this.listenToDrawOnCreate();\n      this.listenToDrawUpdate();\n      this.listenToDrawDelete();\n      this.canvas.addEventListener('mousemove', this.mouseMoveForDraw, true);\n\n      this.draw.onDrawOnStart((e) => {\n        this.drawClickCounter = 0;\n        this.mapFrameworkService.setMapCursor(this.map, '');\n      });\n      this.draw.onDrawOnStop((e) => {\n        this.drawClickCounter = 0;\n        this.mapFrameworkService.setMapCursor(this.map, '');\n      });\n\n      this.listenToDrawInvalidGeometry();\n\n      this.draw.onDrawEditSaveInitialFeature((edition) => {\n        this.savedEditFeature = { ...edition.feature };\n        this.savedEditFeature.coordinates = [[]];\n        edition.feature.coordinates[0].forEach(c => this.savedEditFeature.coordinates[0].push(c));\n      });\n\n      this.listenToDrawSelectionChange();\n      this.listenToDrawModeChange();\n      this.mapFrameworkService.onMapEvent('click', this.map, (e) => {\n        if (this.drawService.isDrawing()) {\n          this.drawClickCounter++;\n          this.updateTooltipMessage();\n        }\n\n        if (this.drawService.isDrawingCircle) {\n          return;\n        }\n        if (this.drawService.isDrawingPolygon) {\n          this.nbPolygonVertices++;\n          this.stopDrawingAtVerticeLimit();\n        } else {\n          this.nbPolygonVertices = 0;\n          const features = this.map.queryRenderedFeatures(e.point);\n          // edit polygon condition : no arlas feature && mapbox-gl-draw source present\n          const editCondition = features.filter(f => f.layer.id?.indexOf('arlas') >= 0).length === 0 &&\n            features.filter(f => f.source.startsWith('mapbox-gl-draw')).length > 0;\n          if (editCondition) {\n            const candidates = features.filter(f => f.source.startsWith('mapbox-gl-draw'));\n            // edit only on click on the border of the polygon\n            const candidatesProperties = candidates.filter(f => f.layer.id?.indexOf('stroke') >= 0)[0]?.properties;\n            if (candidatesProperties?.id) {\n              if (candidatesProperties.user_meta === 'strip') {\n                this.draw.changeMode('direct_strip', {\n                  featureId: candidatesProperties.id,\n                  maxLength: candidatesProperties.user_maxLength,\n                  halfSwath: candidatesProperties.user_halfSwath\n                });\n                this.drawService.isInSimpleDrawMode = false;\n              } else {\n                this.draw.changeMode('simple_select', {\n                  featureIds: [candidatesProperties.id]\n                });\n                this.drawService.isInSimpleDrawMode = true;\n              }\n            }\n          }\n        }\n      });\n    });\n\n    this.mapFrameworkService.onMapEvent('mousemove', this.map, (e: MapMouseEvent) => {\n      if (this.drawService.isDrawingBbox || this.drawService.isDrawingPolygon) {\n        this.mapFrameworkService.setMapCursor(this.map, 'crosshair');\n        this.map.moveLngLat = e.lngLat;\n      }\n    });\n\n  }\n\n  public ngOnChanges(changes: SimpleChanges): void {\n    if (this.map && this.map.getMapProvider() !== undefined) {\n      if (changes['drawData'] !== undefined && this.drawService.isReady) {\n        const centroides = new Array();\n        this.drawData.features.forEach(feature => {\n          const poly = polygon((feature.geometry as Polygon).coordinates);\n          const cent = centroid(poly);\n          cent.properties.arlas_id = feature.properties.arlas_id;\n          centroides.push(cent);\n        });\n        this.polygonlabeldata = {\n          type: 'FeatureCollection',\n          features: centroides\n        };\n\n        this.drawService.addFeatures(this.drawData, /** deleteOld */ true);\n        this.mapService.updateLabelSources(this.map.POLYGON_LABEL_SOURCE, this.polygonlabeldata, this.map);\n      }\n\n    }\n  }\n\n  /**\n   * Update the tooltip message when drawing to reflect drawing mode and state\n   */\n  public updateTooltipMessage() {\n    let tooltipMessage;\n    switch (this.draw.getCurrentMode().toLocaleUpperCase() as DrawModes) {\n      case 'DRAW_RADIUS_CIRCLE':\n        if (this.drawClickCounter === 0) {\n          tooltipMessage = marker('Click to set the center of the circle');\n        } else {\n          tooltipMessage = marker('Click again to set the radius of the circle');\n        }\n        break;\n      case 'DRAW_POLYGON':\n        if (this.drawClickCounter < 2) {\n          tooltipMessage = marker('Click to set a corner of the polygon');\n        } else {\n          tooltipMessage = marker('Double click to finish drawing');\n        }\n        break;\n      case 'DRAW_CIRCLE':\n        tooltipMessage = marker('Click to create a circle centered on this point');\n        break;\n      case 'DRAW_STRIP':\n        if (this.drawClickCounter === 0) {\n          tooltipMessage = marker('Click to set the origin of the strip');\n        } else {\n          tooltipMessage = marker('Click again to set the length and bearing of the strip');\n        }\n        break;\n      case 'DRAW_RECTANGLE':\n        if (this.drawClickCounter === 0) {\n          tooltipMessage = marker('Click to set the first corner of the rectangle');\n        } else {\n          tooltipMessage = marker('Click again to complete the rectangle');\n        }\n        break;\n      case 'STATIC':\n      case 'SIMPLE_SELECT':\n        this.drawClickCounter = 0;\n        break;\n      default:\n        break;\n    }\n\n    this.drawTooltipMessage.set(tooltipMessage);\n  }\n\n  private readonly mouseMoveForDraw = (e: MouseEvent) => {\n    const x = e.clientX;\n    const y = e.clientY;\n    this.drawTooltipElement.style.top = (y + 20) + 'px';\n    this.drawTooltipElement.style.left = (x + 20) + 'px';\n  };\n\n  /**\n   * @description Emits the bbox drawn by the BboxGenerator component\n   * @param east\n   * @param south\n   * @param west\n   * @param north\n   */\n  protected drawBbox(east: number, south: number, west: number, north: number) {\n    const coordinates = [[\n      [east, south],\n      [east, north],\n      [west, north],\n      [west, south],\n      [east, south],\n    ]];\n    const polygonGeojson: Feature<GeoJSON.Geometry> = {\n      type: 'Feature',\n      properties: {\n        source: 'bbox'\n      },\n      geometry: {\n        type: 'Polygon',\n        coordinates: coordinates\n      }\n    };\n    const geoboxdata = { ...this.emptyData};\n    geoboxdata.features = [];\n    if (this.drawData?.features && this.drawData.features.length > 0) {\n      this.drawData.features.forEach(df => geoboxdata.features.push(df));\n    }\n    geoboxdata.features.push(polygonGeojson);\n    /** This allows to keep the drawn box on the map. It will be overriden in ngOnChanges `changes['drawData']` */\n    this.drawService.addFeatures(geoboxdata, /** deleteOld */ true);\n    this.onAoiChanged.next(geoboxdata);\n    this.drawService.isDrawingBbox = false;\n    this.drawService.endDimensionsEmission();\n  }\n\n  /** @description Enables bbox drawing mode.*/\n  public addGeoBox() {\n    this.mapFrameworkService.setMapCursor(this.map, 'crosshair');\n    this.switchToDrawMode('draw_rectangle');\n  }\n\n  /**\n   * @description Removes all the aois if none of them is selected. Otherwise it removes the selected one only\n   */\n  public removeAois() {\n    this.mapFrameworkService.setMapCursor(this.map, '');\n    this.drawService.isDrawingBbox = false;\n    this.deleteSelectedItem();\n  }\n\n  /** @description Deletes the selected drawn geometry. If no drawn geometry is selected, all geometries are deteleted */\n  public deleteSelectedItem() {\n    if (this.drawService.isDrawSelected) {\n      this.draw.trash();\n    } else {\n      this.drawService.deleteAll();\n    }\n    this.drawService.isDrawSelected = false;\n    this.onAoiChanged.next(this.draw.getAll() as FeatureCollection<GeoJSON.Geometry>);\n  }\n\n  /**\n   * @description Shows an invalid-geometry error on a snack bar.\n   */\n  public openInvalidGeometrySnackBar() {\n    this._snackBar.open(this.translate.instant('Invalid geometry'), this.translate.instant('Ok'), {\n      duration: 3 * 1000,\n      verticalPosition: 'top',\n      panelClass: 'invalid-geo-toast'\n    });\n  }\n\n  /**\n   * @description Switches to a drawing mode of a polygon, circle, radius circle or strip.\n   * @param mode Draw mode (DRAW_POLYGON, DRAW_CIRCLE, DRAW_RADIUS_CIRCLE or DRAW_STRIP). Default to DRAW_POLYGON\n   * @param option Mapboxdraw option.\n   */\n  public switchToDrawMode(mode?: string, option?: any) {\n    const selectedMode = mode ?? this.draw.getMode('DRAW_POLYGON');\n    this.drawService.isDrawingCircle = selectedMode === this.draw.getMode('DRAW_CIRCLE')\n      || selectedMode === this.draw.getMode('DRAW_RADIUS_CIRCLE');\n    this.drawService.isDrawingPolygon = selectedMode === this.draw.getMode('DRAW_POLYGON');\n    this.drawService.isDrawingStrip = selectedMode === this.draw.getMode('DRAW_STRIP');\n    this.drawService.isDrawingBbox = selectedMode === this.draw.getMode('DRAW_RECTANGLE');\n    this.drawService.isInSimpleDrawMode = false;\n\n    this.mapFrameworkService.setMapCursor(this.map, 'crosshair');\n    this.draw.changeMode(selectedMode, option ?? {});\n    this.updateTooltipMessage();\n  }\n\n  /**\n   * @description Switches to direct_select mode.\n   * @param option Mapboxdraw option.\n   */\n  public switchToDirectSelectMode(option?: { featureIds: Array<string>; allowCircleResize: boolean; }\n    | { featureId: string; allowCircleResize: boolean; }) {\n    this.draw.changeMode('direct_select', option);\n    this.drawService.isInSimpleDrawMode = false;\n    this.drawService.isDrawingCircle = false;\n    this.drawService.isDrawingStrip = false;\n    this.drawService.isDrawingPolygon = false;\n    this.drawService.isDrawingBbox = false;\n  }\n\n  /**\n   * @description Switches to simple_select mode.\n   */\n  public switchToEditMode() {\n    this.draw.changeMode('simple_select', {\n      featureIds: this.draw.getAll().features.map(f => f.id)\n    });\n    this.drawService.isInSimpleDrawMode = true;\n    this.drawService.isDrawingCircle = false;\n    this.drawService.isDrawingStrip = false;\n    this.drawService.isDrawingPolygon = false;\n    this.drawService.isDrawingBbox = false;\n  }\n\n  /**\n   * @description Switches to static mode.\n   */\n  public switchToStaticMode() {\n    this.draw.changeMode('static');\n    this.drawService.isInSimpleDrawMode = false;\n    this.drawService.isDrawingBbox = false;\n    this.drawService.isDrawingCircle = false;\n    this.drawService.isDrawingStrip = false;\n    this.drawService.isDrawingPolygon = false;\n    this.updateTooltipMessage();\n  }\n\n  /**\n   * @description Returns all the drawn polygons as wkt or geojson.\n   * @param mode 'wkt' | 'geojson'\n   * @returns\n   */\n  public getAllPolygon(mode: 'wkt' | 'geojson'): string | Object {\n    let polygon;\n    if (mode === 'wkt') {\n      polygon = latLngToWKT(this.draw.getAll().features.filter(f => this.drawService.isPolygon(f) ||\n        this.drawService.isCircle(f)).map(f => cleanCoords(f)));\n    } else {\n      polygon = {\n        'type': 'FeatureCollection',\n        'features': this.draw.getAll().features.filter(f => this.drawService.isPolygon(f) ||\n          this.drawService.isCircle(f)).map(f => cleanCoords(f))\n      };\n    }\n    return polygon;\n  }\n\n  /**\n   * @returns the selected polygon geometry in WKT or GeoJson given the mode\n   * @param mode : 'wkt' | 'geojson'\n   * @returns Wkt string or Geojson object.\n   */\n  public getSelectedPolygon(mode: 'wkt' | 'geojson'): string | Object {\n    let polygon;\n    if (mode === 'wkt') {\n      polygon = latLngToWKT(this.draw.getSelected().features.filter(f => this.drawService.isPolygon(f) ||\n        this.drawService.isCircle(f)));\n    } else {\n      polygon = {\n        'type': 'FeatureCollection',\n        'features': this.draw.getSelected().features.filter(f => this.drawService.isPolygon(f) ||\n          this.drawService.isCircle(f))\n      };\n    }\n    return polygon;\n  }\n\n  @HostListener('document:keydown', ['$event'])\n  public handleKeyboardEvent(event: KeyboardEvent) {\n    if (event.key === 'Escape') {\n      if (this.drawService.isDrawing()) {\n        this.drawService.deleteUnregisteredFeatures();\n        this.mapFrameworkService.setMapCursor(this.map, '');\n\n        this.switchToStaticMode();\n        this.drawService.endDimensionsEmission();\n      } else if (this.drawService.isInSimpleDrawMode) {\n        this.drawService.isInSimpleDrawMode = false;\n        this.draw.changeMode('simple_select', { featureIds: [] });\n        this.updateTooltipMessage();\n      }\n    }\n  }\n\n}\n\n","<div id=\"arlas-draw-tooltip\" class=\"draw-tooltip--hide\" [class.draw-tooltip--show]=\"drawTooltipMessage()\">\n    {{drawTooltipMessage() | translate}}</div>","/*\n * Licensed to Gisaïa under one or more contributor\n * license agreements. See the NOTICE.txt file distributed with\n * this work for additional information regarding copyright\n * ownership. Gisaïa licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { FormControl, FormGroup, Validators } from '@angular/forms';\nimport { Observable } from 'rxjs';\n\n// eslint-disable-next-line max-len\nexport const DECIMAL_SEXAGESIMAL_REGEX = '^(?<decimal>[+-]?([0-9]*[.])?[0-9]+)$|^(?<degrees>(-?)[0-9]+)°[ ]*((?<minutes>[0-9]+)\\'[ ]*((?<seconds>[0-9]+)\\\")?)?$';\nexport class PointFormGroup extends FormGroup {\n\n    public latitude: FormControl;\n    public longitude: FormControl;\n\n    public latitudeChanges$: Observable<any>;\n    public longitudesChanges$: Observable<any>;\n\n    public constructor(initLat: number | string, initLng: number | string) {\n        const coordinatesRegex = DECIMAL_SEXAGESIMAL_REGEX;\n        const latitude = new FormControl(String(initLat), [\n            Validators.required,\n            Validators.pattern(coordinatesRegex)\n        ]);\n        const longitude = new FormControl(String(initLng), [\n            Validators.required,\n            Validators.pattern(coordinatesRegex),\n        ]);\n        super({\n            latitude,\n            longitude\n        });\n        this.latitude = latitude;\n        this.longitude = longitude;\n    }\n}\n\nexport class Coordinate {\n  /** Parses a coordinate in decimal or sexagesimal degrees and returns the decimal degrees */\n  public static parse(value: string) {\n    const coordinatesRegex = DECIMAL_SEXAGESIMAL_REGEX;\n    const parsedCoordinates = (String(value)).match(coordinatesRegex) as any;\n    if (parsedCoordinates && parsedCoordinates.groups) {\n      const groups = parsedCoordinates.groups;\n      if (groups.decimal) {\n        return +groups.decimal;\n      } else {\n        const degrees = +groups.degrees;\n        const minutes = +groups.minutes;\n        const seconds = +groups.seconds;\n        return this.dmsToDd(degrees, minutes, seconds);\n      }\n    }\n  }\n\n  /** DegreeMinutesSeconds to Decimal degree */\n  public static dmsToDd(degrees: number, minutes: number, seconds: number) {\n    const isNegative = (degrees < 0);\n    if (!minutes) {\n      minutes = 0;\n    }\n    if (!seconds) {\n      seconds = 0;\n    }\n    const dd = Math.abs(degrees) + minutes / 60 + seconds / 3600;\n    return isNegative ? -dd : dd;\n  }\n}\n","/*\n * Licensed to Gisaïa under one or more contributor\n * license agreements. See the NOTICE.txt file distributed with\n * this work for additional information regarding copyright\n * ownership. Gisaïa licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { Pipe, PipeTransform } from '@angular/core';\nimport { FormControl, FormGroup } from '@angular/forms';\nimport { marker } from '@colsen1991/ngx-translate-extract-marker';\n\n@Pipe({\n  name: 'coordinatesFormError'\n})\nexport class CoordinatesErrorPipe implements PipeTransform {\n\n  public transform(formControl: FormControl | FormGroup): string {\n    if (formControl.hasError('required')) {\n      return marker('You must enter a coordinate');\n    }\n    return formControl.hasError('pattern') ? marker('1.1 or 1°6\\'3\"') : '';\n  }\n\n}\n","/*\n * Licensed to Gisaïa under one or more contributor\n * license agreements. See the NOTICE.txt file distributed with\n * this work for additional information regarding copyright\n * ownership. Gisaïa licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { Component, EventEmitter, Input, OnInit, Output } from '@angular/core';\nimport { Coordinate, PointFormGroup } from '../bbox-generator/coordinates.tools';\nimport { FormControl, FormGroup } from '@angular/forms';\nimport { marker } from '@colsen1991/ngx-translate-extract-marker';\n\n@Component({\n  selector: 'arlas-coordinates',\n  templateUrl: './coordinates.component.html',\n  styleUrls: ['./coordinates.component.scss']\n})\nexport class CoordinatesComponent implements OnInit {\n  @Input() public currentLat: string;\n  @Input() public currentLng: string;\n\n  /**\n   * @constant\n   */\n  public placeHolder = marker('1.1 or 1°6\\'3\"');\n\n  @Output() public moveToCoordinates$: EventEmitter<[number, number]> = new EventEmitter();\n  public coordinatesForm: PointFormGroup;\n  public editionMode = false;\n\n  public ngOnInit(): void {\n    this.coordinatesForm = new PointFormGroup(this.currentLat, this.currentLng);\n  }\n\n  public switchToEditionMode() {\n    this.editionMode = true;\n    this.coordinatesForm.latitude.setValue(this.currentLat);\n    this.coordinatesForm.longitude.setValue(this.currentLng);\n  }\n\n  public moveToCoordinates() {\n    const lat = Coordinate.parse(this.coordinatesForm.latitude.value);\n    const lng = Coordinate.parse(this.coordinatesForm.longitude.value);\n    this.moveToCoordinates$.emit([lng, lat]);\n    this.editionMode = false;\n    this.currentLat = String(lat);\n    this.currentLng = String(lng);\n  }\n\n}\n","<div class=\"current-coordinate\" (click)=\"switchToEditionMode()\" (keyDown)=\"switchToEditionMode()\" [matTooltip]=\"'Enter coordinates and centre the map' | translate\"\n  matTooltipPosition=\"above\" *ngIf=\"!editionMode; else editing\">\n  <span class=\"lat\"> {{ 'Lat:' | translate }} {{ currentLat | number:'1.5-5' }} </span>\n  <span class=\"lng\"> {{ 'Lng:' | translate }} {{ currentLng | number:'1.5-5' }} </span>\n</div>\n<ng-template #editing>\n  <div class=\"current-coordinate-edition\">\n    <div class=\"section\" [formGroup]=\"coordinatesForm\">\n      <mat-form-field appearance=\"outline\">\n        <mat-label>{{'Latitude' | translate}}</mat-label>\n        <input class=\"input\" matInput [formControl]=\"coordinatesForm.latitude\"\n          [placeholder]=\"placeHolder | translate\">\n        <mat-error *ngIf=\"coordinatesForm.latitude.invalid\">{{coordinatesForm.latitude | coordinatesFormError | translate}}\n        </mat-error>\n      </mat-form-field>\n      <div class=\"coordinate\">\n        <mat-form-field appearance=\"outline\">\n          <mat-label>{{'Longitude' | translate}}</mat-label>\n          <input class=\"input\" matInput [formControl]=\"coordinatesForm.longitude\"\n            [placeholder]=\"placeHolder | translate\">\n          <mat-error *ngIf=\"coordinatesForm.longitude.invalid\">{{coordinatesForm.longitude | coordinatesFormError |\n            translate}}</mat-error>\n        </mat-form-field>\n      </div>\n      <button class=\"move\" mat-stroked-button (click)=\"moveToCoordinates()\"\n        [disabled]=\"coordinatesForm.invalid\">\n        <span class=\"label\">{{'Move to' | translate}}</span>\n      </button>\n    </div>\n    <div class=\"exit\" (click)=\"editionMode = false\" (keyDown)=\"editionMode = false\">\n      <mat-icon>clear</mat-icon>\n    </div>\n  </div>\n</ng-template>","/*\n * Licensed to Gisaïa under one or more contributor\n * license agreements. See the NOTICE.txt file distributed with\n * this work for additional information regarding copyright\n * ownership. Gisaïa licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { Component, EventEmitter, Input, OnDestroy, OnInit, Output } from '@angular/core';\nimport { Subject } from 'rxjs/internal/Subject';\nimport { AbstractArlasMapGL } from '../map/AbstractArlasMapGL';\nimport { ArlasMapSource } from '../map/model/sources';\nimport { ArlasBasemaps } from './basemaps.model';\nimport { BasemapService } from './basemap.service';\nimport { BasemapStyle } from './basemap.config';\nimport { ArlasMapFrameworkService } from '../arlas-map-framework.service';\nimport { AbstractArlasMapService } from '../arlas-map.service';\nimport { takeUntil } from 'rxjs';\n\n@Component({\n  selector: 'arlas-basemap',\n  templateUrl: './basemap.component.html',\n  styleUrls: ['./basemap.component.scss']\n})\n/** L: a layer class/interface.\n *  S: a source class/interface.\n *  M: a Map configuration class/interface.\n */\nexport class BasemapComponent<L, S, M>implements OnInit, OnDestroy {\n\n  private readonly _onDestroy$ = new Subject<boolean>();\n\n  @Input() public map: AbstractArlasMapGL;\n  @Input() public mapSources: Array<ArlasMapSource<any>>;\n\n  @Output() public basemapChanged = new EventEmitter<void>();\n  @Output() public blur = new Subject<void>();\n\n  public showList = false;\n  public basemaps: ArlasBasemaps;\n\n  public constructor(protected basemapService: BasemapService<L, S, M>,\n    protected mapService: AbstractArlasMapService<L, S, M>,\n    protected mapFrameworkService: ArlasMapFrameworkService<L, S, M>) {\n\n      this.basemapService.basemapChanged$.pipe(takeUntil(this._onDestroy$)).subscribe(() => this.basemapChanged.emit());\n\n     }\n\n  public ngOnInit(): void {\n    this.initBasemaps();\n  }\n\n  protected initBasemaps() {\n    this.basemaps = this.basemapService.basemaps;\n    if (this.basemaps) {\n      const styles = this.basemaps.styles();\n      if (styles) {\n        this.showList = styles.length > 0;\n        styles.filter(bm => !bm.image).forEach(bm => {\n          if (bm.type !== 'protomap' && !!bm.url) {\n            const splitUrl = bm.url.split('/style.json?key=');\n            if (splitUrl.length === 2) {\n              bm.image = `${splitUrl[0]}/0/0/0.png?key=${splitUrl[1]}`;\n            }\n          }\n        });\n      }\n    }\n  }\n\n  /** Removes the old basemap and set the new one that is given as a parameter\n   * @param newBasemap: Basemap selected by the user\n   */\n  public onChangeBasemap(newBasemap: BasemapStyle) {\n    const selectedBasemap = this.basemaps.getSelected();\n    if (selectedBasemap.type === 'protomap') {\n      this.basemapService.removeProtomapBasemap(this.map);\n    }\n    this.setBaseMapStyle(newBasemap);\n  }\n\n  public setBaseMapStyle(newBasemap: BasemapStyle) {\n    if (this.map) {\n      this.basemapService.setBasemap(this.basemaps.getSelected().styleFile as any, newBasemap, this.map, this.mapSources);\n    }\n  }\n\n  public ngOnDestroy() {\n    this._onDestroy$.next(true);\n    this._onDestroy$.complete();\n  }\n\n}\n","<div *ngIf=\"showList\" class=\"basemap-container\">\n  <ng-container *ngFor=\"let style of basemaps?._styles\">\n    <div *ngIf=\"!style.errored\" class=\"basemap\" [class.selected]=\"style.name === basemaps?._selectedStyle?.name\"\n    (click)=\"onChangeBasemap(style)\" (keyDown)=\"onChangeBasemap(style)\">\n      <div class=\"image\">\n        <img *ngIf=\"!!style?.image && style?.image !== ''\" src=\"{{style?.image}}\" (error)=\"style.image = null\" />\n        <div *ngIf=\"!style?.image || (!!style?.image && style?.image === '')\" class=\"no-image\">\n          <mat-icon>wallpaper</mat-icon>\n        </div>\n        <div class=\"name\">{{style.name | translate}}</div>\n      </div>\n    </div>\n  </ng-container>\n</div>\n","/*\n * Licensed to Gisaïa under one or more contributor\n * license agreements. See the NOTICE.txt file distributed with\n * this work for additional information regarding copyright\n * ownership. Gisaïa licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { HistogramData } from 'arlas-d3/histograms/utils/HistogramUtils';\n\nexport interface LegendData {\n  minValue?: string;\n  maxValue?: string;\n  keysColorsMap?: Map<string, string>;\n}\n\nexport interface Legend {\n  type?: PROPERTY_SELECTOR_SOURCE;\n  title?: string;\n  minValue?: string;\n  maxValue?: string;\n  fixValue?: string | number;\n  interpolatedValues?: Array<string | number>;\n  manualValues?: Map<string, string | number>;\n  visible?: boolean;\n  /** data to be plotted as histogram in the legend */\n  histogram?: Array<HistogramData>;\n}\n\nexport interface CircleLegend extends FillLegend {\n  radius: Legend;\n}\n\nexport interface FillLegend {\n  color: Legend;\n  colorPalette: string;\n  strokeColor: Legend;\n  strokeColorPalette: string;\n}\n\nexport interface HeatmapLegend {\n  color: Legend;\n  colorPalette: string;\n  radius: Legend;\n}\n\nexport interface LabelLegend {\n  color: Legend;\n  colorPalette: string;\n  size: Legend;\n}\n\nexport interface LineLegend {\n  color: Legend;\n  colorPalette: string;\n  dashes: Array<number>;\n  width: Legend;\n}\n\nexport enum PROPERTY_SELECTOR_SOURCE {\n  fix = 'Fix',\n  provided = 'Provided',\n  generated = 'Generated',\n  manual = 'Manual',\n  interpolated = 'Interpolated',\n  metric_on_field = 'Metric on field',\n  heatmap_density = 'Density'\n}\n","\n/*\n * Licensed to Gisaïa under one or more contributor\n * license agreements. See the NOTICE.txt file distributed with\n * this work for additional information regarding copyright\n * ownership. Gisaïa licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { marker } from '@colsen1991/ngx-translate-extract-marker';\n\n\nexport const GET = 'get';\nexport const MATCH = 'match';\nexport const INTERPOLATE = 'interpolate';\nexport const OTHER = marker('other_color');\nexport const IN = 'in';\nexport const NOT_IN = '!';\nexport const HEATMAP_DENSITY = 'Heatmap-density';\n\n","/*\n * Licensed to Gisaïa under one or more contributor\n * license agreements. See the NOTICE.txt file distributed with\n * this work for additional information regarding copyright\n * ownership. Gisaïa licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { HistogramData } from 'arlas-d3/histograms/utils/HistogramUtils';\n\nexport function getMax(data: Array<HistogramData>): number {\n    return Math.max(...data.map(hd => +hd.value));\n}\n\nexport const MAX_CIRLE_RADIUS = 7;\nexport const MAX_LINE_WIDTH = 10;\n","/*\n * Licensed to Gisaïa under one or more contributor\n * license agreements. See the NOTICE.txt file distributed with\n * this work for additional information regarding copyright\n * ownership. Gisaïa licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { Injectable } from '@angular/core';\nimport { CircleLegend, FillLegend, HeatmapLegend, LabelLegend, Legend, LegendData, LineLegend, PROPERTY_SELECTOR_SOURCE } from './legend.config';\nimport { TranslateService } from '@ngx-translate/core';\nimport { HEATMAP_DENSITY, IN, INTERPOLATE, MATCH, NOT_IN, OTHER } from '../map/model/filters';\nimport tinycolor from 'tinycolor2';\nimport { HistogramData } from 'arlas-d3/histograms/utils/HistogramUtils';\nimport { getMax } from './legend.component';\nimport { MAX_CIRLE_RADIUS, MAX_LINE_WIDTH } from './legend.tools';\n\n\n@Injectable({\n  providedIn: 'root'\n})\nexport abstract class LegendService {\n\n  public getCircleLegend(paint: any, visibileMode: boolean, legendData: Map<string, LegendData>, layer: any): CircleLegend {\n    return undefined;\n  }\n\n  public getLineLegend(paint: any, visibileMode: boolean, legendData: Map<string, LegendData>, layer: any): LineLegend {\n    return undefined;\n  }\n\n  public getFillLegend(paint: any, visibileMode: boolean, legendData: Map<string, LegendData>, layer: any): FillLegend {\n    return undefined;\n  }\n\n  public getHeatmapLegend(paint: any, visibileMode: boolean, legendData: Map<string, LegendData>, layer: any): HeatmapLegend {\n    return undefined;\n  }\n\n  public getLabelLegend(paint: any, visibileMode: boolean, legendData: Map<string, LegendData>, layer: any): LabelLegend {\n    return undefined;\n  }\n\n  public static setProvidedColorLegend(colorLegend: Legend, field: string,\n    legendData: Map<string, LegendData>, filter, translate: TranslateService) {\n    colorLegend.title = field;\n    if (!Array.isArray(field)) {\n      colorLegend.type = PROPERTY_SELECTOR_SOURCE.provided;\n      if (field.endsWith('_arlas__color')) {\n        colorLegend.type = PROPERTY_SELECTOR_SOURCE.generated;\n      }\n      colorLegend.manualValues = new Map();\n      if (legendData?.get(field)) {\n        const keysToColors = legendData.get(field).keysColorsMap;\n        const colorList = Array.from(keysToColors.keys()).map(k => [k, keysToColors.get(k)]).flat();\n        for (let i = 0; i < colorList.length; i += 2) {\n          colorLegend.manualValues.set(translate ? translate.instant(colorList[i]) : colorList[i], colorList[i + 1]);\n        }\n        if (colorList.length === 0) {\n          colorLegend.manualValues.set('', '#eee');\n        }\n      } else {\n        colorLegend.manualValues.set('', '#eee');\n      }\n      if (filter) {\n        LegendService.filterLegend(colorLegend.manualValues, filter,\n          (field).endsWith('_arlas__color') ? (field).slice(0, -13) : field);\n      }\n    }\n  }\n\n\n  public static setMatchColorLegend(colorLegend: Legend, colorExpression: any[], legendData: Map<string, LegendData>,\n    filter, translate: TranslateService) {\n    /** color = [\"match\", [\"get\", \"field\"], .... ]**/\n    colorLegend.type = PROPERTY_SELECTOR_SOURCE.manual;\n    const colorsLength = colorExpression.length;\n    let hasDefaultColor = false;\n    if (colorsLength % 2 !== 0) {\n      hasDefaultColor = true;\n    }\n    const field = colorExpression[1].length === 2 ? colorExpression[1][1] : '';\n    colorLegend.title = field;\n    colorLegend.manualValues = new Map();\n    let keysToColors: Map<string, string>;\n    if (legendData?.get(field + '_color')) {\n      // If there is a legendData, use only the colors in the keysToColors\n      keysToColors = legendData.get(field + '_color').keysColorsMap;\n    } else {\n      // If no legendData for this field, use all the colors of colorExpression\n      keysToColors = new Map();\n      for (let i = 2; i < colorExpression.length; i += 2) {\n        if (hasDefaultColor && i === colorsLength - 3) {\n          keysToColors.set(colorExpression[i] + '', colorExpression[i + 1]);\n          keysToColors.set(OTHER, colorExpression[i + 2]);\n          break;\n        } else {\n          keysToColors.set(colorExpression[i] + '', colorExpression[i + 1]);\n        }\n      }\n    }\n    for (let i = 2; i < colorExpression.length; i += 2) {\n      if (hasDefaultColor && i === colorsLength - 3) {\n        if (keysToColors.has(colorExpression[i] + '')) {\n          colorLegend.manualValues.set(translate ? translate.instant(colorExpression[i] + '') : colorExpression[i],\n            colorExpression[i + 1]);\n        }\n        colorLegend.manualValues.set(translate ? translate.instant(OTHER) : OTHER, colorExpression[i + 2]);\n        break;\n      } else if (keysToColors.has(colorExpression[i] + '')) {\n        colorLegend.manualValues.set(translate ? translate.instant(colorExpression[i] + '') : colorExpression[i],\n          colorExpression[i + 1]);\n      }\n    }\n\n    if (filter) {\n      LegendService.filterLegend(colorLegend.manualValues, filter, field);\n    }\n  }\n\n\n  public static setInterpolatedColorLegend(colorLegend: Legend, colorExpression: any[],\n    legendData: Map<string, LegendData>,\n    visibleMode: boolean) {\n    colorLegend.type = PROPERTY_SELECTOR_SOURCE.interpolated;\n    /** color = [\"interplate\", ['linear'], [\"get\", \"field\"], 0, 1... ]**/\n    // todo throw exception if interpolation is not linear\n    const field = colorExpression[2].length === 2 ? colorExpression[2][1] : HEATMAP_DENSITY;\n    colorLegend.title = field;\n    colorLegend.interpolatedValues = [];\n    const palette = [];\n    const colors = colorExpression.slice(3);\n    colors.forEach((c, i) => {\n      if (i % 2 === 0) {\n        palette.push({\n          proportion: c,\n          value: colors[i + 1]\n        });\n      }\n    });\n    const minimum = palette[0].proportion;\n    const maximum = palette.slice(-1)[0].proportion;\n    palette.forEach(c => colorLegend.interpolatedValues.push(c.value));\n    const colorValues = colorExpression.filter((c, i) => i > 2 && i % 2 !== 0);\n    if (legendData?.get(field) && field !== 'count') {\n      colorLegend.minValue = legendData.get(field).minValue;\n      colorLegend.maxValue = legendData.get(field).maxValue;\n      // For heatmaps, the count is used to fetch data, so we use it for the legend\n    } else if (field === HEATMAP_DENSITY && legendData?.get('count')) {\n      colorLegend.minValue = legendData.get('count').minValue;\n      colorLegend.maxValue = legendData.get('count').maxValue;\n    } else {\n      colorLegend.minValue = colorValues[0] + '';\n      colorLegend.maxValue = colorValues[colorValues.length - 1] + '';\n    }\n    if (!visibleMode) {\n      /** apply greyscale because the layer is not visible */\n      colorLegend.interpolatedValues = colorLegend.interpolatedValues\n        .map((c) => tinycolor(c.toString()).greyscale().lighten(20).toHexString());\n      palette.forEach(p => {\n        p.value = tinycolor(p.value.toString()).greyscale().lighten(20).toHexString();\n      });\n    }\n    return palette.map(c => c.value + ' ' + (100 * (c.proportion - minimum) / (maximum - minimum)) + '%').join(',');\n\n  }\n\n  public static filterLegend(colorLegendValues: Map<string, string | number>, filter: any[], field: string) {\n    filter.forEach((f, idx) => {\n      if (idx !== 0 && idx !== filter.length - 1) {\n        switch (f[0]) {\n          case IN: {\n            if (f[1][1] === field) {\n              const valuesToKeep: Array<string> = f[2][1];\n              colorLegendValues.forEach((val, key) => {\n                if (!(valuesToKeep.includes(key))) {\n                  colorLegendValues.delete(key);\n                }\n              });\n            }\n            break;\n          }\n          case NOT_IN: {\n            if (f[1][0] === IN && f[1][1][1] === field) {\n              const valuesToExclude: Array<string> = f[1][2][1];\n              valuesToExclude.forEach(value => {\n                colorLegendValues.delete(value);\n              });\n            }\n            break;\n          }\n        }\n      }\n    });\n  }\n\n  public static buildColorLegend(colorExpression: string | any, visibleMode: boolean, legendData: Map<string, LegendData>,\n    filter?: any, translate?: TranslateService): [Legend, string] {\n    const colorLegend: Legend = { visible: true };\n    let colorPalette = '';\n    if (typeof colorExpression === 'string') {\n      colorLegend.type = PROPERTY_SELECTOR_SOURCE.fix;\n      colorLegend.fixValue = colorExpression;\n    } else if (Array.isArray(colorExpression)) {\n      if (colorExpression.length === 2) {\n        /** color = [\"get\", \"field\"]  ==> Generated or Provided */\n        const field = colorExpression[1];\n        colorLegend.title = field;\n        LegendService.setProvidedColorLegend(colorLegend, field, legendData, filter, translate);\n      } else if (colorExpression.length >= 3) {\n        if (colorExpression[0] === MATCH) {\n          LegendService.setMatchColorLegend(colorLegend, colorExpression, legendData, filter, translate);\n        } else if (colorExpression[0] === INTERPOLATE) {\n          colorPalette = LegendService.setInterpolatedColorLegend(colorLegend, colorExpression, legendData, visibleMode);\n        }\n      }\n    }\n\n    colorLegend.visible = visibleMode;\n    return [colorLegend, colorPalette];\n  };\n\n  public static buildRadiusLegend(radiusExpression: string | any, legendData: Map<string, LegendData>): Legend {\n    const radiusLegend: Legend = {};\n    const circleRadiusEvolution: Array<HistogramData> = new Array();\n    if (Array.isArray(radiusExpression)) {\n      if (radiusExpression.length >= 3) {\n        // Filter out the zoom-dependent radius layers (circle-heatmap)\n        if (radiusExpression[0] === INTERPOLATE && radiusExpression[2].length > 1) {\n          const field = radiusExpression[2][1];\n          radiusExpression.filter((w, i) => i >= 3).forEach((w, i) => {\n            if (i % 2 === 0) {\n              circleRadiusEvolution.push({ key: w, value: radiusExpression[i + 1 + 3] });\n            }\n          });\n          radiusLegend.title = field;\n          if (legendData?.get(field)) {\n            radiusLegend.minValue = legendData.get(field).minValue;\n            radiusLegend.maxValue = legendData.get(field).maxValue;\n          } else {\n            radiusLegend.minValue = circleRadiusEvolution[0].key + '';\n            radiusLegend.maxValue = circleRadiusEvolution[circleRadiusEvolution.length - 1].key + '';\n          }\n          radiusLegend.type = PROPERTY_SELECTOR_SOURCE.interpolated;\n          const maxCircleRadius = getMax(circleRadiusEvolution);\n          if (maxCircleRadius > MAX_CIRLE_RADIUS) {\n            circleRadiusEvolution.forEach(lw => lw.value = lw.value * MAX_CIRLE_RADIUS / maxCircleRadius);\n          }\n          radiusLegend.histogram = circleRadiusEvolution;\n        }\n      }\n    }\n    return radiusLegend;\n\n  };\n\n  protected static buildWidthLegend(lineWidth: number | any,\n    legendData: Map<string, LegendData>): Legend {\n    /** if the line width is fix then it is not added to the legend*/\n    const widthLegend: Legend = {};\n    if (Array.isArray(lineWidth)) {\n      if (lineWidth.length >= 3) {\n        if (lineWidth[0] === INTERPOLATE) {\n          const field = lineWidth[2][1];\n          widthLegend.title = field;\n          if (legendData?.get(field)) {\n            widthLegend.minValue = legendData.get(field).minValue;\n            widthLegend.maxValue = legendData.get(field).maxValue;\n          }\n          widthLegend.type = PROPERTY_SELECTOR_SOURCE.interpolated;\n          const lineWidthEvolution: Array<HistogramData> = new Array();\n          lineWidth.filter((w, i) => i >= 3).forEach((w, i) => {\n            if (i % 2 === 0) {\n              lineWidthEvolution.push({ key: w, value: lineWidth[i + 1 + 3] });\n            }\n          });\n          const maxLineWidth = getMax(lineWidthEvolution);\n          if (maxLineWidth > MAX_LINE_WIDTH) {\n            lineWidthEvolution.forEach(lw => lw.value = lw.value * MAX_LINE_WIDTH / maxLineWidth);\n          }\n          widthLegend.histogram = lineWidthEvolution;\n        }\n      }\n    }\n    return widthLegend;\n  }\n\n}\n","/*\n * Licensed to Gisaïa under one or more contributor\n * license agreements. See the NOTICE.txt file distributed with\n * this work for additional information regarding copyright\n * ownership. Gisaïa licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { Component, ViewChild, ElementRef, Input, AfterViewInit, SimpleChanges, OnChanges } from '@angular/core';\nimport { select } from 'd3-selection';\nimport { Legend, PROPERTY_SELECTOR_SOURCE } from '../legend.config';\n\n@Component({\n  selector: 'arlas-layer-icon',\n  templateUrl: './layer-icon.component.html',\n  styleUrls: ['./layer-icon.component.scss']\n})\nexport class LayerIconComponent implements AfterViewInit, OnChanges {\n  @Input() public layer: any;\n  @Input() public colorLegend: Legend = {};\n  @Input() public strokeColorLegend: Legend = {};\n  @Input() public widthLegend: Legend = {};\n  @Input() public radiusLegend: Legend = {};\n  @Input() public lineDasharray: Array<number>;\n  @ViewChild('layer_icon', { read: ElementRef, static: false }) public layerIconElement: ElementRef;\n\n  public constructor() {\n  }\n\n  public ngAfterViewInit() {\n    if (this.layer) {\n      this.drawIcons();\n    }\n  }\n\n  public ngOnChanges(changes: SimpleChanges) {\n    if (changes['layer'] !== undefined) {\n      if (this.layer && this.layerIconElement) {\n        this.drawIcons();\n      }\n    }\n  }\n\n  private drawIcons(): void {\n    const type = this.layer.type;\n    const source: string = this.layer.source as string;\n    switch (type) {\n      case 'circle':\n      case 'circle-heatmap': {\n        if (source.startsWith('feature-metric')) {\n          drawFeatureCircleIcon(this.layerIconElement.nativeElement, this.colorLegend, this.strokeColorLegend, true);\n        } else if (source.startsWith('feature')) {\n          drawFeatureCircleIcon(this.layerIconElement.nativeElement, this.colorLegend, this.strokeColorLegend);\n        } else if (source.startsWith('cluster')) {\n          const addBlur = type === 'circle-heatmap';\n          drawClusterCircleIcon(this.layerIconElement.nativeElement, this.colorLegend, this.strokeColorLegend, addBlur);\n        }\n        break;\n      }\n      case 'line': {\n        if (source.startsWith('feature-metric')) {\n          drawLineIcon(this.layerIconElement.nativeElement, this.colorLegend, this.lineDasharray, true);\n        } else {\n          drawLineIcon(this.layerIconElement.nativeElement, this.colorLegend, this.lineDasharray);\n        }\n        break;\n      }\n      case 'fill': {\n        if (source.startsWith('cluster')) {\n          drawClusterFillIcon(this.layerIconElement.nativeElement, this.colorLegend, this.strokeColorLegend);\n        } else if (source.startsWith('feature-metric')) {\n          drawFeatureFillIcon(this.layerIconElement.nativeElement, this.colorLegend, this.strokeColorLegend, true);\n        } else {\n          drawFeatureFillIcon(this.layerIconElement.nativeElement, this.colorLegend, this.strokeColorLegend);\n        }\n        break;\n      }\n      case 'heatmap': {\n        drawHeatmapIcon(this.layerIconElement.nativeElement, this.colorLegend, this.layer.source.toString().startsWith('feature-metric'));\n        break;\n      }\n      case 'symbol': {\n        const l: any = (this.layer.layout);\n        if (l['text-field']) {\n          drawTextIcon(this.layerIconElement.nativeElement, this.colorLegend);\n        }\n      }\n    }\n  }\n\n}\n\n/**\n * Draws the rectangles icon for cluster mode\n * @param svgNode SVG element on which we append the rectangles using d3.\n * @param colorLegend Color legend, to give the drawn icons rectangles the same color on the map\n * @param strokeColorLegend Color legend, to give the drawn icons rectangles the same stroke color on the map\n */\nexport function drawClusterFillIcon(svgNode: SVGElement, colorLegend: Legend, strokeColorLegend: Legend) {\n  const fillFourColors = getClusterFillColors(colorLegend);\n  let strokeFourColors = fillFourColors;\n  if (strokeColorLegend) {\n    strokeFourColors = getClusterFillColors(strokeColorLegend);\n  }\n  const svg = select(svgNode);\n  svg.selectAll('g').remove();\n  svg.append('g').append('rect')\n    .attr('height', 7).attr('width', 7)\n    .attr('fill', fillFourColors[0]).attr('fill-opacity', 0.8)\n    .attr('stroke', strokeFourColors[0]).attr('stroke-width', 0.6)\n    .attr('y', 3).attr('x', 3);\n  svg.append('g').append('rect')\n    .attr('height', 7).attr('width', 7)\n    .attr('fill', fillFourColors[1]).attr('fill-opacity', 0.6)\n    .attr('stroke', strokeFourColors[1]).attr('stroke-width', 0.6)\n    .attr('y', 10).attr('x', 3);\n  svg.append('g').append('rect')\n    .attr('height', 7).attr('width', 7)\n    .attr('fill', fillFourColors[2]).attr('fill-opacity', 0.6)\n    .attr('stroke', strokeFourColors[2]).attr('stroke-width', 0.6)\n    .attr('y', 10).attr('x', 10);\n  svg.append('g').append('rect')\n    .attr('height', 7).attr('width', 7)\n    .attr('fill', fillFourColors[3]).attr('fill-opacity', 0.6)\n    .attr('stroke', strokeFourColors[3]).attr('stroke-width', 0.6)\n    .attr('y', 3).attr('x', 10);\n}\n\n/**\n * Draws the rectangles icon for feature and feature-metric modes\n * @param svgNode SVG element on which we append the rectangles using d3.\n * @param colorLegend Color legend, to give the drawn icons rectangles the same color on the map\n * @param strokeColorLegend Color legend, to give the drawn icons rectangles the same stroke color on the map\n * @param [isMetric=false] Whether the layer depends on a metric\n */\nexport function drawFeatureFillIcon(svgNode: SVGElement, colorLegend: Legend, strokeColorLegend: Legend, isMetric = false) {\n  const fillColor = getOneColor(colorLegend);\n  let strokeColor = fillColor;\n  if (strokeColorLegend) {\n    strokeColor = getOneColor(strokeColorLegend);\n  }\n  const polygon = [\n    { 'x': 0, 'y': 2 },\n    { 'x': 18, 'y': 2 },\n    { 'x': 13, 'y': 18 },\n    { 'x': 1, 'y': 18 },\n    { 'x': 8, 'y': 9 },\n    { 'x': 0, 'y': 2 }];\n  const svg = select(svgNode);\n  svg.selectAll('g').remove();\n  svg.append('g').selectAll('polygon')\n    .data([polygon])\n    .enter().append('polygon')\n    .attr('points', (d) => d.map(d => [d.x, d.y].join(',')).join(' ')).attr('fill', fillColor)\n    .attr('fill-opacity', 0.5)\n    .attr('stroke', strokeColor)\n    .attr('stroke-width', 0.9);\n  if (isMetric) {\n    svg.append('g').append('text').text('∑')\n      .attr('x', 14).attr('y', 14).attr('font-size', '0.5em').attr('font-weight', 'bold').attr('fill', colorLegend.fixValue);\n  }\n}\n\n\nexport function getOneColor(legend: Legend): string {\n  let color = '';\n  if (legend.type === PROPERTY_SELECTOR_SOURCE.interpolated) {\n    const iv = legend.interpolatedValues;\n    color = iv[0] + '';\n  } else if (legend.type === PROPERTY_SELECTOR_SOURCE.fix) {\n    color = legend.fixValue + '';\n  } else if (legend.type === PROPERTY_SELECTOR_SOURCE.manual || legend.type === PROPERTY_SELECTOR_SOURCE.generated\n    || legend.type === PROPERTY_SELECTOR_SOURCE.provided) {\n    const mv = legend.manualValues as Map<string, string>;\n    color = mv.values().next().value;\n  }\n  return color;\n}\n\n\nexport function drawTextIcon(svgNode: SVGElement, colorLegend: Legend) {\n  const svg = select(svgNode);\n  svg.selectAll('g').remove();\n  svg.append('g').append('text').text(' T ').attr('transform', ' translate(5 0)')\n    .attr('y', 14).attr('font-size', '0.9em').attr('font-family', 'Garamond').attr('fill', colorLegend.fixValue);\n}\n\n/**\n * draws the heatmap icon for cluster mode\n * @param svgNode SVG element on which we append the heamap circles using d3.\n * @param colorLegend Color legend, to give the drawn icons circles the same color on the map\n * @param small Whether to create a small version of the icon\n */\nexport function drawHeatmapIcon(svgNode: SVGElement, colorLegend: Legend, small: boolean) {\n  const heatmapColors = [];\n  if (colorLegend.type === PROPERTY_SELECTOR_SOURCE.interpolated) {\n    const iv = colorLegend.interpolatedValues;\n    if (iv) {\n      if (iv.length === 1) {\n        heatmapColors.push(iv[0], iv[0], iv[0]);\n      } else if (iv.length === 2) {\n        heatmapColors.push(iv[0], iv[0], iv[1]);\n      } else if (iv.length === 3) {\n        heatmapColors.push(iv[1], iv[Math.trunc(iv.length / 2)], iv[iv.length - 1]);\n      } else if (iv.length >= 4) {\n        heatmapColors.push(iv[1], iv[Math.trunc(iv.length / 3)], iv[Math.trunc(2 * iv.length / 3)], iv[iv.length - 1]);\n      }\n    }\n  }\n  const svg = select(svgNode);\n  svg.selectAll('defs').remove();\n  svg.append('defs')\n    .append('filter').attr('id', 'blur')\n    .append('feGaussianBlur').attr('stdDeviation', 0.8);\n  if (small) {\n    svg.selectAll('g').remove();\n    svg.append('g')\n      .append('circle')\n      .attr('cx', 10).attr('cy', 10)\n      .attr('r', 7)\n      .style('fill', heatmapColors[0])\n      .attr('filter', 'url(#blur)');\n  } else {\n    svg.selectAll('circle').remove();\n    svg.selectAll('circle')\n      .data(heatmapColors).enter()\n      .append('circle')\n      .attr('cx', 10).attr('cy', 10)\n      .attr('r', (d, i) => {\n        if (i === 0) {\n          return 10;\n        }\n        if (i === 1) {\n          return 8;\n        }\n        if (i === 2) {\n          return 6;\n        }\n        if (i === 3) {\n          return 3;\n        }\n      })\n      .style('fill', (d, i) => d)\n      .attr('filter', 'url(#blur)');\n  }\n}\n\n/**\n * Draws the line icon for feature mode\n * @param svgNode SVG element on which we append the line using d3.\n * @param colorLegend Color legend, to give the drawn icons line the same color on the map\n * @param dashArray Array representing the dash pattern\n * @param [isMetric=false] Whether the layer depends on a metric\n */\nexport function drawLineIcon(svgNode: SVGElement, colorLegend: Legend, dashArray: Array<number>, isMetric = false) {\n  let lineColor = '';\n  if (colorLegend.type === PROPERTY_SELECTOR_SOURCE.fix) {\n    lineColor = colorLegend.fixValue + '';\n  } else if (colorLegend.type === PROPERTY_SELECTOR_SOURCE.interpolated) {\n    const iv = colorLegend.interpolatedValues;\n    if (iv) {\n      lineColor = iv[0] + '';\n    } else {\n      lineColor = '#2da4ff';\n    }\n  } else if (colorLegend.type === PROPERTY_SELECTOR_SOURCE.manual || colorLegend.type === PROPERTY_SELECTOR_SOURCE.generated\n    || colorLegend.type === PROPERTY_SELECTOR_SOURCE.provided) {\n    const mv = colorLegend.manualValues as Map<string, string>;\n    lineColor = mv.values().next().value;\n  }\n  let svgDashArray = '0';\n  if (!!dashArray && dashArray.length > 1) {\n    const joinedDashArray = dashArray.join(',');\n    if (joinedDashArray === '2,5') {\n      svgDashArray = '0, 2, 3';\n    } else if (joinedDashArray === '0.1,5') {\n      svgDashArray = '1,2.5';\n    } else {\n      svgDashArray = '4,2,1';\n    }\n  }\n  const svg = select(svgNode);\n  svg.selectAll('g').remove();\n  svg.append('g').append('line')\n    .attr('x1', 0).attr('y1', 18)\n    .attr('x2', 6).attr('y2', 10)\n    .attr('cx', 2).attr('cy', 2)\n    .attr('stroke', lineColor).attr('stroke-width', 1.5).attr('stroke-dasharray', svgDashArray);\n  svg.append('g').append('line')\n    .attr('x1', 6).attr('y1', 10)\n    .attr('x2', 12).attr('y2', 4)\n    .attr('cx', 2).attr('cy', 2)\n    .attr('stroke', lineColor).attr('stroke-width', 1.5).attr('stroke-dasharray', svgDashArray);\n  svg.append('g').append('line')\n    .attr('x1', 12).attr('y1', 4)\n    .attr('x2', 18).attr('y2', 0)\n    .attr('cx', 2).attr('cy', 2)\n    .attr('stroke', lineColor).attr('stroke-width', 1.5).attr('stroke-dasharray', svgDashArray);\n  if (isMetric) {\n    svg.append('g').append('text').text('∑')\n      .attr('x', 10).attr('y', 16).attr('font-size', '0.5em').attr('font-weight', 'bold').attr('fill', colorLegend.fixValue);\n  }\n}\n\n/**\n * Draws the circle icon for feature mode\n * @param svgNode SVG element on which we append the circles using d3.\n * @param colorLegend Color legend, to give the drawn icons circles the same color on the map\n * @param strokeColorLegend Color legend, to give the drawn icons circles the same stroke color on the map\n * @param [isMetric=false] Whether the layer depends on a metric\n */\nexport function drawFeatureCircleIcon(svgNode: SVGElement, colorLegend: Legend, strokeColorLegend: Legend, isMetric = false) {\n  const colorsList = [];\n  const strokeColorsList = [];\n  populateListFromLegend(colorsList, colorLegend);\n  populateListFromLegend(strokeColorsList, strokeColorLegend);\n\n  const svg = select(svgNode);\n  svg.selectAll('circle').remove();\n  svg.selectAll('g').remove();\n  svg.selectAll('circle')\n    .data(colorsList).enter()\n    .append('circle')\n    .attr('cx', (d, i) => {\n      if (colorsList.length === 1) {\n        return 10;\n      } else {\n        if (i === 0) {\n          return 6;\n        }\n        if (i === 1) {\n          return 12;\n        }\n        if (i === 2) {\n          return 5;\n        }\n      }\n    })\n    .attr('cy', (d, i) => {\n      if (colorsList.length === 1) {\n        return 10;\n      } else {\n        if (i === 0) {\n          return 5;\n        }\n        if (i === 1) {\n          return 10;\n        }\n        if (i === 2) {\n          return 15;\n        }\n      }\n    })\n    .attr('r', (d, i) => {\n      if (colorsList.length === 1) {\n        return 7;\n      } else {\n        return 3;\n      }\n    })\n    .style('fill', (d, i) => d).style('fill-opacity', colorsList.length === 1 ? 0.6 : 0.8)\n    .style('stroke', (d, i) => strokeColorsList[i]).style('stroke-width', 0.5);\n\n  if (isMetric) {\n    svg.append('g').append('text').text('∑')\n      .attr('x', 10).attr('y', 16).attr('font-size', '0.5em').attr('font-weight', 'bold').attr('fill', colorLegend.fixValue);\n  }\n}\n\n\n/**\n * draws the circle icon for cluster mode\n * @param svgNode SVG element on which we append the circles using d3.\n * @param colorLegend Color legend, to give the drawn icons circles the same color on the map\n * @param strokeColorLegend Color legend, to give the drawn icons circles the same stroke color on the map\n * @param addBlur Whether to add blur to the drawn circles\n */\nexport function drawClusterCircleIcon(svgNode: SVGElement, colorLegend: Legend, strokeColorLegend: Legend, addBlur = false) {\n  // todo include radius legend in drawing icons\n  const colorsList = [];\n  const strokeColorsList = [];\n  populateListFromLegend(colorsList, colorLegend);\n  populateListFromLegend(strokeColorsList, strokeColorLegend);\n  const svg = select(svgNode);\n  svg.selectAll('circle').remove();\n  svg.append('defs')\n    .append('filter')\n    .attr('id', 'blurHeatmapCircle')\n    .attr('x', '-10%')\n    .attr('y', '-40%')\n    .attr('width', '160%')\n    .attr('height', '160%')\n    .append('feGaussianBlur').attr('stdDeviation', 1.9);\n  svg.selectAll('circle')\n    .data(colorsList).enter()\n    .append('circle')\n    .attr('cx', (d, i) => {\n      if (i === 0) {\n        return 12;\n      }\n      if (i === 1) {\n        return 6;\n      }\n      if (i === 2) {\n        return 10;\n      }\n    })\n    .attr('cy', (d, i) => {\n      if (i === 0) {\n        return 7;\n      }\n      if (i === 1) {\n        return 11;\n      }\n      if (i === 2) {\n        return 15;\n      }\n    })\n    .attr('r', (d, i) => {\n      if (i === 0) {\n        return 6;\n      }\n      if (i === 1) {\n        return 5;\n      }\n      if (i === 2) {\n        return 3;\n      }\n    })\n    .style('fill', (d, i) => d).style('fill-opacity', 0.7)\n    .style('stroke', (d, i) => strokeColorsList[i]).style('stroke-width', 0.8);\n\n  if (addBlur) {\n    svg.selectAll('circle').attr('filter', 'url(#blurHeatmapCircle)');\n  }\n\n}\n\n\nexport function populateListFromLegend(list: Array<string | number>, legend: Legend) {\n  if (legend.type === PROPERTY_SELECTOR_SOURCE.fix) {\n    list.push(legend.fixValue);\n    list.push(legend.fixValue);\n    list.push(legend.fixValue);\n  } else if (legend.type === PROPERTY_SELECTOR_SOURCE.interpolated) {\n    const iv = legend.interpolatedValues;\n    if (iv?.length === 1) {\n      list.push(iv[0], iv[0], iv[0]);\n    } else if (iv.length === 2) {\n      list.push(iv[0], iv[0], iv[1]);\n    } else if (iv.length >= 3) {\n      list.push(iv[0], iv[Math.trunc(iv.length / 2)], iv[iv.length - 1]);\n    }\n  } else if (legend.type === PROPERTY_SELECTOR_SOURCE.manual || legend.type === PROPERTY_SELECTOR_SOURCE.generated\n    || legend.type === PROPERTY_SELECTOR_SOURCE.provided) {\n    const iv = legend.manualValues as Map<string, string>;\n    if (iv) {\n      if (iv.size === 1) {\n        const color = iv.values().next().value;\n        list.push(color, color, color);\n      } else if (iv.size === 2) {\n        list.push(Array.from(iv.values())[0], Array.from(iv.values())[0], Array.from(iv.values())[1]);\n      } else if (iv.size >= 3) {\n        list.push(Array.from(iv.values())[0], Array.from(iv.values())[Math.trunc(Array.from(iv.keys()).length / 2)],\n          Array.from(iv.values())[Array.from(iv.keys()).length - 1]);\n      }\n    } else if (!iv || iv.size === 0) {\n      list.push('#eee', '#eee', '#eee');\n    }\n  }\n}\n\nexport function getClusterFillColors(colorLegend: Legend): string[] {\n  const fourColors = [];\n  if (colorLegend.type === PROPERTY_SELECTOR_SOURCE.interpolated) {\n    const iv = colorLegend.interpolatedValues;\n    if (iv) {\n      if (iv.length === 1) {\n        for (let i = 0; i < 4; i++) {\n          fourColors.push(iv[0]);\n        }\n      } else if (iv.length === 2) {\n        fourColors.push(iv[0]);\n        fourColors.push(iv[1]);\n        fourColors.push(iv[0]);\n        fourColors.push(iv[1]);\n      } else if (iv.length >= 3) {\n        fourColors.push(iv[0]);\n        fourColors.push(iv[Math.trunc(2 * iv.length / 3)]);\n        fourColors.push(iv[iv.length - 1]);\n        fourColors.push(iv[Math.trunc(iv.length / 3)]);\n      }\n    }\n  } else if (colorLegend.type === PROPERTY_SELECTOR_SOURCE.fix) {\n    const c = colorLegend.fixValue;\n    fourColors.push(c, c, c, c);\n  }\n  return fourColors;\n}\n","<div class=\"legend-icon\">\n  <svg #layer_icon class=\"legend-icon__svg\"></svg>\n</div>\n","/*\n * Licensed to Gisaïa under one or more contributor\n * license agreements. See the NOTICE.txt file distributed with\n * this work for additional information regarding copyright\n * ownership. Gisaïa licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { Pipe, PipeTransform } from '@angular/core';\nimport { marker } from '@colsen1991/ngx-translate-extract-marker';\nimport { CollectionService } from 'arlas-web-components';\n\nexport interface LegendParamsResult {\n  translateKey: string;\n  field?: string;\n  normalized?: string;\n  normalizedKey?: string;\n  metric?: string;\n  format: ParamsResultType;\n}\n\n/**\n * full :\n *  return all interpolated values to construct a title legend\n *  ex: Average of boats (normalized)\n * metricField :\n *  return metric and field interpolated values.\n *  ex: Average of boats\n * metricNormalised :\n *   return metric and normalized interpolated values.\n *   ex: count (normalized)\n * noMetric :\n *   return field and normalized interpolated values.\n *   ex: Boat visibility (normalized)\n * original\n *   return the original key to be translated. This case appear only if we fail\n *   to parse of if we have an error.\n */\nexport type  ParamsResultType = 'full' | 'metricField' | 'metricNormalised' | 'noMetric' | 'original';\n\n@Pipe({\n  name: 'formatLegend'\n})\nexport class FormatLegendPipe implements PipeTransform {\n\n  public constructor(private readonly collectionService: CollectionService) {\n  }\n  private readonly metrics: string[] = [\n    'avg',\n    'sum',\n    'min',\n    'max',\n    'cardinality',\n    'count'\n  ];\n\n  public transform(field: string): LegendParamsResult | null {\n    let params: LegendParamsResult = {\n      translateKey: this.collectionService.getDisplayFieldName(field),\n      format: 'original'\n    };\n\n    if (!field) {\n      return null;\n    }\n\n    const parts = field.split(':');\n    // Regular normalized\n    const containsNormalizedPartOrMetric = parts.length === 2\n      // Normalized by key\n      || parts.length === 3\n      // Metric\n      || (parts.length === 1 && this.containsMetrics(parts[0]));\n\n    if (containsNormalizedPartOrMetric) {\n      const valueSplit = parts[0].split('_');\n      if (valueSplit.length === 0) {\n        return params;\n      }\n\n      const hasExtraEmptyValue = valueSplit[valueSplit.length - 1] === '';\n      if (hasExtraEmptyValue) {\n        valueSplit.splice(valueSplit.length - 1, 1);\n      }\n\n      const metric = this.getMetric(valueSplit);\n      const field = this.getField(valueSplit);\n      const normalized = parts[1] ?? '';\n      const normalizedKey =  parts[2] ?? '';\n      params = this.buildInterpolatedParams(params, metric, field, normalized, normalizedKey);\n    } else if (parts[0].endsWith('_arlas__color')){\n      params.translateKey = this.collectionService.getDisplayFieldName(params.translateKey.replace('_arlas__color', ''));\n    }\n\n    return params;\n  }\n\n  public buildInterpolatedParams(params: LegendParamsResult, metric: string, field: string,\n      normalized: string, normalizedKey: string): LegendParamsResult {\n    const legendParams: LegendParamsResult = {\n      ...params,\n      field: this.collectionService.getDisplayFieldName(field),\n      normalized: '',\n      metric,\n    };\n\n    if (!metric) {\n      legendParams.format = 'noMetric';\n      legendParams.translateKey = marker('legend without metric');\n    } else if (field && normalized) {\n      legendParams.format = 'full';\n      legendParams.translateKey = marker('legend');\n    } else if (field) {\n      legendParams.format = 'metricField';\n      legendParams.translateKey =  marker('legend without normalized');\n    } else if (normalized) {\n      legendParams.format = 'metricNormalised';\n      legendParams.translateKey =  marker('legend without field');\n    }\n\n    if (normalized) {\n      if (normalizedKey) {\n        legendParams.normalized = marker('normalized by key');\n        legendParams.normalizedKey = normalizedKey;\n      } else {\n        legendParams.normalized = marker('normalized');\n      }\n    }\n\n    return legendParams;\n  }\n\n  public getMetric(valueSplit: string[]) {\n    if (this.isMetrics(valueSplit[valueSplit.length - 1])) {\n      return valueSplit[valueSplit.length - 1];\n    }\n  }\n\n  public getField(valueSplit: string[]) {\n    // If last split is a metric, then exclude it\n    if (this.isMetrics(valueSplit[valueSplit.length - 1])) {\n      return valueSplit.slice(0, valueSplit.length - 1).join('_');\n    }\n    return valueSplit.join('_');\n  }\n\n  public isMetrics(metrics: string) {\n    return this.metrics.includes(metrics);\n  }\n\n  public containsMetrics(value: string) {\n    for (const metric of this.metrics) {\n      if (value.includes(metric)) {\n        return true;\n      }\n    }\n  }\n\n}\n","/*\n * Licensed to Gisaïa under one or more contributor\n * license agreements. See the NOTICE.txt file distributed with\n * this work for additional information regarding copyright\n * ownership. Gisaïa licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { Component, ElementRef, Input, ViewChild } from '@angular/core';\nimport { Legend, PROPERTY_SELECTOR_SOURCE } from '../legend.config';\n\n@Component({\n  selector: 'arlas-legend-item',\n  templateUrl: './legend-item.component.html',\n  styleUrls: ['./legend-item.component.scss']\n})\nexport class LegendItemComponent {\n  @Input() public legend: Legend;\n  @Input() public title: string;\n  @Input() public layer: any;\n  @Input() public colorPalette: string;\n  @ViewChild('interpolated_svg', { read: ElementRef, static: false }) public interpolatedElement: ElementRef;\n\n  protected PROPERTY_SELECTOR_SOURCE = PROPERTY_SELECTOR_SOURCE;\n\n  public constructor() { }\n\n}\n","<div *ngIf=\"legend && legend.type && legend.visible !== false && layer\" class=\"legend\">\n  <ng-container *ngIf=\"(legend.title | formatLegend) as l\">\n    <div class=\"legend__title\">\n      {{ title | translate}} {{ l.translateKey | translate: {metric: l.metric | translate, field: l.field | translate, normalized: l.normalized | translate: {normalizedKey: l.normalizedKey | translate} } }}\n    </div>\n  </ng-container>\n\n  <div class=\"legend--manual\" *ngIf=\"legend.type === PROPERTY_SELECTOR_SOURCE.manual\n        || legend.type === PROPERTY_SELECTOR_SOURCE.generated\n        || legend.type === PROPERTY_SELECTOR_SOURCE.provided\">\n    <div class=\"legend--manual__item\" *ngFor=\"let manualColor of legend.manualValues | keyvalue\">\n      <div [style.backgroundColor]=\"manualColor.value\"\n        [class.circle-tip]=\"layer.type === 'circle'\"\n        [class.line-tip]=\"layer.type === 'line'\"\n        [class.fill-tip]=\"layer.type === 'fill'\">\n      </div>\n      <div class=\"legend--manual__item__key\" [matTooltip]=\"manualColor.key | translate\" [matTooltipPosition]=\"'left'\">\n        {{manualColor.key | translate}}\n      </div>\n    </div>\n  </div>\n\n  <div class=\"legend--interpolated\" *ngIf=\"legend.type === PROPERTY_SELECTOR_SOURCE.interpolated\">\n    <div *ngIf=\"!!colorPalette; else size\" class=\"legend--interpolated__palette\"\n      [style.background]=\"'linear-gradient(to right, ' + colorPalette + ')'\"></div>\n    <ng-template #size>\n      <div class=\"legend--interpolated__svg\">\n        <svg #interpolated_svg></svg>\n      </div>\n    </ng-template>\n    <div class=\"legend--interpolated__range\">\n      <div class=\"legend--interpolated__range__value\">\n        {{legend?.minValue | formatNumber:'NUMBER_FORMAT_CHAR' | translate}}\n      </div>\n      <div class=\"legend--interpolated__range__value\">\n        {{legend?.maxValue | formatNumber:'NUMBER_FORMAT_CHAR' | translate}}\n      </div>\n    </div>\n  </div>\n</div>","/*\n * Licensed to Gisaïa under one or more contributor\n * license agreements. See the NOTICE.txt file distributed with\n * this work for additional information regarding copyright\n * ownership. Gisaïa licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { Pipe, PipeTransform } from '@angular/core';\nimport { getLayerName } from '../map/model/layers';\n\n\n@Pipe({\n  name: 'layerIdToName'\n})\nexport class LayerIdToName implements PipeTransform {\n\n  /** FROM V15.0.0 layer ids look like 'arlas_id:NAME:timestamp\n   * This pipe extracts the 'NAME' in that id\n   */\n  public transform(id: string): any {\n    return getLayerName(id);\n  }\n\n}\n","/*\n * Licensed to Gisaïa under one or more contributor\n * license agreements. See the NOTICE.txt file distributed with\n * this work for additional information regarding copyright\n * ownership. Gisaïa licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport {\n  AfterViewInit, Component, computed, Input, OnChanges, OnInit, Output, signal, SimpleChanges, ViewChild, WritableSignal\n} from '@angular/core';\nimport { TranslateService } from '@ngx-translate/core';\nimport { HistogramData } from 'arlas-d3/histograms/utils/HistogramUtils';\nimport { ArlasColorService } from 'arlas-web-components';\nimport { scaleLinear, ScaleLinear } from 'd3-scale';\nimport { select } from 'd3-selection';\nimport { area, curveLinear, line } from 'd3-shape';\nimport { Subject, takeUntil } from 'rxjs';\nimport { ARLAS_ID, ArlasDataLayer, FILLSTROKE_LAYER_PREFIX, HOVER_LAYER_PREFIX, SELECT_LAYER_PREFIX } from '../map/model/layers';\nimport { Legend, LegendData, PROPERTY_SELECTOR_SOURCE } from './legend.config';\nimport { LegendService } from './legend.service';\nimport { MAX_LINE_WIDTH } from './legend.tools';\n\n\n@Component({\n  selector: 'arlas-legend',\n  templateUrl: './legend.component.html',\n  styleUrls: ['./legend.component.scss']\n})\nexport class LegendComponent implements OnInit, AfterViewInit, OnChanges {\n  /**\n   * @Input : Angular\n   * @description Layer object\n   */\n  @Input() public layer: ArlasDataLayer;\n  /**\n   * @Input : Angular\n   * @description Collection of the layer\n   */\n  @Input() public collection: string;\n  /**\n   * @Input : Angular\n   * @description Current zoom level of the map\n   */\n  @Input() public zoom: number;\n  /**\n   * @Input : Angular\n   * @description Whether the layer is enabled.\n   */\n  @Input() public enabled: boolean;\n  /**\n   * @Input : Angular\n   * @description Subject of [collection, [field, legendData]] map. The map subscribes to it to keep\n   * the legend updated with the data displayed on the map.\n   */\n  @Input() public legendUpdater: Subject<Map<string, Map<string, LegendData>>> = new Subject();\n  /**\n   * @Input : Angular\n   * @description Subject of [field, boolean] map. The map subscribes to it to keep\n   * the legend updated with the visibility of the layer.\n   */\n  @Input() public visibilityUpdater: Subject<Map<string, boolean>> = new Subject();\n\n  /**\n   * @Output : Angular\n   * @description Notifies the parent component that this layer is visible or not\n   */\n  @Output() public visibilityStatus: Subject<boolean> = new Subject();\n\n  /**\n   * @Output : Angular\n   * @description Notifies the parent component that the user wants to download the layer\n   */\n  @Output() public downloadSourceEmitter: Subject<{ layer: any; downloadType: string; }> = new Subject();\n\n  @ViewChild('width_legend', { static: false }) public lineWidthLegend: any;\n  @ViewChild('radius_legend', { static: false }) public circleRadiusLegend: any;\n\n  public lineDasharray: Array<number>;\n\n  public colorLegend: WritableSignal<Legend> = signal({});\n  public hasColorLegend = computed(() => this.colorLegend().type !== undefined && this.colorLegend().type !== 'Fix');\n\n  public strokeColorLegend: WritableSignal<Legend> = signal({});\n  public hasStrokeLegend = computed(() => this.strokeColorLegend().type !== undefined && this.strokeColorLegend().type !== 'Fix');\n\n  public widthLegend: WritableSignal<Legend> = signal({});\n  public hasWidthLegend = computed(() => this.widthLegend().type !== undefined && this.widthLegend().type !== 'Fix');\n\n  public radiusLegend: WritableSignal<Legend> = signal({});\n  public hasRadiusLegend = computed(() => this.radiusLegend().type !== undefined && this.radiusLegend().type !== 'Fix');\n\n  public displayLegendDetailToggle = computed(() =>\n    this.hasColorLegend() || this.hasStrokeLegend() || this.hasWidthLegend() || this.hasRadiusLegend());\n\n  public detail = false;\n  public visibleMode = false;\n  public PROPERTY_SELECTOR_SOURCE = PROPERTY_SELECTOR_SOURCE;\n\n  private legendData: Map<string, LegendData> = new Map();\n  public colorPalette = '';\n  public strokeColorPalette = '';\n\n  private readonly MAX_CIRLE_RADIUS = 7;\n  private readonly LEGEND_WIDTH = 210;\n  private readonly _onDestroy$ = new Subject<boolean>();\n\n  public constructor(\n    public translate: TranslateService,\n    public colorService: ArlasColorService,\n    public legendService: LegendService\n  ) { }\n\n  public ngOnInit() {\n    this.legendUpdater\n      .pipe(takeUntil(this._onDestroy$))\n      .subscribe(legendDataPerCollection => {\n\n        this.legendData = legendDataPerCollection.get(this.collection);\n        if (this.layer) {\n          this.drawLegends(this.visibleMode);\n        }\n      });\n    this.visibilityUpdater\n      .pipe(takeUntil(this._onDestroy$))\n      .subscribe(visibilityUpdater => {\n        /** check legend visibility according to Data source status (mapcontirbutor) */\n        if (this.layer) {\n          /** if the visibility updater contains the layer we pick the visibility status otherwise we keep it unchaged */\n          this.visibleMode = visibilityUpdater.get(this.layer.id) !== undefined ? visibilityUpdater.get(this.layer.id) : this.visibleMode;\n        } else {\n          this.visibleMode = false;\n        }\n        /** check legend visibility according to VisibilityRules */\n        if (this.visibleMode && this.layer && !!this.layer.minzoom && !!this.layer.maxzoom) {\n          this.visibleMode = (this.zoom <= this.layer.maxzoom && this.zoom >= this.layer.minzoom);\n        }\n        /** check legend visibility according to legend enabled or not */\n        if (!this.enabled) {\n          this.visibleMode = false;\n        }\n        if (!this.visibleMode) {\n          this.detail = this.visibleMode;\n        }\n        /** check legend visibility for external layers that are not set by config nor map contributors */\n        if (this.layer && !this.layer.id.startsWith(ARLAS_ID) &&\n          !this.layer.id.startsWith(FILLSTROKE_LAYER_PREFIX) && !this.layer.id.startsWith(HOVER_LAYER_PREFIX)\n          && !this.layer.id.startsWith(SELECT_LAYER_PREFIX)) {\n          this.visibleMode = this.enabled;\n          if (!!this.layer.metadata && this.layer.metadata.showLegend === false) {\n            this.visibleMode = false;\n          }\n        }\n        if (this.layer) {\n          this.drawLegends(this.visibleMode);\n        }\n        this.visibilityStatus.next(this.visibleMode);\n      });\n  }\n\n  public ngAfterViewInit() {\n    if (this.layer) {\n      this.drawLegends(this.visibleMode);\n    }\n  }\n\n  public ngOnChanges(changes: SimpleChanges) {\n    if (changes['layer'] !== undefined) {\n      if (this.layer) {\n        this.drawLegends(this.visibleMode);\n      }\n    }\n  }\n\n  public ngOnDestroy() {\n    this._onDestroy$.next(true);\n    this._onDestroy$.complete();\n  }\n\n  public downloadLayerSource(layer: any, downloadType: string): void {\n    const download = {\n      layer,\n      downloadType\n    };\n    this.downloadSourceEmitter.next(download);\n  }\n\n  public showDetail(event: Event) {\n    this.detail = !this.detail;\n    event.stopPropagation();\n  }\n\n  /** Parses the `paint` attribute of a layer and draws the legend elements such as\n   * - color palette\n   * - line width evolution\n   * - circle radius evolution\n   */\n  private drawLegends(visibileMode: boolean): void {\n    const type = this.layer.type;\n    const paint = this.layer.paint;\n    switch (type) {\n      case 'circle': {\n        const circleLegend = this.legendService.getCircleLegend(paint, visibileMode, this.legendData, this.layer);\n        this.colorLegend.set(circleLegend.color);\n\n        // For circle-heatmap layer the stroke can't be configured, so hide it\n        if (this.layer.metadata?.hiddenProps?.geomType !== 'circle-heatmap') {\n          this.strokeColorLegend.set(circleLegend.strokeColor);\n        }\n        this.colorPalette = circleLegend.colorPalette;\n        this.strokeColorPalette = circleLegend.strokeColorPalette;\n        this.radiusLegend.set(circleLegend.radius);\n        if (this.circleRadiusLegend?.interpolatedElement) {\n          const circleRadiusEvolution = circleLegend.radius.histogram;\n          drawCircleSupportLine(this.circleRadiusLegend.interpolatedElement.nativeElement, circleRadiusEvolution, this.colorLegend(),\n            this.LEGEND_WIDTH, Math.min(this.MAX_CIRLE_RADIUS, getMax(circleRadiusEvolution)) * 2);\n        }\n        break;\n      }\n      case 'line': {\n        const lineLegend = this.legendService.getLineLegend(paint, visibileMode, this.legendData, this.layer);\n        this.lineDasharray = lineLegend.dashes;\n        this.colorLegend.set(lineLegend.color);\n        this.colorPalette = lineLegend.colorPalette;\n        this.widthLegend.set(lineLegend.width);\n        if (this.lineWidthLegend?.interpolatedElement) {\n          const lineWidthEvolution = lineLegend.width.histogram;\n          drawLineWidth(this.lineWidthLegend.interpolatedElement.nativeElement, lineWidthEvolution, this.colorLegend(),\n            this.LEGEND_WIDTH, MAX_LINE_WIDTH);\n        }\n        break;\n      }\n      case 'fill': {\n        const fillLegend = this.legendService.getFillLegend(paint, visibileMode, this.legendData, this.layer);\n        this.colorLegend.set(fillLegend.color);\n        this.colorPalette = fillLegend.colorPalette;\n        this.strokeColorLegend.set(fillLegend?.strokeColor);\n        this.strokeColorPalette = fillLegend?.strokeColorPalette;\n        break;\n      }\n      case 'heatmap': {\n        const heatmapLegend = this.legendService.getHeatmapLegend(paint, visibileMode, this.legendData, this.layer);\n\n        this.colorLegend.set(heatmapLegend.color);\n        this.colorPalette = heatmapLegend.colorPalette;\n        this.radiusLegend.set(heatmapLegend.radius);\n        if (this.circleRadiusLegend?.interpolatedElement) {\n          const heatmapRadiusEvolution = heatmapLegend.radius.histogram;\n          drawCircleSupportLine(this.circleRadiusLegend.interpolatedElement.nativeElement, heatmapRadiusEvolution, this.colorLegend(),\n            this.LEGEND_WIDTH, Math.min(this.MAX_CIRLE_RADIUS, getMax(heatmapRadiusEvolution)) * 2);\n        }\n        break;\n      }\n      case 'symbol': {\n        const symbolLegend = this.legendService.getLabelLegend(paint, visibileMode, this.legendData, this.layer);\n        this.colorLegend.set(symbolLegend.color);\n        this.colorPalette = symbolLegend.colorPalette;\n        this.widthLegend.set(symbolLegend.size);\n        if (!!this.lineWidthLegend && !!this.lineWidthLegend.interpolatedElement) {\n          const lineWidthEvolution = symbolLegend.size.histogram;\n          drawLineWidth(this.lineWidthLegend.interpolatedElement.nativeElement, lineWidthEvolution, this.colorLegend(),\n            this.LEGEND_WIDTH, MAX_LINE_WIDTH);\n        }\n        break;\n      }\n    }\n    if (!this.colorLegend().fixValue) {\n      this.colorLegend().fixValue = visibileMode ? '#444' : '#d3d3d3';\n    }\n    const layer = { ...this.layer };\n    this.layer = null;\n    this.layer = { ...layer };\n  }\n\n\n}\n\n/**\n * draws the line width legend\n * @param svgNode SVG element on which we append the line using d3.\n * @param lineWidths List of {key, linewidth}\n * @param cLegend Color legend, to give the drawn legend lines the same color on the map\n * @param legendWidth The width that the svg will take to draw the legend\n * @param legendHeight The height that the svg will take to draw the legend\n */\nexport function drawLineWidth(svgNode: SVGElement, lineWidths: Array<HistogramData>,\n  cLegend: Legend, legendWidth: number, legendHeight: number) {\n  const maxHeight = getMax(lineWidths);\n  const xDomain: any = (scaleLinear()).range([0, legendWidth]);\n  const xDomainExtent = [lineWidths[0].key, lineWidths[lineWidths.length - 1].key];\n  xDomain.domain(xDomainExtent);\n  const yDomain: ScaleLinear<number, number> = scaleLinear().range([maxHeight, 0]);\n  yDomain.domain([0, maxHeight]);\n  const svg = select(svgNode).attr('width', legendWidth).attr('height', legendHeight);\n  svg.selectAll('g').remove();\n  const context = svg.append('g').attr('class', 'context');\n  const ar = area()\n    .curve(curveLinear)\n    .x((d: any) => xDomain(d.key))\n    .y0(maxHeight)\n    .y1((d: any) => yDomain(d.value));\n\n  const widthLineColor = getMiddleColor(cLegend);\n  context.append('path')\n    .datum(lineWidths)\n    .style('fill', widthLineColor)\n    .style('fill-opacity', 0.6)\n    .style('stroke', widthLineColor)\n    .style('stroke-opacity', 0.6)\n    .style('stroke-width', 0.5)\n    .attr('d', <any>ar);\n}\n\nexport function getMiddleColor(colorLegend: Legend): string {\n  let color = '';\n  if (colorLegend.type === PROPERTY_SELECTOR_SOURCE.fix) {\n    color = colorLegend.fixValue as string;\n  } else if (colorLegend.type === PROPERTY_SELECTOR_SOURCE.interpolated) {\n    const iv = colorLegend.interpolatedValues as Array<string>;\n    if (iv.length === 1 || iv.length === 2) {\n      color = iv[0];\n    } else if (iv.length >= 3) {\n      color = iv[Math.trunc(iv.length / 2)];\n    }\n  } else if (colorLegend.type === PROPERTY_SELECTOR_SOURCE.manual || colorLegend.type === PROPERTY_SELECTOR_SOURCE.generated\n    || colorLegend.type === PROPERTY_SELECTOR_SOURCE.provided) {\n    const iv = colorLegend.manualValues as Map<string, string>;\n    if (iv) {\n      if (iv.size === 1) {\n        color = iv.keys().next().value;\n      } else if (iv.size >= 2) {\n        color = Array.from(iv.values())[Math.trunc(Array.from(iv.keys()).length / 2)];\n      }\n    }\n  }\n  return color;\n}\n/**\n * draws the circle radius legend\n * @param svgNode SVG element on which we append the circles using d3.\n * @param circlesRadiuses List of {key, circleradius}\n * @param cLegend Color legend, to give the drawn legend circles the same color on the map\n * @param legendWidth The width that the svg will take to draw the legend\n * @param legendHeight The height that the svg will take to draw the legend\n */\nexport function drawCircleSupportLine(svgNode: SVGElement, circlesRadiuses: Array<HistogramData>,\n  cLegend: Legend, legendWidth: number, legendHeight: number) {\n  const circleDiameters = [];\n  circlesRadiuses.forEach(cr => circleDiameters.push({ key: cr.key, value: cr.value * 2 }));\n  const maxHeight = getMax(circleDiameters);\n  const firstRadius = circlesRadiuses[0].value;\n  const lastRadius = circlesRadiuses[circlesRadiuses.length - 1].value;\n  const xDomain: any = (scaleLinear()).range([0, legendWidth - firstRadius - lastRadius]);\n  const xDomainExtent = [circleDiameters[0].key, circleDiameters[circleDiameters.length - 1].key];\n  xDomain.domain(xDomainExtent);\n  const yDomain: ScaleLinear<number, number> = scaleLinear().range([maxHeight, 0]);\n  yDomain.domain([0, maxHeight]);\n  const svg = select(svgNode).attr('width', legendWidth).attr('height', legendHeight);\n  svg.selectAll('g').remove();\n  const context = svg.append('g').attr('class', 'context');\n  const l = line()\n    .x((d: any) => xDomain(d.key))\n    .y((d: any) => yDomain(d.value));\n  context.append('path')\n    .datum(circleDiameters)\n    .attr('fill', 'none')\n    .attr('stroke', '#eaeaea')\n    .attr('stroke-width', 0.8)\n    .attr('transform', 'translate(' + firstRadius + ', 0)')\n    .attr('d', <any>l);\n  context.append('g').append('line')\n    .attr('x1', 0).attr('y1', maxHeight)\n    .attr('x2', legendWidth - firstRadius - lastRadius).attr('y2', maxHeight)\n    .attr('cx', 2).attr('cy', 2).attr('fill', 'none')\n    .attr('stroke', '#eaeaea')\n    .attr('stroke-width', 0.8)\n    .attr('transform', 'translate(' + firstRadius + ', 0)');\n  const circles = [circlesRadiuses[0], circlesRadiuses[circlesRadiuses.length - 1]];\n  const circleColor = getMiddleColor(cLegend);\n  context.append('g')\n    .selectAll('dot').data(circles).enter().append('circle')\n    .attr('r', (d) => d.value)\n    .attr('cx', (d) => xDomain(d.key))\n    .attr('cy', (d) => maxHeight - d.value)\n    .attr('transform', 'translate(' + firstRadius + ', 0)')\n    .style('fill', circleColor)\n    .style('fill-opacity', 0.6)\n    .style('stroke', circleColor)\n    .style('stroke-width', 0.5);\n\n}\n\nexport function getMax(data: Array<HistogramData>): number {\n  return Math.max(...data.map(hd => +hd.value));\n}\n","\n<div class=\"layer_wrapper\">\n    <div class=collection_color [matTooltip]=\"'Collection:' | translate: {collection: (collection | getCollectionDisplayName)}\"\n      [style.backgroundColor]=\"!!collection ? (collection | getColor) : 'transparent'\"></div>\n    <div class=\"layer_container\" >\n      <div class=\"layer_icon_container\">\n        <div class=\"layer_icon\" >\n          <arlas-layer-icon [layer]=\"layer\" [colorLegend]=\"colorLegend()\" [strokeColorLegend]=\"strokeColorLegend()\"\n            [lineDasharray]=\"lineDasharray\" [widthLegend]=\"widthLegend()\" [radiusLegend]=\"radiusLegend()\"></arlas-layer-icon>\n        </div>\n        <div class=\"layer_name\" [style.color]=\"visibleMode ? '#444': '#d3d3d3'\">\n          {{layer?.id | layerIdToName | translate}}\n        </div>\n      </div>\n      <div class=\"layer_detail\">\n        <div class=\"download_button\">\n          <mat-icon class=\"download_icon\" [matMenuTriggerFor]=\"menu\" [matTooltip]=\"'Download the layer\\'s data' | translate\">file_download</mat-icon>\n          <mat-menu #menu=\"matMenu\">\n            <button mat-menu-item (click)=\"downloadLayerSource(layer, 'csv')\">\n              {{'CSV' | translate}}\n            </button>\n            <button mat-menu-item (click)=\"downloadLayerSource(layer, 'geojson')\">\n              {{'GeoJson' | translate}}\n            </button>\n          </mat-menu>\n        </div>\n\n        @if (displayLegendDetailToggle()) {\n          <div class=\"detail_button\" (click)=\"showDetail($event)\" (keyDown)=\"showDetail($event)\">\n            <mat-icon class=\"detail_icon\">{{ detail ? 'keyboard_arrow_up' : 'keyboard_arrow_down' }}</mat-icon>\n          </div>\n        }\n      </div>\n    </div>\n\n    <div [hidden]=\"!detail\" class=\"legend-wrapper\">\n      <arlas-legend-item [hidden]=\"!hasColorLegend()\" [legend]=\"colorLegend()\" [layer]=\"layer\"\n        [title]=\"'Fill:' | marker\" [colorPalette]=\"colorPalette\"></arlas-legend-item>\n\n      <arlas-legend-item [hidden]=\"!hasStrokeLegend()\" [legend]=\"strokeColorLegend()\" [layer]=\"layer\"\n        [title]=\"'Stroke:' | marker\" [colorPalette]=\"colorPalette\"></arlas-legend-item>\n\n      <arlas-legend-item [hidden]=\"!hasWidthLegend()\" #width_legend [legend]=\"widthLegend()\" [layer]=\"layer\"\n        [title]=\"'Width:' | marker\"></arlas-legend-item>\n\n      <arlas-legend-item [hidden]=\"!hasRadiusLegend()\" #radius_legend [legend]=\"radiusLegend()\" [layer]=\"layer\"\n        [title]=\"'Radius:' | marker\"></arlas-legend-item>\n    </div>\n  </div>\n","/*\n * Licensed to Gisaïa under one or more contributor\n * license agreements. See the NOTICE.txt file distributed with\n * this work for additional information regarding copyright\n * ownership. Gisaïa licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { Pipe, PipeTransform } from '@angular/core';\n\n@Pipe({ name: 'getCollection' })\nexport class GetCollectionPipe implements PipeTransform {\n  public transform(value: string, layersMap?: Map<string, any>): string {\n    let collection: string;\n    if (layersMap?.get(value)?.metadata?.collection) {\n      collection = layersMap.get(value).metadata.collection;\n    }\n    return collection;\n  }\n}\n","/*\n * Licensed to Gisaïa under one or more contributor\n * license agreements. See the NOTICE.txt file distributed with\n * this work for additional information regarding copyright\n * ownership. Gisaïa licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { CdkDragDrop, moveItemInArray } from '@angular/cdk/drag-drop';\nimport { Component, EventEmitter, Input, Output, SimpleChanges, ViewChild, ViewEncapsulation } from '@angular/core';\nimport { takeUntilDestroyed } from '@angular/core/rxjs-interop';\nimport { TranslateService } from '@ngx-translate/core';\nimport { Feature, FeatureCollection } from '@turf/helpers';\nimport { ElementIdentifier } from 'arlas-web-components';\nimport { finalize, fromEvent, Subject, takeUntil } from 'rxjs';\nimport { ArlasMapFrameworkService } from './arlas-map-framework.service';\nimport * as mapJsonSchema from './arlas-map.schema.json';\nimport { AbstractArlasMapService } from './arlas-map.service';\nimport { BasemapStyle } from './basemaps/basemap.config';\nimport { BasemapService } from './basemaps/basemap.service';\nimport { ArlasBasemaps } from './basemaps/basemaps.model';\nimport { ArlasDrawComponent } from './draw/arlas-draw.component';\nimport { AoiDimensions } from './draw/draw.models';\nimport { MapboxAoiDrawService } from './draw/draw.service';\nimport { LegendData } from './legend/legend.config';\nimport {\n  AbstractArlasMapGL,\n  ArlasMapOffset,\n  CROSS_LAYER_PREFIX,\n  MapConfig,\n  RESET_BEARING,\n  ZOOM_IN, ZOOM_OUT\n} from './map/AbstractArlasMapGL';\nimport { ControlPosition, IconConfig } from './map/model/controls';\nimport { MapLayerMouseEvent, MapMouseEvent } from './map/model/events';\nimport { MapExtent } from './map/model/extent';\nimport { ARLAS_VSET, ArlasDataLayer, getLayerName, MapLayers } from './map/model/layers';\nimport { ArlasLngLatBounds, OnMoveResult } from './map/model/map';\nimport { ArlasMapSource } from './map/model/sources';\nimport { VisualisationSetConfig } from './map/model/visualisationsets';\n\n@Component({\n  selector: 'arlas-map',\n  templateUrl: './arlas-map.component.html',\n  styleUrls: ['./arlas-map.component.scss'],\n  encapsulation: ViewEncapsulation.None\n})\n/** L: a layer class/interface.\n *  S: a source class/interface.\n *  M: a Map configuration class/interface.\n */\nexport class ArlasMapComponent<L, S, M> {\n\n  /** Map instance. */\n  public map: AbstractArlasMapGL;\n  /** Whether the legend is visible (open) or not.*/\n  public legendOpen = true;\n  /** Used to clear geojson sources. */\n  public emptyData: FeatureCollection<GeoJSON.Geometry> = {\n    'type': 'FeatureCollection',\n    'features': []\n  };\n\n  /** Whether the list of basemaps is shown. */\n  public showBasemapList = false;\n\n  /** Visibility status of each visualisation set*. */\n  public visibilityStatus = new Map<string, boolean>();\n  private readonly _onDestroy$ = new Subject<boolean>();\n\n\n  @ViewChild('drawComponent', { static: false }) public drawComponent: ArlasDrawComponent<ArlasDataLayer, S, M>;\n\n\n  /** ANGULAR INPUTS */\n\n  /** @description Html identifier given to the map container (it's a div ;))*/\n  @Input() public id = 'mapgl';\n  /** @description An object with north,east,south,west properies which represent an offset in pixels */\n  /** Origin is top-left and x-axis is west to east and y-axis north to south.*/\n  @Input() public offset: ArlasMapOffset = { north: 0, east: 0, south: 0, west: 0 };\n\n  /** --- LAYERS */\n\n  /** @description List of configured (by the builder) layers. */\n  @Input() public mapLayers: MapLayers<ArlasDataLayer>;\n\n  /** --- SCALE & COORDINATES */\n\n  /** @description Whether the map scale is displayed. */\n  @Input() public displayScale = true;\n  /** @description Maximim width in pixels that the map scale could take. */\n  @Input() public maxWidthScale = 100;\n  /** @description Unit display for the map scale. */\n  @Input() public unitScale = 'metric';\n  /** @description Whether to display the coordinates of the mouse while moving. */\n  @Input() public displayCurrentCoordinates = false;\n  /** @description If true, the coordinates values are wrapped between -180 and 180. */\n  @Input() public wrapLatLng = true;\n\n  /** --- BASEMAPS */\n\n  /** @description Default basemap to display. */\n  @Input() public defaultBasemapStyle: BasemapStyle;\n  /** @description List of available basemaps. */\n  @Input() public basemapStyles = new Array<BasemapStyle>();\n\n  /** --- INITIAL MAP VIEW : ZOOMs, CENTER, BOUNDS */\n\n  /** @description Zoom of the map when it's initialized. */\n  @Input() public initZoom = 2;\n  /** @description Max zoom of the map. */\n  @Input() public maxZoom = 22;\n  /** @description Min zoom of the map. */\n  @Input() public minZoom = 0;\n  /** @description Coordinates of the map's center when it's first loaded. */\n  @Input() public initCenter: [number, number] = [2.1972656250000004, 45.706179285330855];\n\n  /** --- BOUNDS TO FIT STRATEGY */\n\n  /** @description Bounds that the view map fits. It's an array of two corners. */\n  /** Each corner is an lat-long position. For example: boundsToFit = [[30.51, -54.3],[30.57, -54.2]] */\n  @Input() public boundsToFit: Array<Array<number>>;\n  /** @description The padding added in the top-left and bottom-right corners of a map container that shouldn't be accounted */\n  /** for when setting the view to fit bounds.*/\n  @Input() public fitBoundsOffSet: [number, number] = [0, 0];\n  /**  @description Padding value applied around a fitBounds to fully show the area targeted. */\n  @Input() public fitBoundsPadding = 10;\n  /** @description The maximum zoom level so that the bounds fit the map view. */\n  @Input() public fitBoundsMaxZoom = 22;\n\n  /** --- DATA LOADING STRATEGIES */\n\n  /** @description Margin applied to the map extent. Data will be fetched in all this extent. */\n  @Input() public margePanForLoad: number;\n  /** @description Margin applied to the map extent. Before loading data,\n   * the components checks first if there are features already loaded in this extent. */\n  @Input() public margePanForTest: number;\n  /** @description A callback run before the Map makes a request for an external URL/ */\n  @Input() public transformRequest: unknown /** TransformRequestFunction or RequestTransformRequest */;\n\n  /** --- MAP INTERACTION */\n\n  /** @description Feature to highlight. */\n  @Input() public featureToHightLight: { isleaving: boolean; elementidentifier: ElementIdentifier; };\n  /** @description List of features to select. */\n  @Input() public featuresToSelect: Array<ElementIdentifier>;\n\n  /** --- SOURCES */\n\n  /** @description List of sources to add to the map. */\n  @Input() public mapSources: Array<ArlasMapSource<S>>;\n  /** @description Subject to which the component subscribes to redraw on the map the `data` of the given `source`. */\n  @Input() public redrawSource = new Subject<{ source: string; data: Feature<GeoJSON.Geometry>[]; }>();\n  /** @description List of data sources names that should be added to the map. Sources should be of type `geojson`. */\n  @Input() public dataSources: Set<string>;\n\n  /** --- DRAW */\n\n  /**  @description Options object for draw tools : https://github.com/mapbox/mapbox-gl-draw/blob/master/docs/API.md#options */\n  @Input() public drawOption: any = {};\n  /** @description Features drawn at component start */\n  @Input() public drawData: FeatureCollection<GeoJSON.Geometry> = ({ ...this.emptyData});\n  /** @description Whether the draw tools are activated. */\n  @Input() public drawButtonEnabled = false;\n  /** @description Maximum number of vertices allowed for a polygon. */\n  @Input() public drawPolygonVerticesLimit: number;\n  /** @description Whether the drawing buffer is activated */\n  /** If true, the map's canvas can be exported to a PNG using map.getCanvas().toDataURL(). Default: false */\n  @Input() public preserveDrawingBuffer = false;\n\n  /** --- ATTRIBUTION */\n\n  /** @description Position of the map attribution. */\n  @Input() public mapAttributionPosition: ControlPosition = 'bottom-right';\n\n  /** --- MAP ICONS */\n\n  /** @description List of icons to add to the map and that can be used in layers. */\n  @Input() public icons: Array<IconConfig>;\n\n  /** --- LEGEND AND VISUALISATIONS */\n\n  /** @description Subject of [collection, [field, legendData]] map. The map subscribes to it to keep */\n  /** the legend updated with the data displayed on the map. */\n  @Input() public legendUpdater: Subject<Map<string, Map<string, LegendData>>> = new Subject();\n  /** @description Subject of [layerId, boolean] map. The map subscribes to it to keep */\n  /** the legend updated with the visibility of the layer.*/\n  @Input() public visibilityUpdater: Subject<Map<string, boolean>> = new Subject();\n  /** @description List of visualisation sets. A Visualisation set is an entity where layers are grouped together. */\n  /** If a visualisation set is enabled, all the layers in it can be displayed on the map, otherwise the layers are removed from the map. */\n  @Input() public visualisationSetsConfig: Array<VisualisationSetConfig>;\n\n\n  /** ANGULAR OUTPUTS */\n\n  /** @description Emits true after the map is loaded and all sources & layers are added. */\n  @Output() public onMapLoaded: Subject<boolean> = new Subject<boolean>();\n\n  /** @description Emits the map extent when the browser tab is closed/refreshed. */\n  @Output() public onMapClosed: EventEmitter<MapExtent> = new EventEmitter<MapExtent>();\n\n  /**\n   * @deprecated\n   * @description  Emits the event of moving the map. */\n  @Output() public onMove: EventEmitter<OnMoveResult> = new EventEmitter<OnMoveResult>();\n\n  /** @description Emits the visible visualisation sets' names */\n  @Output() public visualisations: EventEmitter<Set<string>> = new EventEmitter();\n\n  /** @description Emits the features that were clicked on. */\n  @Output() public onFeatureClick = new EventEmitter<{ features: Array<GeoJSON.Feature<GeoJSON.Geometry>>; point: [number, number]; }>();\n\n  /** @description Emits the features that were hovered. */\n  @Output() public onFeatureHover = new EventEmitter<{ features: Array<GeoJSON.Feature<GeoJSON.Geometry>>; point: [number, number]; } | {}>();\n\n  /** @description Emits the geojson of all aois added to the map. */\n  @Output() public onAoiChanged: EventEmitter<FeatureCollection<GeoJSON.Geometry>> = new EventEmitter();\n\n  /** @description Emits the the dimensions of the polygon/bbox that is being drawn. */\n  @Output() public onAoiEdit: EventEmitter<AoiDimensions> = new EventEmitter();\n\n  /** @description Emits an event when the basemap has been changed by the user. */\n  @Output() public onBasemapChanged: Subject<boolean> = new Subject();\n\n  /** @description Emits which layers are displayed on the map. */\n  @Output() public legendVisibiltyStatus: Subject<Map<string, boolean>> = new Subject();\n\n  /** @description  Notifies that the user wants to download the selected layer */\n  @Output() public downloadSourceEmitter: Subject<{\n    layerId: string;\n    layerName: string;\n    collection: string;\n    sourceName: string;\n    downloadType: string;\n  }> = new Subject();\n\n  protected ICONS_BASE_PATH = 'assets/icons/';\n\n  public constructor(private readonly drawService: MapboxAoiDrawService,\n    private readonly basemapService: BasemapService<L, S, M>, private readonly translate: TranslateService,\n    protected mapFrameworkService: ArlasMapFrameworkService<L, S, M>,\n    protected mapService: AbstractArlasMapService<L, S, M>) {\n      this.basemapService.protomapBasemapAdded$.pipe(takeUntilDestroyed())\n      .subscribe(() => this.reorderLayers());\n  }\n\n  public ngAfterViewInit() {\n    /** init values */\n    if (!this.initCenter) {\n      this.initCenter = [0, 0];\n    }\n    if (this.initZoom === undefined || this.initZoom === null) {\n      this.initZoom = 3;\n    }\n    if (this.maxZoom === undefined || this.maxZoom === null) {\n      this.maxZoom = 23;\n    }\n    this.minZoom = this.minZoom ?? 0;\n\n    /** BASEMAPS */\n    if (this.defaultBasemapStyle && typeof this.defaultBasemapStyle.styleFile === 'string') {\n      this.defaultBasemapStyle.url = this.defaultBasemapStyle.styleFile;\n    }\n    this.basemapStyles.forEach(bm => {\n      if (typeof bm.styleFile === 'string') {\n        bm.url = (bm.styleFile);\n      }\n    });\n    this.basemapService.setBasemaps(new ArlasBasemaps(this.defaultBasemapStyle, this.basemapStyles));\n    this.basemapService.fetchSources$()\n      .pipe(finalize(() => this.declareMap()))\n      .subscribe();\n  }\n\n  public ngOnChanges(changes: SimpleChanges): void {\n    if (this.map && this.map.getMapProvider() !== undefined) {\n      if (changes['boundsToFit'] !== undefined) {\n        const newBoundsToFit = changes['boundsToFit'].currentValue;\n        this.map.fitBounds(newBoundsToFit, {\n          maxZoom: this.fitBoundsMaxZoom,\n          offset: this.fitBoundsOffSet\n        });\n      }\n      if (changes['featureToHightLight'] !== undefined\n        && changes['featureToHightLight'].currentValue !== changes['featureToHightLight'].previousValue) {\n        const featureToHightLight = changes['featureToHightLight'].currentValue;\n        this.highlightFeature(featureToHightLight);\n      }\n      if (changes['featuresToSelect'] !== undefined\n        && changes['featuresToSelect'].currentValue !== changes['featuresToSelect'].previousValue) {\n        const featuresToSelect = changes['featuresToSelect'].currentValue;\n        this.selectFeatures(featuresToSelect);\n      }\n    }\n  }\n\n  /** If transformRequest' @Input was not set, set a default value : a function that maintains the same url */\n  public initTransformRequest() {\n    if (!this.transformRequest) {\n      this.transformRequest = this.mapFrameworkService.getInitTransformRequest();\n    }\n  }\n\n  /** Zooms on clicked feature from map mouse event e.\n   * @param mouseEvent Map mouse event provided by the map instance.\n   */\n  public zoomOnClick(mouseEvent: MapMouseEvent) {\n    const zoom = this.map.getZoom();\n      let newZoom: number;\n      if (zoom >= 0 && zoom < 3) {\n        newZoom = 4;\n      } else if (zoom >= 3 && zoom < 5) {\n        newZoom = 5;\n      } else if (zoom >= 5 && zoom < 7) {\n        newZoom = 7;\n      } else if (zoom >= 7 && zoom < 10) {\n        newZoom = 10;\n      } else if (zoom >= 10 && zoom < 11) {\n        newZoom = 11;\n      } else {\n        newZoom = 12;\n      }\n      this.mapFrameworkService.flyTo(mouseEvent.lngLat.lat, mouseEvent.lngLat.lng, newZoom, this.map);\n  }\n\n  /**\n   * Queries all rendered features on the position that was clicked on, on a layer; and emits those features.\n   * @param mapLayerMouseEvent Map mouse event provided by a layer instance.\n   */\n  protected queryRender(mapLayerMouseEvent: MapLayerMouseEvent) {\n    const hasCrossOrDrawLayer = this.mapFrameworkService.queryFeatures(mapLayerMouseEvent, this.map, CROSS_LAYER_PREFIX);\n    if (!this.drawService.isDrawingBbox && !this.drawService.isDrawingPolygon\n      && !this.drawService.isDrawingCircle && !this.drawService.isInSimpleDrawMode && !hasCrossOrDrawLayer) {\n      this.onFeatureClick.next({ features: mapLayerMouseEvent.features, point: [mapLayerMouseEvent.lngLat.lng, mapLayerMouseEvent.lngLat.lat] });\n    }\n  }\n\n  /** @description Adds the custom icons given in the component's input */\n  public addIcons() {\n    if (this.icons) {\n      this.icons.forEach(icon => {\n        const iconName = icon.path.split('.')[0];\n        const iconPath = this.ICONS_BASE_PATH + icon.path;\n        const iconErrorMessage = 'The icon \"' + this.ICONS_BASE_PATH + icon.path + '\" is not found';\n        this.mapFrameworkService.addImage(iconName, iconPath, this.map, iconErrorMessage, { 'sdf': icon.recolorable });\n      });\n    }\n\n    this.mapFrameworkService.addImage('rotate', this.ICONS_BASE_PATH + 'rotate/01.png', this.map, 'Rotate not found');\n    this.mapFrameworkService.addImage('resize', this.ICONS_BASE_PATH + 'resize/01.png', this.map, 'Resize not found');\n  }\n\n  /**\n   * @description Creates the map instance and adds the basemap, arlas data\n   * and starts listening to arlas data changes and layers visibility updates.\n   * It also starts emiting map moveend event.\n   */\n  public declareMap() {\n    this.initTransformRequest();\n    const config: MapConfig<M> = {\n      displayCurrentCoordinates: this.displayCurrentCoordinates,\n      fitBoundsPadding: this.fitBoundsPadding,\n      margePanForLoad: this.margePanForLoad,\n      margePanForTest: this.margePanForTest,\n      offset: this.offset,\n      wrapLatLng: this.wrapLatLng,\n      maxWidthScale: this.maxWidthScale,\n      unitScale: this.unitScale,\n      mapProviderOptions: {\n        container: this.id,\n        style: this.basemapService.getInitStyle(this.basemapService.basemaps.getSelected()),\n        center: this.initCenter,\n        zoom: this.initZoom,\n        maxZoom: this.maxZoom,\n        minZoom: this.minZoom,\n        renderWorldCopies: true,\n        preserveDrawingBuffer: this.preserveDrawingBuffer,\n        locale: {\n          'NavigationControl.ZoomIn': this.translate.instant(ZOOM_IN),\n          'NavigationControl.ZoomOut': this.translate.instant(ZOOM_OUT),\n          'NavigationControl.ResetBearing': this.translate.instant(RESET_BEARING)\n        },\n        pitchWithRotate: false,\n        transformRequest: this.transformRequest,\n        attributionControl: false,\n      } as M,\n      controls: {\n        mapAttribution: {\n          enable: true,\n          position: this.mapAttributionPosition,\n          config: {\n            compact: false\n          }\n        },\n        scale: {\n          enable: this.displayScale\n        },\n        navigationControl: {\n          enable: true\n        },\n        pitchToggle: {\n          enable: true,\n          config: { bearing: -20, pitch: 70, minpitchzoom: 11 }\n        }\n      }\n    };\n    this.map = this.mapFrameworkService.createMap(config);\n    fromEvent(window, 'beforeunload').subscribe(() => {\n      this.onMapClosed.next(this.map.getMapExtend());\n    });\n\n    this.map.onCustomEvent('beforeOnLoadInit', () => {\n      this.basemapService.declareProtomapProtocol(this.map);\n      this.basemapService.addProtomapBasemap(this.map);\n      this.addIcons();\n      this.mapService.declareArlasDataSources(this.dataSources, this.emptyData, this.map);\n      this.mapService.declareBasemapSources(this.mapSources, this.map);\n      this.mapService.addArlasDataLayers(this.visualisationSetsConfig, this.mapLayers, this.map);\n      this.listenToLayersEvents();\n    });\n\n    this.mapFrameworkService.onMapEvent('load', this.map, () => {\n      if (this.mapLayers !== null) {\n        this.visibilityUpdater.subscribe(visibilityStatus => {\n          this.mapService.updateVisibility(visibilityStatus, this.visualisationSetsConfig, this.map);\n        });\n      }\n      this.onMapLoaded.next(true);\n    });\n\n    this.map.onMoveEnd(this.mapService.visualisationsSets).subscribe((moveResult => {\n      this.onMove.next(moveResult);\n    }));\n\n    if (this.redrawSource) {\n      this.redrawSource.pipe(takeUntil(this._onDestroy$)).subscribe(sd => {\n        this.mapFrameworkService.setDataToGeojsonSource(this.mapFrameworkService.getSource(sd.source, this.map), {\n          'type': 'FeatureCollection',\n          'features': sd.data\n        });\n      });\n    }\n  }\n\n  /**\n   * @description Listens to events on mapLayers input (configured layers).\n   */\n  public listenToLayersEvents() {\n    /** Zooms on the clicked feature of the given layers. */\n    this.mapLayers.events.zoomOnClick.forEach(layerId => {\n      this.mapFrameworkService.onLayerEvent('click', this.map, layerId, (e) => this.zoomOnClick(e));\n    });\n    this.mapLayers.events.onHover.forEach(layerId => {\n      /** Emits the hovered feature on mousemove. */\n      this.mapFrameworkService.onLayerEvent('mousemove', this.map, layerId, (e) =>\n        this.onFeatureHover.next({ features: e.features, point: [e.lngLat.lng, e.lngLat.lat] }));\n      /** Emits an empty object on mouse leaving a feature. */\n      this.mapFrameworkService.onLayerEvent('mouseleave', this.map, layerId, (e) =>\n        this.onFeatureHover.next({}));\n    });\n    /** Emits the clicked on feature. */\n    this.mapLayers.events.emitOnClick.forEach(layerId => {\n      this.mapFrameworkService.onLayerEvent('click', this.map, layerId, (e) =>\n        this.queryRender(e));\n    });\n    const drawPolygonLayers = [\n      'gl-draw-polygon-stroke-inactive',\n      'gl-draw-polygon-stroke-active',\n      'gl-draw-polygon-stroke-static'\n    ].map(layer => ['.cold', '.hot']\n      .map(id => layer.concat(id)))\n      .reduce((p, ac) => ac.concat(p), []);\n    /** Sets mouse cursor on drawn features */\n    drawPolygonLayers.forEach(layerId => {\n      this.mapFrameworkService.onLayerEvent('mousemove', this.map, layerId, (e) =>\n        this.mapFrameworkService.setMapCursor(this.map, 'pointer'));\n      this.mapFrameworkService.onLayerEvent('mouseleave', this.map, layerId, (e) => {\n        if (this.drawService.isDrawing()) {\n          this.mapFrameworkService.setMapCursor(this.map, 'crosshair');\n        } else {\n          this.mapFrameworkService.setMapCursor(this.map, '');\n        }\n      });\n    });\n  }\n\n  /** Sets the layers order according to the current order of `visualisationSetsConfig` list*/\n  public reorderLayers() {\n    this.mapService.reorderLayers(this.visualisationSetsConfig, this.map);\n  }\n\n  /** @description Display the basemapswitcher */\n  public showBasemapSwitcher() {\n    this.showBasemapList = true;\n  }\n\n  /** @description Emits event notifiying that the basemap has been changed */\n  public onChangeBasemapStyle() {\n    this.onBasemapChanged.next(true);\n  }\n\n  /**\n   * Updates the visibility status of the layer and emits that update.\n   * @param visualisation visualisation set name\n   * @param l layer id\n   * @param visible whether the layer is enabled and visible in the visualisation set\n   */\n  public emitLegendVisibility(visualisation: string, l: string, visible: boolean): void {\n    // Copy the map so the pipe updates the values\n    this.visibilityStatus = new Map(this.visibilityStatus);\n    this.visibilityStatus.set(visualisation + ARLAS_VSET + l, visible);\n    this.legendVisibiltyStatus.next(this.visibilityStatus);\n  }\n\n  /**\n   * @description Emits the visible visualisation set\n   * @param visualisationName Name of the visualisation.\n   */\n  public emitVisualisations(visualisationName: string) {\n    const layers = this.mapService.updateLayoutVisibility(visualisationName, this.visualisationSetsConfig, this.map);\n    this.visualisations.emit(layers);\n    this.reorderLayers();\n  }\n\n  public downloadLayerSource(downaload: { layer: any; downloadType: string; }): void {\n    const downlodedSource = {\n      layerId: downaload.layer.id,\n      layerName: getLayerName(downaload.layer.id),\n      collection: downaload.layer.metadata.collection,\n      sourceName: downaload.layer.source as string,\n      downloadType: downaload.downloadType\n    };\n    this.downloadSourceEmitter.next(downlodedSource);\n  }\n\n  /** puts the visualisation set list in the new order after dropping */\n  public drop(event: CdkDragDrop<string[]>) {\n    moveItemInArray(this.visualisationSetsConfig, event.previousIndex, event.currentIndex);\n    this.reorderLayers();\n  }\n\n  /** puts the layers list in the new order after dropping */\n  public dropLayer(event: CdkDragDrop<string[]>, visuName: string) {\n    const layers = Array.from(this.mapService.findVisualisationSetLayer(visuName, this.visualisationSetsConfig));\n    moveItemInArray(layers, event.previousIndex, event.currentIndex);\n    this.mapService.setVisualisationSetLayers(visuName, layers, this.visualisationSetsConfig);\n    this.reorderLayers();\n  }\n  public hideBasemapSwitcher() {\n    this.showBasemapList = false;\n  }\n  /**\n   * Fit to given bounds. Options are for padding.\n   * @param bounds Bounds of the map to fit to.\n   */\n  public fitToPaddedBounds(bounds: ArlasLngLatBounds) {\n    this.map.fitToPaddedBounds(bounds);\n  }\n  /**\n   * Centers the map to the given latitude/longitude coordinates.\n   * @param lngLat Latitude/longitude coordinates.\n   */\n  public moveToCoordinates(lngLat: [number, number]) {\n    this.map.setCenter(lngLat);\n  }\n  /** Highlights, in all data sources,the feature(s) having the given elementIdentifier */\n  private highlightFeature(featureToHightLight: { isleaving: boolean; elementidentifier: ElementIdentifier; }) {\n    this.mapService.highlightFeature(this.mapLayers, this.map, featureToHightLight);\n  }\n  /** Selects, in all data sources,the feature(s) having the given elementIdentifier */\n  private selectFeatures(elementToSelect: Array<ElementIdentifier>) {\n    this.mapService.selectFeatures(this.mapLayers, this.map, elementToSelect);\n  }\n  /** Selects, in all data sources, all the features having the given elementIdentifiers and under the given collection.\n   * @param features list of features identifiers.\n   * @param collection data collection (metadata of the data source).\n  */\n  public selectFeaturesByCollection(features: Array<ElementIdentifier>, collection: string) {\n    this.mapService.selectFeaturesByCollection(this.mapLayers, this.map, features, collection);\n  }\n\n  public static getMapJsonSchema(): Object {\n    return mapJsonSchema;\n  }\n  /** Destroys all the components subscriptions. */\n  public ngOnDestroy(): void {\n    if (this.map) {\n      this.map.unsubscribeEvents();\n    }\n    this._onDestroy$.next(true);\n    this._onDestroy$.complete();\n  }\n\n  /** @description Enables bbox drawing mode.*/\n  public addGeoBox() {\n    this.drawComponent.addGeoBox();\n  }\n\n  /**\n   * @description Removes all the aois if none of them is selected. Otherwise it removes the selected one only\n   */\n  public removeAois() {\n    this.drawComponent.removeAois();\n  }\n\n  /** @description Deletes the selected drawn geometry. If no drawn geometry is selected, all geometries are deteleted */\n  public deleteSelectedItem() {\n    this.drawComponent.deleteSelectedItem();\n  }\n\n\n  /**\n   * @description Switches to a drawing mode of a DRAW_POLYGON, DRAW_CIRCLE or DRAW_RADIUS_CIRCLE.\n   * @param mode Draw mode (DRAW_POLYGON, DRAW_CIRCLE or DRAW_RADIUS_CIRCLE). Default to DRAW_POLYGON\n   * @param option Mapboxdraw option.\n   */\n  public switchToDrawMode(mode?: string, option?: any) {\n    this.drawComponent.switchToDrawMode(mode, option);\n  }\n\n  /**\n   * @description Switches to direct_select mode.\n   * @param option Mapboxdraw option.\n   */\n  public switchToDirectSelectMode(option?: { featureIds: Array<string>; allowCircleResize: boolean; }\n    | { featureId: string; allowCircleResize: boolean; }) {\n    this.drawComponent.switchToDirectSelectMode(option);\n  }\n\n  /**\n   * @description Switches to simple_select mode.\n   * @param option Mapboxdraw option.\n   */\n  public switchToEditMode() {\n    this.drawComponent.switchToEditMode();\n  }\n\n  /**\n   * @description Returns all the drawn polygons as wkt or geojson.\n   * @param mode 'wkt' | 'geojson'\n   * @returns Wkt string or Geojson object.\n   */\n  public getAllPolygon(mode: 'wkt' | 'geojson') {\n    return this.drawComponent.getAllPolygon(mode);\n  }\n\n  /**\n   * @description returns the selected polygon geometry in WKT or GeoJson given the mode\n   * @param mode : 'wkt' | 'geojson'\n   * @returns Wkt string or Geojson object.\n   */\n  public getSelectedPolygon(mode: 'wkt' | 'geojson') {\n    return this.drawComponent.getSelectedPolygon(mode);\n  }\n}\n","<div id=\"{{id}}\" class=\"map__container\">\n  <div class=\"map__visu-list\" *ngIf=\"visualisationSetsConfig?.length > 0\">\n    <div class=\"map__legend-button\" [matTooltipPosition]=\"'left'\" matTooltip=\"{{'Manage layers' | translate}}\">\n      <mat-icon (click)=\"legendOpen=!legendOpen\" (keyDown)=\"legendOpen=!legendOpen\">layers</mat-icon>\n    </div>\n    <div [hidden]=\"!legendOpen\" class=\"map__visu-list--container\" cdkDropList\n      (cdkDropListDropped)=\"drop($event)\">\n      <div cdkDrag class=\"map__visu-item\" *ngFor=\"let visu of visualisationSetsConfig\">\n        <div cdkDragHandle class=\"map__visu-title\">\n          <span class=\"map__visu-title-text\" [class.map__visu-title-text--disabled]=\"!visu.enabled\">\n            {{visu.name | translate}}</span>\n          <mat-slide-toggle [checked]=\"visu.enabled\" (change)=\"emitVisualisations(visu.name)\"\n            [matTooltip]=\"'show_layers' | translate\" [hideIcon]=\"true\"></mat-slide-toggle>\n        </div>\n        <div class=\"map__visu-content\" cdkDropList (cdkDropListDropped)=\"dropLayer($event, visu.name)\">\n          <div cdkDrag *ngFor=\"let l of visu.layers\" class=\"map__visu-layer\"\n            [class.cdk-visually-hidden]=\"((visu.name + ':arlas_vset:' + l) | getValue:visibilityStatus) !== true\">\n            <div cdkDragHandle class=\"map__visu-layer-drag\">\n              <mat-icon>drag_indicator</mat-icon>\n            </div>\n            <arlas-legend [collection]=\"l | getCollection: mapService.layersMap \" [enabled]=\"visu.enabled\"\n              [layer]=\"l | getValue: mapService.layersMap \" [zoom]=\"map?.zoom\"\n              (visibilityStatus)=\"emitLegendVisibility(visu.name, l, $event)\" [legendUpdater]=\"legendUpdater\"\n              [visibilityUpdater]=\"visibilityUpdater\"\n              (downloadSourceEmitter)=\"downloadLayerSource($event)\"></arlas-legend>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n\n<arlas-coordinates *ngIf=\"displayCurrentCoordinates\" [currentLat]=\"map?.currentLat\" [currentLng]=\"map?.currentLng\"\n  (moveToCoordinates$)=\"moveToCoordinates($event)\"></arlas-coordinates>\n\n<arlas-basemap *ngIf=\"showBasemapList\" [mapSources]=\"mapSources\" [map]=\"map\" (mouseleave)=\"hideBasemapSwitcher()\"\n  (basemapChanged)=\"onChangeBasemapStyle()\"></arlas-basemap>\n\n\n<arlas-draw #drawComponent *ngIf=\"map\" [map]=\"map\" [emptyData]=\"emptyData\" [drawData]=\"drawData\"\n  [drawButtonEnabled]=\"drawButtonEnabled\" [drawOption]=\"drawOption\"\n  [drawPolygonVerticesLimit]=\"drawPolygonVerticesLimit\" [preserveDrawingBuffer]=\"preserveDrawingBuffer\"\n  (onAoiChanged)=\"onAoiChanged.emit($event)\"\n  (onAoiEdit)=\"onAoiEdit.emit($event)\"></arlas-draw>","/*\n * Licensed to Gisaïa under one or more contributor\n * license agreements. See the NOTICE.txt file distributed with\n * this work for additional information regarding copyright\n * ownership. Gisaïa licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { Component, ElementRef, Inject, Input, Output, ViewChild } from '@angular/core';\nimport { MAT_DIALOG_DATA, MatDialog, MatDialogRef } from '@angular/material/dialog';\nimport * as toGeoJSON from '@tmcw/togeojson';\nimport centroid from '@turf/centroid';\nimport JSZip from 'jszip';\nimport { FeatureCollection, polygon } from '@turf/helpers';\nimport { Subject } from 'rxjs';\nimport * as shp_ from 'shpjs/dist/shp';\nimport * as extent_ from 'turf-extent';\nimport { parse } from 'wellknown';\nimport { valid } from 'geojson-validation';\nimport { marker } from '@colsen1991/ngx-translate-extract-marker';\nimport * as gpsi_ from 'geojson-polygon-self-intersections';\nimport { Feature } from 'geojson';\nimport { ArlasMapComponent } from '../arlas-map.component';\nimport { ArlasMapFrameworkService } from '../arlas-map-framework.service';\n\n\nconst gpsi = gpsi_.default;\nconst shp = shp_.default;\nconst extent = extent_.default;\n\n\n@Component({\n  templateUrl: './map-import-dialog.component.html',\n  selector: 'arlas-map-import-dialog',\n  styleUrls: ['./map-import-dialog.component.scss']\n})\nexport class MapImportDialogComponent {\n  public displayError = false;\n  public isRunning = false;\n  public fitResult = false;\n  public errorMessage: string;\n  public errorThreshold: string;\n  public currentFile: File;\n\n  public importType: string;\n  public allowedFileExtension: string;\n  public allowedImportType: string[];\n  public wktContent = '';\n\n  public SHP: string = marker('shp');\n  public KML: string = marker('kml');\n  public WKT: string = marker('wkt');\n  public GEOJSON: string = marker('geojson');\n\n  @Output() public file = new Subject<File>();\n  @Output() public importRun = new Subject<any>();\n  @ViewChild('fileInput', { static: false }) public fileInput: ElementRef;\n\n  public constructor(\n    private dialogRef: MatDialogRef<MapImportDialogComponent>,\n    @Inject(MAT_DIALOG_DATA) private data: { allowedImportType: Array<string>; defaultFitResult?: boolean; }\n  ) {\n    this.fitResult = data.defaultFitResult ?? false;\n    this.allowedImportType = this.data.allowedImportType.filter(t => [this.SHP, this.KML, this.WKT, this.GEOJSON].includes(t));\n\n    if (this.allowedImportType.indexOf(this.SHP) > -1) {\n      this.importType = this.SHP;\n    } else if (this.allowedImportType.indexOf(this.KML) > -1) {\n      this.importType = this.KML;\n    } else if (this.allowedImportType.indexOf(this.WKT) > -1) {\n      this.importType = this.WKT;\n    } else {\n      this.importType = this.GEOJSON;\n    }\n    this.changeType();\n  }\n\n  public onFileChange(files: FileList) {\n    this.file.next(files.item(0));\n    this.currentFile = files.item(0);\n    this.displayError = false;\n  }\n\n  public import() {\n    this.importRun.next({ type: this.importType, fitResult: this.fitResult, wktContent: this.wktContent });\n  }\n\n  public onTextChange() { }\n\n  public changeType() {\n    if (this.importType === this.SHP) {\n      this.allowedFileExtension = '.zip';\n    } else if (this.importType === this.KML) {\n      this.allowedFileExtension = '.kml,.kmz';\n    } else if (this.importType === this.GEOJSON) {\n      this.allowedFileExtension = '.json,.geojson';\n    }\n  }\n\n  public onCancel() {\n    this.dialogRef.close();\n  }\n}\n\nexport type AllowedImportGeometry = 'Polygon' | 'Point';\nconst SIMPLE_GEOMETRY_OBJECT = ['Polygon', 'Point', 'LineString'];\n@Component({\n  selector: 'arlas-map-import',\n  templateUrl: './map-import.component.html',\n  styleUrls: ['./map-import.component.scss']\n})\n/** L: a layer class/interface.\n *  S: a source class/interface.\n *  M: a Map configuration class/interface.\n */\nexport class MapImportComponent<L, S, M> {\n\n  public SHP = 'shp';\n  public KML = 'kml';\n  public WKT = 'wkt';\n  public GEOJSON = 'geojson';\n\n  public SELF_INTERSECT = marker('Geometry is not valid due to self-intersection');\n  public PARSING_ISSUE = marker('Problem parsing input file');\n  public FILE_TOO_LARGE = marker('File is too large');\n  public GEOMETRY_INVALID = marker('Geometry is not valid');\n  public TOO_MANY_VERTICES = marker('Too many vertices in a polygon');\n  public TOO_MANY_FEATURES = marker('Too many features');\n  public TIMEOUT = marker('Timeout');\n\n  public currentFile: File;\n  public dialogRef: MatDialogRef<MapImportDialogComponent>;\n  public reader: FileReader;\n\n  private tooManyVertex = false;\n  private fitResult = false;\n  private jszip: JSZip;\n  private readonly SOURCE_NAME_POLYGON_LABEL = 'polygon_label';\n  private emptyData: FeatureCollection<GeoJSON.Geometry> = {\n    'type': 'FeatureCollection',\n    'features': []\n  };\n  private featureIndex = 0;\n\n  @Input() public mapComponent: ArlasMapComponent<L, S, M>;\n  @Input() public maxVertexByPolygon: number;\n  @Input() public maxFeatures?: number;\n  @Input() public maxFileSize?: number;\n  @Input() public maxLoadingTime = 20000;\n  @Input() public allowedImportType = [this.SHP, this.KML, this.WKT, this.GEOJSON];\n  @Input() public allowedGeometryObjectType: Array<AllowedImportGeometry> = ['Polygon'];\n  @Output() public imported = new Subject<any>();\n  @Output() public error = new Subject<any>();\n  private _currentAllowedGeom: string[];\n  public constructor(\n    public dialog: MatDialog,\n    public mapService: ArlasMapFrameworkService<L, S, M>\n  ) { }\n\n  public promiseTimeout(ms, promise) {\n\n    // Create a promise that rejects in <ms> milliseconds\n    const timeout = new Promise((resolve, reject) => {\n      const id = setTimeout(() => {\n        clearTimeout(id);\n        reject(new Error(this.TIMEOUT));\n      }, ms);\n    });\n\n    // Returns a race between our timeout and the passed in promise\n    return Promise.race([\n      promise,\n      timeout\n    ]);\n  }\n\n  private buildAllowedGeometryForImportType(importType: string) {\n    this._currentAllowedGeom = [];\n    this.allowedGeometryObjectType.forEach(allowed => {\n      this._currentAllowedGeom = this._currentAllowedGeom.concat(this.getAllowedGeom(allowed));\n    });\n    if (importType === this.KML) {\n      this._currentAllowedGeom.push('GeometryCollection', 'MultiGeometry');\n    } else if (importType === this.WKT) {\n      this._currentAllowedGeom.push('GeometryCollection');\n    }\n  }\n\n  private getAllowedGeom(allowed: AllowedImportGeometry): string[] {\n    if (allowed === 'Polygon') {\n      return ['Polygon', 'MultiPolygon'];\n    }\n    if (allowed === 'Point') {\n      return ['Point', 'MultiPoint'];\n    }\n  }\n\n  public openDialog(defaultFitResult?: boolean) {\n    this.dialogRef = this.dialog.open(MapImportDialogComponent,\n      { data: { allowedImportType: this.allowedImportType, defaultFitResult }, panelClass: 'map-import-dialog' });\n    this.dialogRef.componentInstance.file.subscribe((file: File) => {\n      this.currentFile = file;\n    });\n    this.dialogRef.componentInstance.importRun.subscribe(importOptions => {\n      this.fitResult = importOptions.fitResult;\n      this.buildAllowedGeometryForImportType(importOptions.type);\n      this.import(importOptions.type, importOptions.wktContent);\n    });\n  }\n\n  public import(importType: string, content?: string) {\n    this.dialogRef.componentInstance.isRunning = true;\n    this.tooManyVertex = false;\n    this.jszip = new JSZip();\n    let processPromise: Promise<void>;\n    if (importType === this.SHP) {\n      processPromise = this.processAllShape();\n    } else if (importType === this.KML) {\n      processPromise = this.processAllKml();\n    } else if (importType === this.WKT) {\n      processPromise = this.processWKT(content);\n    } else if (importType === this.GEOJSON) {\n      processPromise = this.processJson();\n    }\n    this.promiseTimeout(this.maxLoadingTime, processPromise).catch(error => {\n      if (importType !== this.WKT) {\n        this.reader.abort();\n      }\n      this.throwError(error);\n    });\n  }\n\n  public buildFeature(geom: any, feature: Feature | any, geometryType?: string, bbox?: boolean) {\n    const f = {\n      type: 'Feature',\n      geometry: {\n        coordinates: geom,\n        type: geometryType ?? geom.type\n      },\n      properties: feature.properties\n    };\n\n    if (bbox) {\n      f.geometry['bbox'] = feature.geometry.bbox;\n    }\n    return f;\n  }\n\n  public handleSimpleGeometry(feature, centroids, importedGeojson) {\n    // avoid self intersect control for point\n    if (feature.geometry.type === 'Point' || gpsi(feature).geometry.coordinates.length === 0) {\n      this.addFeature(feature, centroids, importedGeojson, ++this.featureIndex);\n    } else {\n      throw new Error('Geometry is not valid due to self-intersection');\n    }\n  }\n\n  public handleMultiGeometry(feature, centroids, importedGeojson) {\n    // Create a new Polygon feature for each polygon in the MultiPolygon\n    // All properties of the MultiPolygon are copied in each feature created\n    const geomType = (feature.geometry.type === 'MultiPolygon') ? 'Polygon' : 'Point';\n    feature.geometry.coordinates.forEach(geom => {\n      const newFeature = this.buildFeature(geom, feature, geomType, true);\n      this.handleSimpleGeometry(newFeature, centroids, importedGeojson);\n    });\n  }\n\n  public handleGeometryCollection(feature, centroids, importedGeojson) {\n    // Create a new Polygon feature for each polygon in the MultiPolygon\n    // All properties of the MultiPolygon are copied in each feature created\n    const simpleGeometry = this._currentAllowedGeom.filter(g => SIMPLE_GEOMETRY_OBJECT.includes(g));\n    feature.geometry.geometries.filter(geom => simpleGeometry.includes(geom.type)).forEach(geom => {\n      const newFeature = this.buildFeature(geom, feature);\n      this.handleSimpleGeometry(newFeature, centroids, importedGeojson);\n    });\n  }\n\n  public handleFeatureCollection(feature, centroids, importedGeojson) {\n    feature.features.filter(feature => this._currentAllowedGeom.includes(feature.geometry.type))\n      .forEach((feature) => {\n        const multiGeometry = this._currentAllowedGeom.filter(g => !SIMPLE_GEOMETRY_OBJECT.includes(g));\n        if (multiGeometry.includes(feature.geometry.type)) {\n          this.handleMultiGeometry(feature, centroids, importedGeojson);\n        } else {\n          this.handleSimpleGeometry(feature, centroids, importedGeojson);\n        }\n      });\n  }\n\n  /** *************/\n  /** *** KML *****/\n  /** *************/\n  public readKmlFile() {\n    return new Promise<string | ArrayBuffer>((resolve, reject) => {\n      this.reader = new FileReader();\n      const reader = this.reader;\n      reader.onload = () => {\n        resolve(reader.result);\n      };\n      reader.onerror = () => {\n        reader.abort();\n        reject(new Error(this.PARSING_ISSUE));\n      };\n\n      if (this.maxFileSize && this.currentFile.size > this.maxFileSize) {\n        reject(new Error(this.FILE_TOO_LARGE));\n      } else if (this.currentFile.name.split('.').pop().toLowerCase() === this.KML) {\n          reader.readAsText(this.currentFile);\n        } else if (this.currentFile.name.split('.').pop().toLowerCase() === 'kmz') {\n          reader.readAsArrayBuffer(this.currentFile);\n        } else {\n          reject(new Error(marker('Only `kml` or `zip` file is allowed')));\n        }\n    });\n  }\n\n  private resolveFileFromGzip(result, resolve) {\n    this.jszip.loadAsync(result).then(kmzContent => {\n      const kmlFile = Object.keys(kmzContent.files).filter(file => file.split('.').pop().toLowerCase() === this.KML)[0];\n      this.jszip.file(kmlFile).async('text').then((data) => resolve(data));\n    });\n  }\n\n  public processAllKml() {\n    const readKmlFile = this.readKmlFile();\n\n    let readKmzFile = readKmlFile;\n    if (this.currentFile.name.split('.').pop().toLowerCase() === 'kmz') {\n      readKmzFile = readKmlFile.then(result => new Promise<string>((resolve, reject) => {\n      this.resolveFileFromGzip(result, resolve);\n      }));\n    }\n\n    const parseKml = readKmzFile.then((file: string) => new Promise((resolve, reject) => {\n      const geojson = toGeoJSON.kml((new DOMParser()).parseFromString(file, 'text/xml'));\n      resolve(geojson);\n    }));\n    const geojsonParserPromise = parseKml.then((geojson: any) => new Promise<{ geojson: any; centroides: any; }>((resolve, reject) => {\n      this.computeGeojson(geojson, reject, resolve);\n    }));\n\n    return Promise.all<{ geojson: any; centroides: any; }>([geojsonParserPromise])\n      .then(([importedResult]) => {\n        this.setImportedData(importedResult);\n      });\n  }\n\n\n  /** *************/\n  /** * GEOJSON ***/\n  /** *************/\n  public readJsonFile() {\n    return new Promise<string | ArrayBuffer>((resolve, reject) => {\n      this.reader = new FileReader();\n      const reader = this.reader;\n      reader.onload = () => {\n        resolve(reader.result);\n      };\n      reader.onerror = () => {\n        reader.abort();\n        reject(new Error(this.PARSING_ISSUE));\n      };\n\n      if (this.maxFileSize && this.currentFile.size > this.maxFileSize) {\n        reject(new Error(this.FILE_TOO_LARGE));\n      } else {\n        const extension = this.currentFile.name.split('.').pop().toLowerCase();\n        if (extension === 'json' || extension === 'geojson') {\n          reader.readAsText(this.currentFile);\n        } else {\n          reject(new Error(marker('Only `json` or `geojson` file is allowed')));\n        }\n      }\n    });\n  }\n\n  public processJson() {\n    const readJsonFile = this.readJsonFile();\n    const parseJson = readJsonFile.then((fileContent: string) => new Promise<{ geojson: any; centroides: any; }>((resolve, reject) => {\n      const feature = JSON.parse(fileContent);\n      if (valid(feature) && (this._currentAllowedGeom.includes(feature.geometry) || feature.type === 'FeatureCollection')) {\n        const centroides = new Array<any>();\n        const importedGeojson = {\n          type: 'FeatureCollection',\n          features: []\n        };\n        try {\n          if (feature.geometry && (feature.geometry.type === 'Polygon' || feature.geometry.type === 'Point')) {\n            this.handleSimpleGeometry(feature, centroides, importedGeojson);\n          } else if (feature.geometry && (feature.geometry.type === 'MultiPolygon' || feature.geometry.type === 'MultiPoint')) {\n            this.handleMultiGeometry(feature, centroides, importedGeojson);\n          } else if (feature.type && feature.type === 'FeatureCollection') {\n            this.handleFeatureCollection(feature, centroides, importedGeojson);\n          }\n          resolve({ geojson: importedGeojson, centroides: centroides });\n        } catch (e) {\n          reject(e);\n        }\n      } else {\n        reject(new Error(this.GEOMETRY_INVALID));\n      }\n    }));\n\n    return Promise.all<{ geojson: any; centroides: any; }>([parseJson])\n      .then(([importedResult]) => {\n        this.setImportedData(importedResult);\n      });\n  }\n\n  /** *************/\n  /** ** SHAPE ****/\n  /** *************/\n  public readZipFile() {\n    return new Promise((resolve, reject) => {\n      this.reader = new FileReader();\n      const reader = this.reader;\n      reader.onload = () => {\n        const resultToArray = new Uint8Array(<ArrayBuffer>reader.result);\n        if (resultToArray.length === 0) {\n          reader.abort();\n          reject(new Error(marker('File is empty')));\n        } else {\n          resolve(reader.result);\n        }\n      };\n      reader.onerror = () => {\n        reader.abort();\n        reject(new Error(this.PARSING_ISSUE));\n      };\n\n      if (this.maxFileSize && this.currentFile.size > this.maxFileSize) {\n        reject(new Error(this.FILE_TOO_LARGE));\n      } else if (this.currentFile.name.split('.').pop().toLowerCase() !== 'zip') {\n          reject(new Error(marker('Only `zip` file is allowed')));\n        } else {\n          reader.readAsArrayBuffer(this.currentFile);\n        }\n    });\n  }\n\n  private areFilesInvalid(zipResult): boolean {\n    const testArray = Object.keys(zipResult.files).map(fileName => fileName.split('.').pop().toLowerCase());\n    return (testArray.filter(elem => elem === this.SHP || elem === 'shx' || elem === 'dbf').length < 3) &&\n    (testArray.filter(elem => elem === 'json').length !== 1);\n  }\n\n  public processAllShape() {\n    const fileReaderPromise = this.readZipFile();\n\n    const zipLoaderPromise = fileReaderPromise.then((buffer: ArrayBuffer) => new Promise<any>((resolve, reject) => {\n      this.jszip.loadAsync(buffer).then(zipResult => {\n        if (this.areFilesInvalid(zipResult)) {\n          reject(new Error(marker('Zip file must contain at least a `*.shp`, `*.shx` and `*.dbf` or a `*.json`')));\n        } else {\n          resolve(buffer);\n        }\n      });\n    }));\n\n    const shapeParserPromise = zipLoaderPromise\n      .then(buffer => shp(buffer));\n\n    const geojsonParserPromise = shapeParserPromise.then(geojson => new Promise<{ geojson: any; centroides: any; }>((resolve, reject) => {\n      this.computeGeojson(geojson, reject, resolve);\n    }));\n\n    return Promise.all([fileReaderPromise, zipLoaderPromise, shapeParserPromise, geojsonParserPromise])\n      .then(([a, b, c, importedResult]) => {\n        this.setImportedData(importedResult);\n      });\n  }\n\n  /** *************/\n  /** **  WKT  ****/\n  /** *************/\n  public processWKT(wkt: string) {\n    const wktParserPromise = new Promise<{ geojson: any; centroides: any; }>((resolve, reject) => {\n      const geojsonWKT = parse(wkt);\n\n      const centroides = new Array<any>();\n      const importedGeojson = {\n        type: 'FeatureCollection',\n        features: []\n      };\n      if (geojsonWKT && valid(geojsonWKT) && this._currentAllowedGeom.includes(geojsonWKT.type)) {\n        const feature = {\n          type: 'Feature',\n          geometry: geojsonWKT,\n          properties: { arlas_id: null }\n        };\n        this.handleGeom(feature, centroides, importedGeojson, reject);\n        resolve({ geojson: importedGeojson, centroides: centroides });\n      } else {\n        reject(new Error(this.GEOMETRY_INVALID));\n      }\n    });\n\n    return Promise.all([wktParserPromise]).then(([importedResult]) => {\n      this.setImportedData(importedResult);\n    });\n  }\n\n  /** *************/\n  /** ** TOOLS ****/\n  /** *************/\n  public clearPolygons() {\n    // Clean source of imported polygons\n    const labelSource = this.mapService.getSource(this.SOURCE_NAME_POLYGON_LABEL, this.mapComponent.map);\n    this.featureIndex = 0;\n    this.mapComponent.onAoiChanged.next(this.emptyData);\n    if (labelSource !== undefined) {\n      this.mapService.setDataToGeojsonSource(labelSource, this.emptyData);\n    }\n  }\n\n  public addFeature(feature: any, centroides: Array<any>,\n    importedGeojson: { type: string; features: Array<any>; }, index: number) {\n    feature.properties.arlas_id = index;\n    const cent = this.calcCentroid(feature);\n    centroides.push(cent);\n    importedGeojson.features.push(feature);\n  }\n\n  public setImportedData(importedResult) {\n    if (this.tooManyVertex) {\n      throw new Error(this.TOO_MANY_VERTICES);\n    } else if (this.maxFeatures && importedResult.geojson.features.length > this.maxFeatures) {\n      throw new Error(this.TOO_MANY_FEATURES);\n    } else if (importedResult.geojson.features.length > 0) {\n      this.dialogRef.componentInstance.isRunning = false;\n      if (this.fitResult) {\n        this.mapComponent.fitToPaddedBounds(extent(importedResult.geojson));\n      }\n      if (this.mapComponent.drawData.features.length > 0) {\n        this.mapComponent.drawData.features.forEach(df => importedResult.geojson.features.push(df));\n      }\n      this.mapComponent.drawComponent.draw.changeMode('static');\n      this.imported.next(importedResult.geojson.features);\n      this.mapComponent.onAoiChanged.next(importedResult.geojson);\n      this.dialogRef.close();\n    } else {\n      throw new Error(marker('No polygon to display in this file'));\n    }\n  }\n\n  public calcCentroid(feature) {\n    let cent;\n    if (feature.type === 'Point') {\n      cent = centroid(feature);\n    } else {\n      if (!this.maxVertexByPolygon) {\n        this.maxVertexByPolygon = 100;\n      }\n      if (this.maxVertexByPolygon && feature.geometry.coordinates[0].length - 1 > this.maxVertexByPolygon) {\n        this.tooManyVertex = true;\n      }\n      const poly = polygon(feature.geometry.coordinates);\n      cent = centroid(poly);\n    }\n\n    cent.properties.arlas_id = feature.properties.arlas_id;\n    return cent;\n  }\n\n  private throwError(error: Error) {\n    this.dialogRef.componentInstance.displayError = true;\n    this.dialogRef.componentInstance.isRunning = false;\n    this.dialogRef.componentInstance.errorMessage = error.message;\n    switch (this.dialogRef.componentInstance.errorMessage) {\n      case this.TOO_MANY_FEATURES:\n        this.dialogRef.componentInstance.errorThreshold = this.maxFeatures.toString();\n        break;\n      case this.TOO_MANY_VERTICES:\n        this.dialogRef.componentInstance.errorThreshold = this.maxVertexByPolygon.toString();\n        break;\n      case this.FILE_TOO_LARGE:\n        this.dialogRef.componentInstance.errorThreshold = this.formatBytes(this.maxFileSize);\n        break;\n      case this.TIMEOUT:\n        this.dialogRef.componentInstance.errorThreshold = this.maxLoadingTime + ' ms';\n        break;\n      default:\n        this.dialogRef.componentInstance.errorThreshold = '';\n    }\n    if (this.dialogRef.componentInstance.fileInput) {\n      this.dialogRef.componentInstance.fileInput.nativeElement.value = '';\n    }\n    this.dialogRef.componentInstance.currentFile = null;\n    this.error.next(error.message);\n  }\n\n  private formatBytes(bytes, decimals = 2) {\n    if (bytes === 0) {\n      return '0 Bytes';\n    }\n\n    const k = 1024;\n    const dm = decimals < 0 ? 0 : decimals;\n    const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\n\n    return parseFloat((bytes / Math.pow(k, i)).toFixed(dm)) + ' ' + sizes[i];\n  }\n\n  private computeGeojson(geojson: any, reject: (reason?: any) => void,\n    resolve: (value: { geojson: any; centroides: any; } | PromiseLike<{ geojson: any; centroides: any; }>) => void) {\n    if (valid(geojson)) {\n      const centroides = new Array<any>();\n      const importedGeojson = {\n        type: 'FeatureCollection',\n        features: []\n      };\n      geojson.features.filter(feature => this._currentAllowedGeom.includes(feature.geometry.type))\n        .forEach((feature) => {\n          this.handleGeom(feature, centroides, importedGeojson, reject);\n        });\n      resolve({ geojson: importedGeojson, centroides: centroides });\n    } else {\n      reject(new Error('Geometry is not valid'));\n    }\n  }\n\n  private handleGeom(feature: any, centroides: any[], importedGeojson: { type: string; features: any[]; }, reject: (reason?: any) => void) {\n    try {\n      if (feature.geometry.type === 'GeometryCollection' || feature.geometry.type === 'MultiGeometry') {\n        // Create a new Polygon feature for each polygon in the MultiPolygon\n        // All properties of the MultiPolygon are copied in each feature created\n        this.handleGeometryCollection(feature, centroides, importedGeojson);\n      } else if (feature.geometry.type === 'MultiPolygon' || feature.geometry.type === 'MultiPoint') {\n        this.handleMultiGeometry(feature, centroides, importedGeojson);\n      } else {\n        this.handleSimpleGeometry(feature, centroides, importedGeojson);\n      }\n    } catch (e) {\n      reject(new Error('Error during import'));\n    }\n  }\n}\n","<h1 mat-dialog-title class=\"mapgl-import-title\">{{ 'Import file' | translate}}</h1>\n<div mat-dialog-content class=\"mapgl-import-body\">\n  <mat-radio-group class=\"mapgl-import-radio-group\" [(ngModel)]=\"importType\" (change)=\"changeType()\">\n    <mat-radio-button *ngFor=\"let type of allowedImportType\" [value]=\"type\" class=\"mapgl-import-radio-button\">\n      {{ type | translate }}\n    </mat-radio-button>\n  </mat-radio-group>\n\n  <input *ngIf=\"importType !== WKT\" type=\"file\" class=\"mapgl-import-upload\" #fileInput accept=\"{{allowedFileExtension}}\" (change)=\"onFileChange($event.target.files)\">\n  <textarea *ngIf=\"importType === WKT\" class=\"mapgl-import-text-area\" [(ngModel)]=\"wktContent\" placeholder=\"{{'Paste your WKT' | translate}}\" (change)=\"onTextChange()\"></textarea>\n\n  <div class=\"mapgl-import-zoom\">\n    <mat-checkbox [(ngModel)]=\"fitResult\">{{ 'Zoom to result' | translate}}</mat-checkbox>\n  </div>\n  <div *ngIf=\"displayError\" class=\"mapgl-import-error\">\n    {{ errorMessage | translate}} <ng-container *ngIf=\"errorThreshold !== ''\"> - ({{'Max:' | translate }} {{errorThreshold}})</ng-container>\n  </div>\n</div>\n\n<div mat-dialog-actions class=\"mapgl-import-actions\">\n  <button mat-button (click)=\"onCancel()\">{{ 'Cancel' | translate}}</button>\n  <button mat-button [disabled]=\"((importType === SHP || importType === KML || importType === GEOJSON) && !currentFile) || isRunning || (importType === WKT && wktContent === '')\" (click)=\"import()\">{{ 'Import' | translate}}</button>\n  <mat-progress-spinner *ngIf=\"isRunning\" [color]=\"'accent'\" [diameter]=\"40\" [mode]=\"'indeterminate'\">\n  </mat-progress-spinner>\n</div>\n","\n\n","/*\n * Licensed to Gisaïa under one or more contributor\n * license agreements. See the NOTICE.txt file distributed with\n * this work for additional information regarding copyright\n * ownership. Gisaïa licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { MatButtonModule } from '@angular/material/button';\nimport { MatButtonToggleModule } from '@angular/material/button-toggle';\nimport { MatDialogModule } from '@angular/material/dialog';\nimport { MatFormFieldModule } from '@angular/material/form-field';\nimport { MatIconModule } from '@angular/material/icon';\nimport { MatRadioModule } from '@angular/material/radio';\nimport { MatSelectModule } from '@angular/material/select';\nimport { MatTabsModule } from '@angular/material/tabs';\nimport { TranslateModule } from '@ngx-translate/core';\nimport { MapSettingsComponent, MapSettingsDialogComponent } from './map-settings.component';\nimport { GetCollectionDisplayModule } from 'arlas-web-components';\n\n\n@NgModule({\n    imports: [\n        CommonModule,\n        FormsModule,\n        MatTabsModule,\n        MatDialogModule,\n        MatFormFieldModule,\n        MatSelectModule,\n        MatButtonToggleModule,\n        MatIconModule,\n        MatButtonModule,\n        MatRadioModule,\n        ReactiveFormsModule,\n        TranslateModule,\n        GetCollectionDisplayModule\n    ],\n  declarations: [MapSettingsComponent, MapSettingsDialogComponent],\n  exports: [MapSettingsComponent]\n})\nexport class MapSettingsModule {\n\n}\n","/*\n * Licensed to Gisaïa under one or more contributor\n * license agreements. See the NOTICE.txt file distributed with\n * this work for additional information regarding copyright\n * ownership. Gisaïa licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { FormsModule } from '@angular/forms';\nimport { MatButtonModule } from '@angular/material/button';\nimport { MatCheckboxModule } from '@angular/material/checkbox';\nimport { MatDialogModule } from '@angular/material/dialog';\nimport { MatProgressSpinnerModule } from '@angular/material/progress-spinner';\nimport { MatRadioModule } from '@angular/material/radio';\nimport { MatSelectModule } from '@angular/material/select';\nimport { TranslateModule } from '@ngx-translate/core';\nimport { MapImportComponent, MapImportDialogComponent } from './map-import.component';\n\n\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    MatButtonModule,\n    MatCheckboxModule,\n    MatDialogModule,\n    MatProgressSpinnerModule,\n    MatSelectModule,\n    MatRadioModule,\n    TranslateModule\n  ],\n  declarations: [MapImportComponent, MapImportDialogComponent],\n  exports: [MapImportComponent]\n})\nexport class MapImportModule {\n\n}\n","/*\n * Licensed to Gisaïa under one or more contributor\n * license agreements. See the NOTICE.txt file distributed with\n * this work for additional information regarding copyright\n * ownership. Gisaïa licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { CommonModule } from '@angular/common';\nimport { MatIconModule } from '@angular/material/icon';\nimport { TranslateModule } from '@ngx-translate/core';\nimport { NgModule } from '@angular/core';\nimport { BasemapComponent } from './basemap.component';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    MatIconModule,\n    TranslateModule\n  ],\n  declarations: [BasemapComponent],\n  exports: [BasemapComponent]\n})\nexport class BasemapModule {\n\n}\n","/*\n * Licensed to Gisaïa under one or more contributor\n * license agreements. See the NOTICE.txt file distributed with\n * this work for additional information regarding copyright\n * ownership. Gisaïa licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { CommonModule } from '@angular/common';\nimport { MatIconModule } from '@angular/material/icon';\nimport { TranslateModule } from '@ngx-translate/core';\nimport { NgModule } from '@angular/core';\nimport { CoordinatesComponent } from './coordinates.component';\nimport { MatFormFieldModule } from '@angular/material/form-field';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { MatTooltipModule } from '@angular/material/tooltip';\nimport { MatInputModule } from '@angular/material/input';\nimport { CoordinatesErrorPipe } from './coordinates.pipe';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    MatIconModule,\n    MatFormFieldModule,\n    FormsModule,\n    ReactiveFormsModule,\n    MatTooltipModule,\n    MatInputModule,\n    TranslateModule\n  ],\n  declarations: [CoordinatesComponent, CoordinatesErrorPipe],\n  exports: [CoordinatesComponent]\n})\nexport class CoordinatesModule {\n\n}\n","/*\n * Licensed to Gisaïa under one or more contributor\n * license agreements. See the NOTICE.txt file distributed with\n * this work for additional information regarding copyright\n * ownership. Gisaïa licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { DragDropModule } from '@angular/cdk/drag-drop';\nimport { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { MatFormFieldModule } from '@angular/material/form-field';\nimport { MatIconModule } from '@angular/material/icon';\nimport { MatMenuModule } from '@angular/material/menu';\nimport { MatSlideToggleModule } from '@angular/material/slide-toggle';\nimport { MatSnackBarModule } from '@angular/material/snack-bar';\nimport { MatTooltipModule } from '@angular/material/tooltip';\nimport { MarkerModule } from '@colsen1991/ngx-translate-extract-marker/extras';\nimport { TranslateModule } from '@ngx-translate/core';\nimport {\n  ArlasColorService, FormatNumberModule,\n  GetCollectionDisplayModule, GetColorModule, GetValueModule\n} from 'arlas-web-components';\nimport { ArlasMapComponent } from './arlas-map.component';\nimport { GetCollectionPipe } from './arlas-map.pipe';\nimport { BasemapModule } from './basemaps/basemap.module';\nimport { CoordinatesModule } from './coordinates/coordinates.module';\nimport { ArlasDrawComponent } from './draw/arlas-draw.component';\nimport { MapboxAoiDrawService } from './draw/draw.service';\nimport { FormatLegendPipe } from './legend/format-legend.pipe';\nimport { LayerIdToName } from './legend/layer-name.pipe';\nimport { LayerIconComponent } from './legend/legend-icon/layer-icon.component';\nimport { LegendItemComponent } from './legend/legend-item/legend-item.component';\nimport { LegendComponent } from './legend/legend.component';\nimport { MapImportComponent } from './map-import/map-import.component';\nimport { MapImportModule } from './map-import/map-import.module';\nimport { MapSettingsComponent } from './map-settings/map-settings.component';\nimport { MapSettingsModule } from './map-settings/map-settings.module';\n\n\n@NgModule({\n  declarations: [\n    ArlasMapComponent,\n    LayerIconComponent,\n    LegendComponent,\n    LegendItemComponent,\n    ArlasDrawComponent,\n    LayerIdToName,\n    GetCollectionPipe,\n    FormatLegendPipe\n  ],\n  imports: [\n    MatSnackBarModule,\n    TranslateModule,\n    MatIconModule,\n    MatMenuModule,\n    MatSlideToggleModule,\n    MatTooltipModule,\n    MatFormFieldModule,\n    GetCollectionDisplayModule,\n    GetColorModule,\n    DragDropModule,\n    GetValueModule,\n    FormatNumberModule,\n    CommonModule,\n    CoordinatesModule,\n    MapSettingsModule,\n    MapImportModule,\n    BasemapModule,\n    MarkerModule\n  ],\n  providers: [\n    MapboxAoiDrawService,\n    ArlasColorService\n  ],\n  exports: [\n    LayerIconComponent,\n    LegendComponent,\n    LegendItemComponent,\n    LayerIdToName,\n    ArlasMapComponent,\n    MapImportComponent,\n    MapSettingsComponent,\n    GetCollectionPipe,\n    FormatLegendPipe\n  ]\n})\nexport class ArlasMapModule { }\n","/*\n * Licensed to Gisaïa under one or more contributor\n * license agreements. See the NOTICE.txt file distributed with\n * this work for additional information regarding copyright\n * ownership. Gisaïa licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { Pipe, PipeTransform } from '@angular/core';\nimport { FormControl, FormGroup } from '@angular/forms';\nimport { marker } from '@colsen1991/ngx-translate-extract-marker';\nimport { BboxFormGroup } from './bbox-generator.utils';\n\n@Pipe({\n  name: 'bboxFormError'\n})\nexport class BboxFormErrorPipe implements PipeTransform {\n\n  public transform(formControl: FormControl | FormGroup): string {\n    if (formControl.hasError('required')) {\n      return marker('You must enter a coordinate');\n    } else if ((formControl as BboxFormGroup).latitudeErrors) {\n      return marker('Both corners have the same latitudes, modify one of them.');\n    }\n    return formControl.hasError('pattern') ? marker('Enter a coordinate in decimal (1.1) or sexagesimal (1° 6\\' 3\")') : '';\n  }\n\n}\n","/*\n * Licensed to Gisaïa under one or more contributor\n * license agreements. See the NOTICE.txt file distributed with\n * this work for additional information regarding copyright\n * ownership. Gisaïa licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { FormGroup } from '@angular/forms';\nimport { Coordinate, PointFormGroup } from './coordinates.tools';\nimport { Corner } from '../draw/draw.models';\nimport { Subscription } from 'rxjs';\n\n\nexport class BboxFormGroup extends FormGroup {\n\n  private firstCornerLatitude: string;\n  private secondCornerLatitude: string;\n  public firstCorner: PointFormGroup;\n  public secondCorner: PointFormGroup;\n  public latitudeErrors = false;\n\n  public subscriptions = new Array<Subscription>();\n\n  public constructor(corner: Corner) {\n    const firstCorner = new PointFormGroup(corner.lat - 0.5, corner.lng - 0.5);\n    const secondCorner = new PointFormGroup(corner.lat + 0.5, corner.lng + 0.5);\n    super({\n      firstCorner,\n      secondCorner\n    });\n    this.firstCorner = firstCorner;\n    this.secondCorner = secondCorner;\n\n    const latSub = this.firstCorner.latitude.valueChanges.subscribe(v => {\n      this.firstCornerLatitude = v;\n      this.secondCornerLatitude = this.secondCorner.latitude.value;\n      if (this.secondCornerLatitude !== undefined) {\n        if (Coordinate.parse(this.firstCornerLatitude) === Coordinate.parse(this.secondCornerLatitude)) {\n          this.latitudeErrors = true;\n        } else {\n          this.latitudeErrors = false;\n        }\n      }\n    });\n    this.subscriptions.push(latSub);\n\n    const lonSub = this.secondCorner.latitude.valueChanges.subscribe(v => {\n      this.secondCornerLatitude = v;\n      this.firstCornerLatitude = this.firstCorner.latitude.value;\n      if (this.firstCornerLatitude !== undefined) {\n        if (Coordinate.parse(this.firstCornerLatitude) === Coordinate.parse(this.secondCornerLatitude)) {\n          this.latitudeErrors = true;\n        } else {\n          this.latitudeErrors = false;\n        }\n      }\n    });\n    this.subscriptions.push(lonSub);\n  }\n\n  public getFirstCorner(): Corner {\n    return {\n      lat: Coordinate.parse(this.firstCorner.latitude.value),\n      lng: Coordinate.parse(this.firstCorner.longitude.value)\n    };\n  }\n\n  public getSecondCorner(): Corner {\n    return {\n      lat: Coordinate.parse(this.secondCorner.latitude.value),\n      lng: Coordinate.parse(this.secondCorner.longitude.value)\n    };\n  }\n}\n\n\n","/*\n * Licensed to Gisaïa under one or more contributor\n * license agreements. See the NOTICE.txt file distributed with\n * this work for additional information regarding copyright\n * ownership. Gisaïa licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { AfterViewInit, ChangeDetectorRef, Component, Inject, OnDestroy, OnInit } from '@angular/core';\nimport { MAT_DIALOG_DATA, MatDialogRef } from '@angular/material/dialog';\nimport { BboxFormGroup } from './bbox-generator.utils';\nimport { marker } from '@colsen1991/ngx-translate-extract-marker';\nimport { MapboxAoiDrawService } from '../draw/draw.service';\nimport { Corner } from '../draw/draw.models';\n\n@Component({\n  selector: 'arlas-bbox-generator',\n  templateUrl: './bbox-generator.component.html',\n  styleUrls: ['./bbox-generator.component.scss']\n})\nexport class BboxGeneratorComponent implements OnInit, AfterViewInit, OnDestroy {\n  /**\n   * @constant\n   */\n  public DESCRIPTION = marker('Enter coordinates in decimal or sexagesimal degrees');\n  public bboxForm: BboxFormGroup;\n  /**\n   * @constant\n   */\n  public placeHolder = marker('Decimal: 1.1 or Sexagesimal 1°6\\'3\" coordinate');\n  public constructor(\n    private drawService: MapboxAoiDrawService,\n    private cdr: ChangeDetectorRef,\n    @Inject(MAT_DIALOG_DATA) public data: {\n      initCorner: Corner;\n    },\n    public dialogRef: MatDialogRef<BboxGeneratorComponent>,) {\n  }\n\n  public ngOnInit(): void {\n    if (!!this.data && !this.data.initCorner) {\n      this.data.initCorner = {\n        lat: 0,\n        lng: 0\n      };\n    }\n    this.bboxForm = new BboxFormGroup(this.data.initCorner);\n  }\n  public ngAfterViewInit(): void {\n    this.cdr.detectChanges();\n  }\n\n  public ngOnDestroy(): void {\n    this.bboxForm.subscriptions.forEach(s => s.unsubscribe());\n  }\n\n  public close() {\n    this.dialogRef.close();\n  }\n\n  public generateBbox() {\n    this.drawService.drawBbox(this.bboxForm.getFirstCorner(), this.bboxForm.getSecondCorner());\n    this.dialogRef.close();\n  }\n\n}\n","<div class=\"wrapper\">\n    <div class=\"title-wrapper\">\n        <span>{{'BBox generator' | translate}}</span>\n        <mat-icon class=\"clear\" (click)=\"close()\" (keyDown)=\"close()\">clear</mat-icon>\n    </div>\n    <div class=\"content\">\n        <div class=\"description\">\n            <mat-icon>info</mat-icon>\n            <span>{{DESCRIPTION | translate}}</span>\n        </div>\n        <div class=\"section\" *ngIf=\"bboxForm?.firstCorner\" [formGroup]=\"bboxForm?.firstCorner\">\n            <div class=\"title\">{{'First corner' | translate}}</div>\n            <div class=\"coordinate\">\n                <mat-form-field appearance=\"outline\" >\n                    <mat-label>{{'Latitude' |translate}}</mat-label>\n                    <input class=\"input\"  matInput [formControl]=\"bboxForm.firstCorner.latitude\" [placeholder]=\"placeHolder | translate\">\n                    <mat-error *ngIf=\"bboxForm.firstCorner.latitude.invalid\">{{bboxForm.firstCorner.latitude | bboxFormError | translate}}</mat-error>\n                </mat-form-field>\n            </div>\n            <div class=\"coordinate\">\n                <mat-form-field appearance=\"outline\">\n                    <mat-label>{{'Longitude'|translate }}</mat-label>\n                    <input class=\"input\"  matInput [formControl]=\"bboxForm.firstCorner.longitude\" [placeholder]=\"placeHolder | translate\">\n                    <mat-error *ngIf=\"bboxForm.firstCorner.longitude.invalid\">{{bboxForm.firstCorner.longitude | bboxFormError | translate}}</mat-error>\n                </mat-form-field>\n            </div>\n        </div>\n        <div class=\"section\" *ngIf=\"bboxForm?.secondCorner\" [formGroup]=\"bboxForm?.secondCorner\">\n            <div class=\"title\">{{'Second corner' | translate}}</div>\n            <div class=\"coordinate\">\n                <mat-form-field appearance=\"outline\" >\n                    <mat-label>{{'Latitude' | translate}}</mat-label>\n                    <input class=\"input\"  matInput [formControl]=\"bboxForm.secondCorner.latitude\" [placeholder]=\"placeHolder | translate\">\n                    <mat-error *ngIf=\"bboxForm.secondCorner.latitude.invalid\">{{bboxForm.secondCorner.latitude | bboxFormError | translate}} </mat-error>\n                </mat-form-field>\n            </div>\n            <div class=\"coordinate\">\n                <mat-form-field appearance=\"outline\">\n                    <mat-label>{{'Longitude' | translate}}</mat-label>\n                    <input class=\"input\"  matInput [formControl]=\"bboxForm.secondCorner.longitude\" [placeholder]=\"placeHolder | translate\">\n                    <mat-error *ngIf=\"bboxForm.secondCorner.longitude.invalid\">{{bboxForm.secondCorner.longitude | bboxFormError | translate}}</mat-error>\n                </mat-form-field>\n            </div>\n\n\n        </div>\n        <div class=\"errors\" *ngIf=\"bboxForm.latitudeErrors\">\n            <mat-icon>report</mat-icon>\n            <mat-error>{{bboxForm | bboxFormError | translate}}</mat-error>\n        </div>\n    </div>\n    <div class=\"actions\">\n        <button mat-button [mat-dialog-close]=\"null\">{{'Close' | translate}}\n        </button>\n        <button class=\"create-action\" mat-stroked-button (click)=\"generateBbox()\"\n            [disabled]=\"bboxForm.invalid || bboxForm.latitudeErrors\">\n            <span class=\"label\">{{'Generate AOI' | translate}}</span>\n        </button>\n    </div>\n</div>","/*\n * Licensed to Gisaïa under one or more contributor\n * license agreements. See the NOTICE.txt file distributed with\n * this work for additional information regarding copyright\n * ownership. Gisaïa licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { CommonModule } from '@angular/common';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { MatButtonModule } from '@angular/material/button';\nimport { MatDialogModule } from '@angular/material/dialog';\nimport { MatFormFieldModule } from '@angular/material/form-field';\nimport { MatIconModule } from '@angular/material/icon';\nimport { TranslateModule } from '@ngx-translate/core';\nimport { BboxGeneratorComponent } from './bbox-generator.component';\nimport { NgModule } from '@angular/core';\nimport { MatInputModule } from '@angular/material/input';\nimport { BboxFormErrorPipe } from './bbox-form-error.pipe';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    MatDialogModule,\n    MatFormFieldModule,\n    MatIconModule,\n    MatButtonModule,\n    MatInputModule,\n    ReactiveFormsModule,\n    TranslateModule\n  ],\n  declarations: [BboxGeneratorComponent, BboxFormErrorPipe],\n  exports: [BboxGeneratorComponent, BboxFormErrorPipe]\n})\nexport class BboxGeneratorModule {\n\n}\n","/*\n * Licensed to Gisaïa under one or more contributor\n * license agreements. See the NOTICE.txt file distributed with\n * this work for additional information regarding copyright\n * ownership. Gisaïa licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport MapboxDraw from '@mapbox/mapbox-gl-draw';\nimport { AbstractArlasMapGL } from '../map/AbstractArlasMapGL';\nimport { Feature, FeatureCollection, Geometry } from '@turf/helpers';\n\nexport type DrawEvents = 'draw.create' | 'draw.delete' | 'draw.combine' | 'draw.uncombine' |\n  'draw.update' | 'draw.selectionchange' | 'draw.modechange' | 'draw.render' | 'draw.actionable' |\n  'draw.edit.saveInitialFeature' | 'draw.onClick' | 'draw.onStart' | 'draw.onStop'\n  | 'draw.invalidGeometry';\n\nexport type DrawModes = 'SIMPLE_SELECT' | 'DRAW_CIRCLE' | 'DIRECT_SELECT' |\n  'DRAW_LINE_STRING' | 'DRAW_POLYGON' | 'DRAW_POINT' | 'DRAW_RADIUS_CIRCLE' |\n  'DRAW_STRIP' | 'DIRECT_STRIP'| 'DRAW_RECTANGLE' | 'STATIC';\n\nexport interface DrawEventsInterface {\n  onDrawCreate: (...args) => void;\n  onDrawUpdate: (...args) => void;\n  onDrawDelete: (...args) => void;\n  onDrawOnClick: (...args) => void;\n  onDrawOnStart: (...args) => void;\n  onDrawOnStop: (...args) => void;\n  onDrawInvalidGeometry: (...args) => void;\n  onDrawEditSaveInitialFeature: (...args) => void;\n  onDrawSelectionchange: (...args) => void;\n  onDrawModeChange: (...args) => void;\n}\n\nexport class AbstractDraw implements DrawEventsInterface {\n  protected config;\n  public arlasMap: AbstractArlasMapGL;\n  public enabled: boolean;\n  public drawProvider: MapboxDraw;\n  public constructor(config: any, enabled: boolean, map: AbstractArlasMapGL) {\n    const modes = MapboxDraw.modes;\n    this.config = JSON.parse(JSON.stringify(config));\n    this.config.modes = Object.assign(modes, config.modes);\n    this.drawProvider = new MapboxDraw(this.config);\n    this.arlasMap = map;\n    this.enabled = enabled;\n  }\n\n  public onAdd(map) {\n    const controlContainer = this.drawProvider.onAdd(map);\n    if (!this.enabled) {\n      controlContainer.className += ' draw-control-disabled';\n    }\n    return controlContainer;\n  }\n\n  public onRemove(map) {\n    return this.drawProvider.onRemove(map);\n  }\n\n  public setMode(drawModes: DrawModes, replaceMode: any) {\n    this.drawProvider.modes[drawModes] = replaceMode;\n  }\n\n  public getAllFeatures() {\n    return this.getAll().features;\n  }\n\n  public onDrawCreate(fn: (e) => void): void {\n    this.on('draw.create', (e) => {\n      fn(e);\n    });\n  }\n\n  public onDrawDelete(fn: (e) => void): void {\n    this.on('draw.delete', (e) => {\n      fn(e);\n    });\n  }\n\n  public onDrawEditSaveInitialFeature(fn: (e) => void): void {\n    this.on('draw.edit.saveInitialFeature', (e) => {\n      fn(e);\n    });\n  }\n\n  public onDrawInvalidGeometry(fn: (e) => void): void {\n    this.on('draw.invalidGeometry', (e) => {\n      fn(e);\n    });\n  }\n\n  public onDrawModeChange(fn: (e) => void): void {\n    this.on('draw.modechange', (e) => {\n      fn(e);\n    });\n  }\n\n  public onDrawOnClick(fn: (e) => void): void {\n    this.on('draw.onClick', (e) => {\n      fn(e);\n    });\n  }\n\n  public onDrawOnStart(fn: (e) => void): void {\n    this.on('draw.onStart', (e) => {\n      fn(e);\n    });\n  }\n\n  public onDrawOnStop(fn: (e) => void): void {\n    this.on('draw.onStop', (e) => {\n      fn(e);\n    });\n  }\n\n  public onDrawSelectionchange(fn: (e) => void): void {\n    this.on('draw.selectionchange', (e) => {\n      fn(e);\n    });\n  }\n\n  public onDrawUpdate(fn: (e) => void): void {\n    this.on('draw.update', (e) => {\n      fn(e);\n    });\n  }\n\n  public getMode(modes: DrawModes) {\n    return this.drawProvider.modes[modes];\n  }\n\n  public on(event: DrawEvents, func: (e) => void): void {\n    this.arlasMap.on(event, func);\n  }\n\n  public add(feature: Feature<Geometry> | FeatureCollection<GeoJSON.Geometry>) {\n    this.drawProvider.add(feature);\n  }\n\n  public get(featureId: string): Feature | undefined {\n    return this.drawProvider.get(featureId);\n  }\n\n  public delete(ids: string | Array<string>): this {\n    this.drawProvider.delete(ids);\n    return this;\n  }\n  public deleteAll(): this {\n    this.drawProvider.deleteAll();\n    return this;\n  }\n\n  public set(featureCollection: FeatureCollection): Array<string> {\n    return this.drawProvider.set(featureCollection);\n  }\n\n  public trash(): this {\n    this.drawProvider.trash();\n    return this;\n  }\n\n  public combineFeatures(): this {\n    this.drawProvider.combineFeatures();\n    return this;\n  }\n  public uncombineFeatures(): this {\n    this.drawProvider.uncombineFeatures();\n    return this;\n  }\n\n  public getCurrentMode(): string {\n    return this.drawProvider.getMode();\n  }\n\n  public getFeatureIdsAt(point: { x: number; y: number; }): Array<string> {\n    return this.drawProvider.getFeatureIdsAt(point);\n  }\n\n  public getSelectedIds(): Array<string> {\n    return this.drawProvider.getSelectedIds();\n  }\n\n  public getSelected() {\n    return this.drawProvider.getSelected();\n  }\n\n  public getAll() {\n    return this.drawProvider.getAll();\n  }\n\n  public getSelectedFeatures() {\n    return this.getSelected().features;\n  }\n\n  public setFeatureProperty(featureId: string, property: string, value: any): this {\n    this.drawProvider.setFeatureProperty(featureId, property, value);\n    return this;\n  }\n\n  public changeMode(mode: string, opt?: any): this {\n    this.drawProvider.changeMode(mode, opt);\n    return this;\n  }\n}\n","/*\n * Licensed to Gisaïa under one or more contributor\n * license agreements. See the NOTICE.txt file distributed with\n * this work for additional information regarding copyright\n * ownership. Gisaïa licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { marker } from '@colsen1991/ngx-translate-extract-marker';\n\n\n/** All the map controls configuration\n * These interfaces are generic.\n */\n\nexport type ControlPosition = 'top-right' | 'top-left' | 'bottom-right' | 'bottom-left';\n\nexport interface IconConfig {\n  path: string;\n  recolorable?: boolean;\n}\n\nexport interface ConfigControls {\n  enable: boolean;\n  position?: ControlPosition;\n  config?: any;\n  overrideEvent?: { event: any; fn: (e) => void; };\n}\n\nexport interface PitchToggleConfigControls extends ConfigControls {\n  enable: boolean;\n  position?: ControlPosition;\n  config: { bearing: number; pitch: number; minpitchzoom: number; };\n  overrideEvent?: { event: any; fn: (e?) => void; };\n}\n\nexport interface ControlsOption {\n  mapAttribution?: ConfigControls;\n  scale?: ConfigControls;\n  pitchToggle?: PitchToggleConfigControls;\n  navigationControl?: ConfigControls;\n}\n\nexport interface DrawConfigControl extends ConfigControls {\n  name?: string;\n}\n\nexport interface DrawControlsOption {\n  draw: { control: any; position?: ControlPosition; };\n  addGeoBox: DrawConfigControl;\n  removeAois: DrawConfigControl;\n}\n\nexport class PitchToggle {\n  public bearing: number;\n  public pitch: number;\n  public minpitchzoom: number;\n  public map: any;\n  public btn: HTMLButtonElement;\n  public container: HTMLDivElement;\n\n  public image3D = 'url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMCIgaGVpZ2h0PSIzM' +\n    'CI+ICAgIDx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBkeT0iLjM1ZW0iIHN0eWxlPSJmb250LXNpemU6IDE0cHg7IGZvbnQtZmFtaWx5OiAnSGVsdmV0aWNhIE5ldWUnLEFya' +\n    'WFsLEhlbHZldGljYSxzYW5zLXNlcmlmOyBmb250LXdlaWdodDogYm9sZDsgdGV4dC1hbmNob3I6IG1pZGRsZTsiPjNEPC90ZXh0Pjwvc3ZnPg==)';\n  public image2D = 'url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMCIgaGVpZ2h0PSIzM' +\n    'CI+ICAgIDx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBkeT0iLjM1ZW0iIHN0eWxlPSJmb250LXNpemU6IDE0cHg7IGZvbnQtZmFtaWx5OiAnSGVsdmV0aWNhIE5ldWUnLEFyaWF' +\n    'sLEhlbHZldGljYSxzYW5zLXNlcmlmOyBmb250LXdlaWdodDogYm9sZDsgdGV4dC1hbmNob3I6IG1pZGRsZTsiPjJEPC90ZXh0Pjwvc3ZnPg==)';\n\n  public btnClasses: string[] = [];\n  public containerClasses: string[] = [];\n\n  public constructor(bearing, pitch, minpitchzoom) {\n    this.bearing = bearing;\n    this.pitch = pitch;\n    this.minpitchzoom = minpitchzoom;\n    this._buildClasses();\n  }\n\n  protected _buildClasses() {\n    this.btnClasses = [];\n    this.containerClasses = [];\n  }\n\n  public onAdd(map) {\n    this.map = map;\n    this.btn = document.createElement('button');\n    this.btn.className = this.btnClasses.join(' ');\n    this.btn.style.backgroundImage = this.image3D;\n    this.btn.type = 'button';\n    this.btn['aria-label'] = marker('Toggle Pitch');\n    this.btn.onclick = () => {\n      if (map.getPitch() === 0) {\n        const options = { pitch: this.pitch, bearing: this.bearing, minpitchzoom: null };\n        if (this.minpitchzoom && map.getZoom() > this.minpitchzoom) {\n          options.minpitchzoom = this.minpitchzoom;\n        }\n        map.easeTo(options);\n        this.btn.style.backgroundImage = this.image2D;\n      } else {\n        map.easeTo({ pitch: 0, bearing: 0 });\n        this.btn.style.backgroundImage = this.image3D;\n      }\n    };\n    this.container = document.createElement('div');\n    this.container.className = this.containerClasses.join(' ');\n    this.container.appendChild(this.btn);\n    return this.container;\n  }\n\n  public onRemove() {\n    this.container.parentNode.removeChild(this.container);\n    this.map = undefined;\n  }\n}\n\nexport class ControlButton {\n  public map: any;\n  public btn: HTMLButtonElement;\n  public container: HTMLDivElement;\n  public icon;\n  public name;\n  private tooltip;\n  public btnClasses: string[] = [];\n  public containerClasses: string[] = [];\n  public constructor(name: string, tooltip?: string) {\n    this.name = name;\n    this.tooltip = tooltip;\n    this._buildClasses();\n  }\n\n  protected _buildClasses() {\n    this.btnClasses = [];\n    this.containerClasses = [];\n  }\n  public onAdd(map) {\n    this.map = map;\n    this.btn = document.createElement('button');\n    this.btn.className = this.btnClasses.join(' ');\n    this.btn.type = 'button';\n    this.btn.id = 'layers_switcher_btn';\n    this.container = document.createElement('div');\n    this.container.className = this.containerClasses.join(' ');\n    this.container.setAttribute('title', this.tooltip);\n    this.container.appendChild(this.btn);\n    return this.container;\n  }\n  public onRemove() {\n    this.container.parentNode.removeChild(this.container);\n    this.map = undefined;\n  }\n}\n","/*\n * Licensed to Gisaïa under one or more contributor\n * license agreements. See the NOTICE.txt file distributed with\n * this work for additional information regarding copyright\n * ownership. Gisaïa licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\n\n/** Data source of a layer */\nexport class ArlasMapSource<SourceType> {\n  public id: string;\n  public source: string | SourceType;\n}\n","/*\n * Licensed to Gisaïa under one or more contributor\n * license agreements. See the NOTICE.txt file distributed with\n * this work for additional information regarding copyright\n * ownership. Gisaïa licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { ArlasPaint, PaintValue } from '../model/layers';\n\n\n/** This file describes how to style a vector layer */\n\nexport enum VectorStyleEnum {\n    circle = 'circle',\n    fill = 'fill',\n    line = 'line'\n}\n\nexport class VectorStyle {\n    public type: VectorStyleEnum;\n    public style: ArlasPaint;\n    public constructor(type: VectorStyleEnum, style: ArlasPaint) {\n        this.type = type;\n        this.style = style;\n    }\n}\n","\n/*\n * Licensed to Gisaïa under one or more contributor\n * license agreements. See the NOTICE.txt file distributed with\n * this work for additional information regarding copyright\n * ownership. Gisaïa licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n/*\n * Public API Surface of arlas-map\n */\n\nexport {\n  MapSettingsComponent, MapSettingsService, GeoQuery, GeometrySelectModel, OperationSelectModel, MapSettingsDialogComponent,\n  GeoQueryOperator\n} from './lib/map-settings/map-settings.component';\nexport {\n  AllowedImportGeometry, MapImportComponent, MapImportDialogComponent\n} from './lib/map-import/map-import.component';\nexport { MapSettingsModule } from './lib/map-settings/map-settings.module';\nexport { MapImportModule } from './lib/map-import/map-import.module';\nexport { GetCollectionPipe } from './lib/arlas-map.pipe';\nexport { LayerIdToName } from './lib/legend/layer-name.pipe';\nexport { LegendService } from './lib/legend/legend.service';\nexport { ArlasMapModule } from './lib/arlas-map.module';\nexport { LegendItemComponent } from './lib/legend/legend-item/legend-item.component';\nexport { LegendComponent } from './lib/legend/legend.component';\nexport { LayerIconComponent } from './lib/legend/legend-icon/layer-icon.component';\nexport * from './lib/arlas-map-framework.service';\nexport * from './lib/arlas-map.component';\nexport * from './lib/arlas-map.module';\nexport { CoordinatesComponent } from './lib/coordinates/coordinates.component';\nexport { CoordinatesErrorPipe } from './lib/coordinates/coordinates.pipe';\nexport { BasemapComponent } from './lib/basemaps/basemap.component';\nexport { BasemapStyle } from './lib/basemaps/basemap.config';\nexport { BasemapService } from './lib/basemaps/basemap.service';\nexport { ArlasBasemaps } from './lib/basemaps/basemaps.model';\nexport { BboxFormErrorPipe } from './lib/bbox-generator/bbox-form-error.pipe';\nexport { BboxGeneratorComponent } from './lib/bbox-generator/bbox-generator.component';\nexport { BboxGeneratorModule } from './lib/bbox-generator/bbox-generator.module';\nexport { BboxFormGroup } from './lib/bbox-generator/bbox-generator.utils';\nexport { Coordinate } from './lib/bbox-generator/coordinates.tools';\nexport { AbstractDraw } from './lib/draw/AbstractDraw';\nexport { AoiDimensions as AoiEdition, Corner } from './lib/draw/draw.models';\nexport { MapboxAoiDrawService } from './lib/draw/draw.service';\nexport { limitVertexDirectSelectMode } from './lib/draw/modes/LimitVertexDirectSelectMode';\nexport { validGeomDrawPolygonMode } from './lib/draw/modes/ValidGeomDrawPolygonMode';\nexport { directModeOverride } from './lib/draw/modes/directSelectOverride';\nexport { simpleSelectModeOverride } from './lib/draw/modes/simpleSelectOverride';\nexport { circleMode } from './lib/draw/modes/circles/circle.mode';\nexport { radiusCircleMode } from './lib/draw/modes/circles/radius.circle.mode';\nexport { createSupplementaryPointsForCircle, dragPan } from './lib/draw/modes/circles/utils';\nexport { stripDirectSelectMode } from './lib/draw/modes/strip/strip.direct.mode';\nexport { stripMode } from './lib/draw/modes/strip/strip.mode';\nexport { rectangleMode } from './lib/draw/modes/rectangleMode';\nexport {\n  AbstractArlasMapGL, ArlasMapOffset, CROSS_LAYER_PREFIX,\n  GEOJSON_SOURCE_TYPE, LAYER_SWITCHER_TOOLTIP,\n  MapConfig, RESET_BEARING, ZOOM_IN, ZOOM_OUT\n} from './lib/map/AbstractArlasMapGL';\nexport {\n  ConfigControls, ControlButton, ControlPosition, ControlsOption, DrawConfigControl,\n  DrawControlsOption, IconConfig, PitchToggle, PitchToggleConfigControls\n} from './lib/map/model/controls';\nexport { MapExtent } from './lib/map/model/extent';\nexport {\n  ARLAS_ID, ARLAS_VSET, ExternalEvent, ExternalEventLayer, FILLSTROKE_LAYER_PREFIX, FillStroke, HOVER_LAYER_PREFIX,\n  LayerEvents, LayerMetadata, MapLayers, MetadataHiddenProps, PaintColor, PaintValue, SCROLLABLE_ARLAS_ID, SELECT_LAYER_PREFIX,\n  getLayerName, ArlasDataLayer, ArlasPaint\n} from './lib/map/model/layers';\nexport { ArlasMapSource } from './lib/map/model/sources';\nexport { VisualisationSetConfig } from './lib/map/model/visualisationsets';\nexport {\n  Legend, LegendData, PROPERTY_SELECTOR_SOURCE, CircleLegend, LineLegend,\n  FillLegend, HeatmapLegend, LabelLegend\n} from './lib/legend/legend.config';\nexport { getMax, MAX_CIRLE_RADIUS, MAX_LINE_WIDTH } from './lib/legend/legend.tools';\nexport { FormatLegendPipe } from './lib/legend/format-legend.pipe';\nexport * as styles from './lib/draw/themes/default-theme';\nexport { ArlasMapComponent } from './lib/arlas-map.component';\nexport { ArlasLngLat, OnMoveResult, ArlasLngLatBounds, } from './lib/map/model/map';\nexport { VectorStyle, VectorStyleEnum } from './lib/map/model/vector-style';\n/** Map component logic */\nexport { AbstractArlasMapService } from './lib/arlas-map.service';\n/** Map framework logic */\nexport { ArlasMapFrameworkService } from './lib/arlas-map-framework.service';\nexport { GET, HEATMAP_DENSITY, IN, INTERPOLATE, MATCH, NOT_IN, OTHER } from './lib/map/model/filters';\nexport { MapLayerMouseEvent, MapMouseEvent} from './lib/map/model/events';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":["i3","i9","i1.ArlasMapFrameworkService","i1","i2.ArlasMapFrameworkService","reader","doubleClickZoom","styles.default","i1.MapboxAoiDrawService","i2","i4.ArlasMapFrameworkService","i5.AbstractArlasMapService","i5","i6","i7","i8.CoordinatesErrorPipe","Subject","i1.BasemapService","i2.AbstractArlasMapService","i3.ArlasMapFrameworkService","i4","getMax","i5.FormatLegendPipe","i3.LegendService","i7.LayerIconComponent","i8.LegendItemComponent","i10.LayerIdToName","area","i2.BasemapService","i8","i10","i11.CoordinatesComponent","i12.BasemapComponent","i13.LegendComponent","i14.ArlasDrawComponent","i15","i16.GetCollectionPipe","i9.ArlasMapFrameworkService","i10.BboxFormErrorPipe"],"mappings":"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"}