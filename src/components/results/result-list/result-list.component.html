<table [style.width.px]="tableWidth" class=" table-sm table-responsive table-hover resultlist">
  <thead >
    <tr class="resultlist__header">
      <ng-container *ngFor="let column of columns">
        <th *ngIf="column.isIdField"
            [style.max-width.px]="column.width"
            [style.min-width.px]="column.width"
            class="resultlist__header--columns" >
          <span  class="resultlist__header--columns--hidden"></span>
        </th>
        <th *ngIf="!column.isIdField && !column.isToggleField"
            [style.max-width.px]="column.width"
            [style.min-width.px]="column.width"
            class="resultlist__header--columns" >
          <span>
            <a (click) = "sort(column)">{{column.columnName}}{{column.dataType}}</a>
          </span>
          <div *ngIf="column.sortDirection !== SortEnum.none" class="resultlist__header--columns__sort">
            <md-icon *ngIf="column.sortDirection === SortEnum.asc" (click) = "sort(column)" class="resultlist__header--columns__sort--icon">expand_more</md-icon>
            <md-icon *ngIf="column.sortDirection === SortEnum.desc" (click) = "sort(column)" class="resultlist__header--columns__sort--icon">expand_less</md-icon>
          </div>
        </th>
        <th *ngIf="column.isToggleField" class="resultlist__header--columns"
                           [style.max-width.px]="column.width"
                           [style.min-width.px]="column.width">
          <span  class="resultlist__header--columns--hidden">
          </span>
        </th>
      </ng-container>
    </tr>
    <tr class="resultlist__filter">
      <ng-container *ngFor="let column of columns">
        <td [style.width.px]="column.width" *ngIf="column.isIdField">
          <span class="resultlist__header--columns--hidden"></span>
        </td>
        <td arlas-result-filter *ngIf="!column.isIdField && !column.isToggleField"
                           [style.width.px]="column.width"
                           [column]="column"
                           [filtersMap]="filtersMap"
                           (setFiltersEvent)="setFilters($event)">
        </td>
        <td *ngIf="column.isToggleField" [style.width.px]="column.width">
          <span class="resultlist__header--columns--hidden"></span>
        </td>
      </ng-container>
    </tr>
    <tr class="resultlist__tools">
      <td [colSpan]="columns.length" [style.width.px]="tableWidth">
        <div class="resultlist__tools--select">
          <div class="resultlist__tools--select-all">
            <div class="resultgrid--checkbox">
              <md-checkbox (change)="selectAllItems()" [checked]="allItemsChecked" [labelPosition]="'after'">All</md-checkbox>
            </div>
          </div>
          <div class="resultgrid--checkbox__count">
            <span>{{selectedItems.size}}</span>
          </div>
          <div class="resultlist__tools--select-between">
            <button md-icon-button color="#043b53" (click)="selectInBetween()">
              <md-icon style="-webkit-transform: rotate(-90deg)">vertical_align_center</md-icon>
            </button>
          </div>


        </div>
        <div class="resultlist__tools--actions">
          <button md-icon-button [mdMenuTriggerFor]="menu">
            <md-icon>menu</md-icon>
          </button>
          <md-menu #menu="mdMenu">
            <button *ngFor="let action of globalActionsList" md-menu-item (click)="setGlobalAction(action)">
              <span>{{action.label}}</span>
            </button>
          </md-menu>
        </div>

        <div *ngIf="hasGridMode" class="resultlist__tools--mode">
          <md-button-toggle-group #group="mdButtonToggleGroup" (change)="whichMode($event)">
            <md-button-toggle value="{{ModeEnum.list}}" [checked]="true">
              <md-icon>list</md-icon>
            </md-button-toggle>
            <md-button-toggle value="{{ModeEnum.grid}}">
              <md-icon>apps</md-icon>
            </md-button-toggle>
          </md-button-toggle-group>
        </div>

      </td>
    </tr>
    <tr class="resultlist__grid-detail" *ngIf="selectedGridItem != null"
                           [style.display]="displayGrid">
      <td class="resultlist__grid-detail--td" [colSpan]="columns.length">
        <arlas-result-detailed-grid
                           [gridTile]="selectedGridItem"
                           [detailWidth]="tableWidth"
                           [detailHeight]="detailedGridHeight"
                           (actionOnItemEvent)="triggerActionOnItem($event)">
        </arlas-result-detailed-grid>
      </td>
    </tr>
  </thead>
  <tbody arlasResultScroll [style.height.px]="tbodyHeight"
                           [rowItemList]="rowItemList"
                           [searchSize]="searchSize"
                           [nLastLines]="nLastLines"
                           (moreDataEvent)="askForMoreData($event)">
      <md-grid-list cols="{{nbGridColumns}}" rowHeight="1:1" [style.display]="displayListGrid">
        <ng-container *ngFor="let rowItem of items; index as i">
          <tr arlas-result-item class="resultlist__body--item"
                            (mouseenter)="setConsultedItem(rowItem.identifier)"
                            (mouseleave)="setConsultedItem('leave-'+rowItem.identifier)"
                            [rowItem]="rowItem"
                            [detailedDataRetriever]="detailedDataRetriever"
                            [selectedItems]="selectedItems"
                            (selectedItemsEvent)="setSelectedItems($event)"
                            (selectedItemPositionEvent)="setItemsPositionsList($event)"
                            (borderStyleEvent)="setBorderStyle($event)"
                            [style.border-bottom-style]="borderStyle"
                            [style.display]="displayList" >
          </tr>
          <tr arlas-result-detailed-item *ngIf="rowItem.isDetailToggled" class="resultlist__body--detailed-item"
                            (mouseenter)="setConsultedItem(rowItem.identifier)"
                            (mouseleave)="setConsultedItem('leave-'+rowItem.identifier)"
                            [detailColspan]="rowItem.columns.length"
                            [rowItem]="rowItem"
                            [idFieldName]="idFieldName"
                            (actionOnItemEvent)="triggerActionOnItem($event)"
                            [style.display]="displayList">
          </tr>
          <md-grid-tile [style.display]="displayGrid" class="resultlist__md-grid-tile" >
            <arlas-result-grid-tile class="resultlist__grid-tile"
                            [gridTile]="rowItem"
                            [selectedItems]="selectedItems"
                            [detailedDataRetriever]="detailedDataRetriever"
                            (selectedItemsEvent)="setSelectedItems($event)"
                            (selectedItemPositionEvent)="setItemsPositionsList($event)"
                            (clickedOnItemEvent)="setSelectedGridItem($event)"
                            (mouseenter)="setConsultedItem(rowItem.identifier)"
                            (mouseleave)="setConsultedItem('leave-'+rowItem.identifier)">
            </arlas-result-grid-tile>
          </md-grid-tile>
        </ng-container>
      </md-grid-list>
  </tbody>
</table>
<div *ngIf="isMoreDataRequested" class="resultlist__moredata" [style.width.px]="tableWidth">
  <ngx-loading
        [show]="isMoreDataRequested"
        [config]="{ animationType: ANIMATION_TYPES.threeBounce, backdropBackgroundColour: 'rgba(100,100,100,0.5)',
                    backdropBorderRadius: '0', primaryColour: '#ffffff', secondaryColour: '#ffffff', tertiaryColour: '#ffffff' }">
  </ngx-loading>
</div>
