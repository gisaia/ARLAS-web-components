{"version":3,"file":"local.data-source.js","sourceRoot":"","sources":["../../../../../src/ng2-smart-table/lib/data-source/local/local.data-source.ts"],"names":[],"mappings":"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","sourcesContent":["import { LocalSorter } from './local.sorter';\r\nimport { LocalFilter } from './local.filter';\r\nimport { LocalPager } from './local.pager';\r\nimport { DataSource } from '../data-source';\r\nimport { deepExtend } from '../../helpers';\r\n\r\nexport class LocalDataSource extends DataSource {\r\n\r\n  protected data: Array<any> = [];\r\n  protected filteredAndSorted: Array<any> = [];\r\n  protected sortConf: Array<any> = [];\r\n  protected filterConf: any = {\r\n    filters: [],\r\n    andOperator: true,\r\n  };\r\n  protected pagingConf: any = {};\r\n\r\n  constructor(data: Array<any> = []) {\r\n    super();\r\n\r\n    this.data = data;\r\n  }\r\n\r\n  load(data: Array<any>): Promise<any> {\r\n    this.data = data;\r\n\r\n    return super.load(data);\r\n  }\r\n\r\n  prepend(element: any): Promise<any> {\r\n    this.reset(true);\r\n\r\n    this.data.unshift(element);\r\n    return super.prepend(element);\r\n  }\r\n\r\n  append(element: any): Promise<any> {\r\n    this.reset(true);\r\n\r\n    this.data.push(element);\r\n    return super.append(element);\r\n  }\r\n\r\n  add(element: any): Promise<any> {\r\n    this.data.push(element);\r\n\r\n    return super.add(element);\r\n  }\r\n\r\n  remove(element: any): Promise<any> {\r\n    this.data = this.data.filter(el => el !== element);\r\n\r\n    return super.remove(element);\r\n  }\r\n\r\n  update(element: any, values: any): Promise<any> {\r\n    return new Promise((resolve, reject) => {\r\n      this.find(element).then((found) => {\r\n        found = deepExtend(found, values);\r\n        super.update(found, values).then(resolve).catch(reject);\r\n      }).catch(reject);\r\n    });\r\n  }\r\n\r\n  find(element: any): Promise<any> {\r\n    const found = this.data.find(el => el === element);\r\n    if (found) {\r\n      return Promise.resolve(found);\r\n    }\r\n\r\n    return Promise.reject(new Error('Element was not found in the dataset'));\r\n  }\r\n\r\n  getElements(): Promise<any> {\r\n    const data = this.data.slice(0);\r\n    return Promise.resolve(this.prepareData(data));\r\n  }\r\n\r\n  getFilteredAndSorted(): Promise<any> {\r\n    let data = this.data.slice(0);\r\n    this.prepareData(data);\r\n    return Promise.resolve(this.filteredAndSorted);\r\n  }\r\n\r\n  getAll(): Promise<any> {\r\n    const data = this.data.slice(0);\r\n    return Promise.resolve(data);\r\n  }\r\n\r\n  reset(silent = false) {\r\n    if (silent) {\r\n      this.filterConf = {\r\n        filters: [],\r\n        andOperator: true,\r\n      };\r\n      this.sortConf = [];\r\n      this.pagingConf['page'] = 1;\r\n    } else {\r\n      this.setFilter([], true, false);\r\n      this.setSort([], false);\r\n      this.setPage(1);\r\n    }\r\n  }\r\n\r\n  empty(): Promise<any> {\r\n    this.data = [];\r\n\r\n    return super.empty();\r\n  }\r\n\r\n  count(): number {\r\n    return this.filteredAndSorted.length;\r\n  }\r\n\r\n  /**\r\n   *\r\n   * Array of conf objects\r\n   * [\r\n   *  {field: string, direction: asc|desc|null, compare: Function|null},\r\n   * ]\r\n   * @param conf\r\n   * @param doEmit\r\n   * @returns {LocalDataSource}\r\n   */\r\n  setSort(conf: Array<any>, doEmit = true): LocalDataSource {\r\n    if (conf !== null) {\r\n\r\n      conf.forEach((fieldConf) => {\r\n        if (!fieldConf['field'] || typeof fieldConf['direction'] === 'undefined') {\r\n          throw new Error('Sort configuration object is not valid');\r\n        }\r\n      });\r\n      this.sortConf = conf;\r\n    }\r\n\r\n    super.setSort(conf, doEmit);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   *\r\n   * Array of conf objects\r\n   * [\r\n   *  {field: string, search: string, filter: Function|null},\r\n   * ]\r\n   * @param conf\r\n   * @param andOperator\r\n   * @param doEmit\r\n   * @returns {LocalDataSource}\r\n   */\r\n  setFilter(conf: Array<any>, andOperator = true, doEmit = true): LocalDataSource {\r\n    if (conf && conf.length > 0) {\r\n      conf.forEach((fieldConf) => {\r\n        this.addFilter(fieldConf, andOperator, false);\r\n      });\r\n    } else {\r\n      this.filterConf = {\r\n        filters: [],\r\n        andOperator: true,\r\n      };\r\n    }\r\n    this.filterConf.andOperator = andOperator;\r\n    this.pagingConf['page'] = 1;\r\n\r\n    super.setFilter(conf, andOperator, doEmit);\r\n    return this;\r\n  }\r\n\r\n  addFilter(fieldConf: any, andOperator = true, doEmit: boolean = true): LocalDataSource {\r\n    if (!fieldConf['field'] || typeof fieldConf['search'] === 'undefined') {\r\n      throw new Error('Filter configuration object is not valid');\r\n    }\r\n\r\n    let found = false;\r\n    this.filterConf.filters.forEach((currentFieldConf: any, index: any) => {\r\n      if (currentFieldConf['field'] === fieldConf['field']) {\r\n        this.filterConf.filters[index] = fieldConf;\r\n        found = true;\r\n      }\r\n    });\r\n    if (!found) {\r\n      this.filterConf.filters.push(fieldConf);\r\n    }\r\n    this.filterConf.andOperator = andOperator;\r\n    super.addFilter(fieldConf, andOperator, doEmit);\r\n    return this;\r\n  }\r\n\r\n  setPaging(page: number, perPage: number, doEmit: boolean = true): LocalDataSource {\r\n    this.pagingConf['page'] = page;\r\n    this.pagingConf['perPage'] = perPage;\r\n\r\n    super.setPaging(page, perPage, doEmit);\r\n    return this;\r\n  }\r\n\r\n  setPage(page: number, doEmit: boolean = true): LocalDataSource {\r\n    this.pagingConf['page'] = page;\r\n    super.setPage(page, doEmit);\r\n    return this;\r\n  }\r\n\r\n  getSort(): any {\r\n    return this.sortConf;\r\n  }\r\n\r\n  getFilter(): any {\r\n    return this.filterConf;\r\n  }\r\n\r\n  getPaging(): any {\r\n    return this.pagingConf;\r\n  }\r\n\r\n  protected prepareData(data: Array<any>): Array<any> {\r\n    data = this.filter(data);\r\n    data = this.sort(data);\r\n    this.filteredAndSorted = data.slice(0);\r\n\r\n    return this.paginate(data);\r\n  }\r\n\r\n  protected sort(data: Array<any>): Array<any> {\r\n    if (this.sortConf) {\r\n      this.sortConf.forEach((fieldConf) => {\r\n        data = LocalSorter\r\n          .sort(data, fieldConf['field'], fieldConf['direction'], fieldConf['compare']);\r\n      });\r\n    }\r\n    return data;\r\n  }\r\n\r\n  // TODO: refactor?\r\n  protected filter(data: Array<any>): Array<any> {\r\n    if (this.filterConf.filters) {\r\n      if (this.filterConf.andOperator) {\r\n        this.filterConf.filters.forEach((fieldConf: any) => {\r\n          if (fieldConf['search'].length > 0) {\r\n            data = LocalFilter\r\n              .filter(data, fieldConf['field'], fieldConf['search'], fieldConf['filter']);\r\n          }\r\n        });\r\n      } else {\r\n        let mergedData: any = [];\r\n        this.filterConf.filters.forEach((fieldConf: any) => {\r\n          if (fieldConf['search'].length > 0) {\r\n            mergedData = mergedData.concat(LocalFilter\r\n              .filter(data, fieldConf['field'], fieldConf['search'], fieldConf['filter']));\r\n          }\r\n        });\r\n        // remove non unique items\r\n        data = mergedData.filter((elem: any, pos: any, arr: any) => {\r\n          return arr.indexOf(elem) === pos;\r\n        });\r\n      }\r\n    }\r\n    return data;\r\n  }\r\n\r\n  protected paginate(data: Array<any>): Array<any> {\r\n    if (this.pagingConf && this.pagingConf['page'] && this.pagingConf['perPage']) {\r\n      data = LocalPager.paginate(data, this.pagingConf['page'], this.pagingConf['perPage']);\r\n    }\r\n    return data;\r\n  }\r\n}\r\n"]}